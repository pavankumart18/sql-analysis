{"query_id": "E000401", "created_ts": "2024-01-01 08:40:34", "analyst": "analyst_04", "archetype": "attendance_rate", "sql_id": "S000401", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000806", "created_ts": "2024-01-01 09:00:08", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000806", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000701", "created_ts": "2024-01-01 09:40:55", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000701", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000001", "created_ts": "2024-01-01 09:45:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000001", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000221", "created_ts": "2024-01-01 10:15:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000221", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000861", "created_ts": "2024-01-01 10:15:34", "analyst": "analyst_04", "archetype": "support_sla", "sql_id": "S000861", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000851", "created_ts": "2024-01-01 10:30:08", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S000851", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000871", "created_ts": "2024-01-01 10:30:55", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000871", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000841", "created_ts": "2024-01-01 12:15:05", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S000841", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000736", "created_ts": "2024-01-01 14:50:21", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000736", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000402", "created_ts": "2024-01-02 11:05:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000402", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000002", "created_ts": "2024-01-02 11:20:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000002", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000222", "created_ts": "2024-01-02 11:50:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000222", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001313", "created_ts": "2024-01-03 09:10:08", "analyst": "analyst_12", "archetype": "marketing_last_touch", "sql_id": "S001313", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001128", "created_ts": "2024-01-03 09:55:03", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S001128", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000581", "created_ts": "2024-01-03 10:05:13", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000581", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000003", "created_ts": "2024-01-03 10:15:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000003", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000403", "created_ts": "2024-01-03 11:05:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000403", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001026", "created_ts": "2024-01-03 18:55:34", "analyst": "analyst_12", "archetype": "refund_spike", "sql_id": "S001026", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000223", "created_ts": "2024-01-04 09:45:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000223", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000404", "created_ts": "2024-01-04 09:50:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000404", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000004", "created_ts": "2024-01-04 11:15:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000004", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000005", "created_ts": "2024-01-05 09:10:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000005", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000224", "created_ts": "2024-01-05 09:50:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000224", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000405", "created_ts": "2024-01-05 10:00:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000405", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001189", "created_ts": "2024-01-05 11:50:34", "analyst": "analyst_08", "archetype": "attach_rate", "sql_id": "S001189", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001079", "created_ts": "2024-01-05 13:50:02", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S001079", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000006", "created_ts": "2024-01-07 10:15:02", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S000006", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000225", "created_ts": "2024-01-08 08:50:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000225", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000406", "created_ts": "2024-01-08 09:50:08", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000406", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001044", "created_ts": "2024-01-08 10:07:02", "analyst": "analyst_11", "archetype": "marketing_last_touch", "sql_id": "S001044", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001469", "created_ts": "2024-01-08 11:25:05", "analyst": "analyst_01", "archetype": "campaign_funnel", "sql_id": "S001469", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000737", "created_ts": "2024-01-08 13:50:13", "analyst": "analyst_04", "archetype": "attach_rate", "sql_id": "S000737", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000974", "created_ts": "2024-01-08 14:25:01", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S000974", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000771", "created_ts": "2024-01-08 14:40:03", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000771", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000407", "created_ts": "2024-01-09 09:15:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000407", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001254", "created_ts": "2024-01-09 09:20:01", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S001254", "expected_sources": ["raw_digital_events", "tmp_e001254"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e001254", "expr": "temp materialization"}]}
{"query_id": "E000582", "created_ts": "2024-01-09 11:05:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000582", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000007", "created_ts": "2024-01-09 11:30:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000007", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000408", "created_ts": "2024-01-10 08:20:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000408", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000583", "created_ts": "2024-01-10 09:20:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000583", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000226", "created_ts": "2024-01-10 10:50:00", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000226", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001272", "created_ts": "2024-01-10 11:03:05", "analyst": "analyst_10", "archetype": "support_sla", "sql_id": "S001272", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000409", "created_ts": "2024-01-11 08:30:08", "analyst": "analyst_10", "archetype": "attendance_rate", "sql_id": "S000409", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000227", "created_ts": "2024-01-11 10:10:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000227", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001304", "created_ts": "2024-01-11 10:50:01", "analyst": "analyst_04", "archetype": "deals_pipeline", "sql_id": "S001304", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001217", "created_ts": "2024-01-11 10:50:21", "analyst": "analyst_12", "archetype": "attendance_rate", "sql_id": "S001217", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000584", "created_ts": "2024-01-11 11:05:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000584", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000926", "created_ts": "2024-01-11 17:25:13", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S000926", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000927", "created_ts": "2024-01-11 18:25:13", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S000927", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000008", "created_ts": "2024-01-12 08:30:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000008", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001491", "created_ts": "2024-01-12 09:55:05", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S001491", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001388", "created_ts": "2024-01-12 11:03:05", "analyst": "analyst_07", "archetype": "refund_spike", "sql_id": "S001388", "expected_sources": ["raw_ticket_sales", "tmp_e001388"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}, {"name": "tmp_e001388", "expr": "temp materialization"}]}
{"query_id": "E000410", "created_ts": "2024-01-12 11:20:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000410", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001298", "created_ts": "2024-01-12 14:20:55", "analyst": "analyst_12", "archetype": "ticket_revenue_daily", "sql_id": "S001298", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000702", "created_ts": "2024-01-15 09:10:01", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000702", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000228", "created_ts": "2024-01-15 09:30:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000228", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000807", "created_ts": "2024-01-15 09:40:02", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000807", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000411", "created_ts": "2024-01-15 11:40:08", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000411", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001129", "created_ts": "2024-01-15 15:40:21", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001129", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001309", "created_ts": "2024-01-15 18:40:13", "analyst": "analyst_12", "archetype": "deals_pipeline", "sql_id": "S001309", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001392", "created_ts": "2024-01-16 09:35:55", "analyst": "analyst_05", "archetype": "campaign_funnel", "sql_id": "S001392", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000009", "created_ts": "2024-01-16 09:45:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000009", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001233", "created_ts": "2024-01-16 11:25:34", "analyst": "analyst_10", "archetype": "attendance_rate", "sql_id": "S001233", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001299", "created_ts": "2024-01-16 14:20:03", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001299", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000010", "created_ts": "2024-01-17 10:00:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000010", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000011", "created_ts": "2024-01-18 09:15:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000011", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000412", "created_ts": "2024-01-18 10:00:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000412", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000229", "created_ts": "2024-01-18 10:45:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000229", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001353", "created_ts": "2024-01-18 14:45:34", "analyst": "analyst_03", "archetype": "marketing_last_touch", "sql_id": "S001353", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000012", "created_ts": "2024-01-19 11:15:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000012", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000413", "created_ts": "2024-01-22 08:20:00", "analyst": "analyst_04", "archetype": "attendance_rate", "sql_id": "S000413", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000230", "created_ts": "2024-01-22 08:45:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000230", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000772", "created_ts": "2024-01-22 10:40:08", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000772", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000013", "created_ts": "2024-01-22 10:45:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000013", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000738", "created_ts": "2024-01-22 11:10:03", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000738", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000808", "created_ts": "2024-01-22 13:30:55", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000808", "expected_sources": ["raw_ticket_sales", "marketing_touches", "tmp_e000808"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}, {"name": "tmp_e000808", "expr": "temp materialization"}]}
{"query_id": "E001017", "created_ts": "2024-01-22 19:35:21", "analyst": "analyst_06", "archetype": "deals_pipeline", "sql_id": "S001017", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000014", "created_ts": "2024-01-23 09:05:03", "analyst": "analyst_11", "archetype": "ticket_revenue_daily", "sql_id": "S000014", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000585", "created_ts": "2024-01-23 09:20:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000585", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000231", "created_ts": "2024-01-23 10:00:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000231", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001060", "created_ts": "2024-01-23 15:15:21", "analyst": "analyst_01", "archetype": "deals_pipeline", "sql_id": "S001060", "expected_sources": ["crm_deals", "tmp_e001060"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}, {"name": "tmp_e001060", "expr": "temp materialization"}]}
{"query_id": "E000232", "created_ts": "2024-01-24 10:15:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000232", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000414", "created_ts": "2024-01-24 11:15:02", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000414", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000015", "created_ts": "2024-01-24 11:45:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000015", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001364", "created_ts": "2024-01-24 14:50:01", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001364", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000586", "created_ts": "2024-01-25 08:45:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000586", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000233", "created_ts": "2024-01-25 09:40:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000233", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000415", "created_ts": "2024-01-25 11:10:02", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000415", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000234", "created_ts": "2024-01-26 08:50:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000234", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000016", "created_ts": "2024-01-26 10:00:00", "analyst": "analyst_12", "archetype": "ticket_revenue_daily", "sql_id": "S000016", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001431", "created_ts": "2024-01-26 10:25:55", "analyst": "analyst_02", "archetype": "deals_pipeline", "sql_id": "S001431", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000017", "created_ts": "2024-01-27 11:50:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000017", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000416", "created_ts": "2024-01-29 08:30:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000416", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001361", "created_ts": "2024-01-29 09:30:21", "analyst": "analyst_12", "archetype": "attach_rate", "sql_id": "S001361", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000773", "created_ts": "2024-01-29 09:40:00", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000773", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000018", "created_ts": "2024-01-29 09:45:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000018", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000809", "created_ts": "2024-01-29 09:50:34", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000809", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001245", "created_ts": "2024-01-29 11:20:13", "analyst": "analyst_11", "archetype": "campaign_funnel", "sql_id": "S001245", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001123", "created_ts": "2024-01-29 11:40:02", "analyst": "analyst_10", "archetype": "rfm_segmentation", "sql_id": "S001123", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000739", "created_ts": "2024-01-29 13:40:08", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000739", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000703", "created_ts": "2024-01-29 14:30:55", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000703", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001487", "created_ts": "2024-01-29 16:03:05", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S001487", "expected_sources": ["raw_digital_events", "tmp_e001487"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e001487", "expr": "temp materialization"}]}
{"query_id": "E001133", "created_ts": "2024-01-29 18:03:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S001133", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000019", "created_ts": "2024-01-30 08:50:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000019", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000417", "created_ts": "2024-01-30 09:50:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000417", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000235", "created_ts": "2024-01-30 10:10:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000235", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001270", "created_ts": "2024-01-30 15:50:13", "analyst": "analyst_01", "archetype": "support_sla", "sql_id": "S001270", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000418", "created_ts": "2024-01-31 10:20:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000418", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001258", "created_ts": "2024-01-31 10:45:21", "analyst": "analyst_06", "archetype": "rfm_segmentation", "sql_id": "S001258", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000020", "created_ts": "2024-01-31 11:30:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000020", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000842", "created_ts": "2024-02-01 10:45:02", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S000842", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000852", "created_ts": "2024-02-01 10:45:05", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S000852", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000872", "created_ts": "2024-02-01 11:00:01", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000872", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000236", "created_ts": "2024-02-02 10:10:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000236", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001048", "created_ts": "2024-02-02 12:50:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S001048", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000021", "created_ts": "2024-02-03 09:10:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000021", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000419", "created_ts": "2024-02-03 10:05:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000419", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000587", "created_ts": "2024-02-05 08:40:21", "analyst": "analyst_01", "archetype": "campaign_funnel", "sql_id": "S000587", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000420", "created_ts": "2024-02-05 09:05:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000420", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000237", "created_ts": "2024-02-05 10:05:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000237", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000740", "created_ts": "2024-02-05 10:10:08", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000740", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000022", "created_ts": "2024-02-05 10:20:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000022", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000704", "created_ts": "2024-02-05 11:10:21", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000704", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001454", "created_ts": "2024-02-05 12:35:05", "analyst": "analyst_06", "archetype": "rfm_segmentation", "sql_id": "S001454", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001144", "created_ts": "2024-02-05 13:55:34", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001144", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000774", "created_ts": "2024-02-05 14:20:02", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000774", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001113", "created_ts": "2024-02-05 14:40:13", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S001113", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000238", "created_ts": "2024-02-06 09:05:00", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000238", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000023", "created_ts": "2024-02-06 11:05:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000023", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001082", "created_ts": "2024-02-06 14:50:34", "analyst": "analyst_04", "archetype": "ticket_revenue_daily", "sql_id": "S001082", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001483", "created_ts": "2024-02-06 18:25:21", "analyst": "analyst_05", "archetype": "attach_rate", "sql_id": "S001483", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000588", "created_ts": "2024-02-07 10:15:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000588", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000239", "created_ts": "2024-02-07 11:10:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000239", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000421", "created_ts": "2024-02-07 11:15:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000421", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000024", "created_ts": "2024-02-08 08:30:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000024", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000422", "created_ts": "2024-02-08 10:00:02", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000422", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000240", "created_ts": "2024-02-08 10:20:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000240", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001324", "created_ts": "2024-02-08 12:30:03", "analyst": "analyst_08", "archetype": "support_sla", "sql_id": "S001324", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000423", "created_ts": "2024-02-09 08:00:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000423", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e000423"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e000423", "expr": "temp materialization"}]}
{"query_id": "E000025", "created_ts": "2024-02-09 08:05:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000025", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000241", "created_ts": "2024-02-09 08:20:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000241", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000922", "created_ts": "2024-02-09 13:35:03", "analyst": "analyst_02", "archetype": "refund_spike", "sql_id": "S000922", "expected_sources": ["raw_ticket_sales", "tmp_e000922"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}, {"name": "tmp_e000922", "expr": "temp materialization"}]}
{"query_id": "E000923", "created_ts": "2024-02-09 14:20:03", "analyst": "analyst_02", "archetype": "refund_spike", "sql_id": "S000923", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000925", "created_ts": "2024-02-09 14:35:03", "analyst": "analyst_02", "archetype": "refund_spike", "sql_id": "S000925", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000924", "created_ts": "2024-02-09 15:35:03", "analyst": "analyst_02", "archetype": "refund_spike", "sql_id": "S000924", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001319", "created_ts": "2024-02-10 17:20:01", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S001319", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000424", "created_ts": "2024-02-12 10:00:02", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000424", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000810", "created_ts": "2024-02-12 10:20:03", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000810", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000741", "created_ts": "2024-02-12 10:30:21", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000741", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000242", "created_ts": "2024-02-12 11:45:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000242", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001139", "created_ts": "2024-02-12 11:55:00", "analyst": "analyst_10", "archetype": "support_sla", "sql_id": "S001139", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000705", "created_ts": "2024-02-12 13:30:34", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000705", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000775", "created_ts": "2024-02-12 14:50:00", "analyst": "analyst_03", "archetype": "support_sla", "sql_id": "S000775", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001297", "created_ts": "2024-02-12 15:40:00", "analyst": "analyst_05", "archetype": "support_sla", "sql_id": "S001297", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000425", "created_ts": "2024-02-13 08:10:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000425", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001407", "created_ts": "2024-02-13 15:25:55", "analyst": "analyst_02", "archetype": "support_sla", "sql_id": "S001407", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000589", "created_ts": "2024-02-14 08:00:05", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S000589", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000026", "created_ts": "2024-02-14 08:45:55", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S000026", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000243", "created_ts": "2024-02-14 11:50:01", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000243", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000027", "created_ts": "2024-02-15 09:45:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000027", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000426", "created_ts": "2024-02-15 09:50:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000426", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001219", "created_ts": "2024-02-15 15:40:01", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S001219", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001303", "created_ts": "2024-02-15 15:40:34", "analyst": "analyst_12", "archetype": "ticket_revenue_daily", "sql_id": "S001303", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000427", "created_ts": "2024-02-16 08:00:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000427", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000028", "created_ts": "2024-02-16 10:15:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000028", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000244", "created_ts": "2024-02-16 11:15:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000244", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001169", "created_ts": "2024-02-16 12:15:05", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S001169", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000590", "created_ts": "2024-02-19 08:15:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000590", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000811", "created_ts": "2024-02-19 09:00:21", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000811", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000029", "created_ts": "2024-02-19 09:50:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000029", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000428", "created_ts": "2024-02-19 11:00:34", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000428", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000776", "created_ts": "2024-02-19 11:10:55", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000776", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000706", "created_ts": "2024-02-19 13:10:34", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000706", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001399", "created_ts": "2024-02-19 17:03:21", "analyst": "analyst_05", "archetype": "deals_pipeline", "sql_id": "S001399", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001458", "created_ts": "2024-02-19 17:40:03", "analyst": "analyst_10", "archetype": "campaign_funnel", "sql_id": "S001458", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000030", "created_ts": "2024-02-20 08:00:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000030", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000591", "created_ts": "2024-02-20 09:15:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000591", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000429", "created_ts": "2024-02-20 09:15:55", "analyst": "analyst_04", "archetype": "attendance_rate", "sql_id": "S000429", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001242", "created_ts": "2024-02-20 12:25:34", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001242", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001464", "created_ts": "2024-02-20 14:35:02", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S001464", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000592", "created_ts": "2024-02-21 08:45:08", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000592", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000430", "created_ts": "2024-02-21 09:30:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000430", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000031", "created_ts": "2024-02-21 09:45:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000031", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000031"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000031", "expr": "temp materialization"}]}
{"query_id": "E000245", "created_ts": "2024-02-21 11:10:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000245", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001175", "created_ts": "2024-02-21 17:35:02", "analyst": "analyst_06", "archetype": "marketing_last_touch", "sql_id": "S001175", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000431", "created_ts": "2024-02-22 08:00:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000431", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000032", "created_ts": "2024-02-22 08:50:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000032", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000432", "created_ts": "2024-02-23 08:45:34", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000432", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000033", "created_ts": "2024-02-23 09:00:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000033", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001484", "created_ts": "2024-02-23 14:07:21", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S001484", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001057", "created_ts": "2024-02-23 15:30:21", "analyst": "analyst_03", "archetype": "rfm_segmentation", "sql_id": "S001057", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000906", "created_ts": "2024-02-23 17:03:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000906", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000908", "created_ts": "2024-02-23 17:19:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000908", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000907", "created_ts": "2024-02-23 17:48:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000907", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000909", "created_ts": "2024-02-23 18:03:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000909", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001076", "created_ts": "2024-02-23 20:20:08", "analyst": "analyst_05", "archetype": "deals_pipeline", "sql_id": "S001076", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000034", "created_ts": "2024-02-26 08:15:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000034", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000246", "created_ts": "2024-02-26 09:05:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000246", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000433", "created_ts": "2024-02-26 09:30:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000433", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000742", "created_ts": "2024-02-26 10:10:13", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000742", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001257", "created_ts": "2024-02-26 10:10:55", "analyst": "analyst_12", "archetype": "attach_rate", "sql_id": "S001257", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000777", "created_ts": "2024-02-26 10:50:13", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000777", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001158", "created_ts": "2024-02-26 11:45:34", "analyst": "analyst_11", "archetype": "support_sla", "sql_id": "S001158", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001436", "created_ts": "2024-02-26 12:35:13", "analyst": "analyst_10", "archetype": "attach_rate", "sql_id": "S001436", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000707", "created_ts": "2024-02-26 14:50:13", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000707", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000896", "created_ts": "2024-02-26 17:20:55", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S000896", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000898", "created_ts": "2024-02-26 17:50:55", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S000898", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000897", "created_ts": "2024-02-26 18:20:55", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S000897", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000899", "created_ts": "2024-02-26 18:50:55", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S000899", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000035", "created_ts": "2024-02-27 08:40:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000035", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001266", "created_ts": "2024-02-27 10:25:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S001266", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000434", "created_ts": "2024-02-27 10:45:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000434", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000593", "created_ts": "2024-02-27 11:05:05", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000593", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001042", "created_ts": "2024-02-27 13:10:02", "analyst": "analyst_08", "archetype": "rfm_segmentation", "sql_id": "S001042", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000594", "created_ts": "2024-02-28 08:45:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000594", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000435", "created_ts": "2024-02-28 10:10:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000435", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000036", "created_ts": "2024-02-29 08:40:08", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S000036", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000436", "created_ts": "2024-02-29 09:05:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000436", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000247", "created_ts": "2024-02-29 10:50:08", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S000247", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000247"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000247", "expr": "temp materialization"}]}
{"query_id": "E000037", "created_ts": "2024-03-01 08:45:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000037", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000248", "created_ts": "2024-03-01 09:10:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000248", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000862", "created_ts": "2024-03-01 11:45:34", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000862", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000873", "created_ts": "2024-03-01 12:15:02", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000873", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000843", "created_ts": "2024-03-01 12:45:05", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S000843", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001362", "created_ts": "2024-03-01 12:55:08", "analyst": "analyst_06", "archetype": "support_sla", "sql_id": "S001362", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001191", "created_ts": "2024-03-01 13:55:03", "analyst": "analyst_10", "archetype": "attendance_rate", "sql_id": "S001191", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000437", "created_ts": "2024-03-04 09:00:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000437", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000038", "created_ts": "2024-03-04 09:05:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000038", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001389", "created_ts": "2024-03-04 10:20:00", "analyst": "analyst_11", "archetype": "campaign_funnel", "sql_id": "S001389", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001267", "created_ts": "2024-03-04 10:45:21", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S001267", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e001267"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e001267", "expr": "temp materialization"}]}
{"query_id": "E000778", "created_ts": "2024-03-04 11:00:34", "analyst": "analyst_08", "archetype": "support_sla", "sql_id": "S000778", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000595", "created_ts": "2024-03-04 11:15:01", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000595", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001080", "created_ts": "2024-03-04 12:40:03", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S001080", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000708", "created_ts": "2024-03-04 13:40:21", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000708", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000743", "created_ts": "2024-03-04 14:00:01", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000743", "expected_sources": ["raw_ticket_sales", "raw_merch_orders", "tmp_e000743"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}, {"name": "tmp_e000743", "expr": "temp materialization"}]}
{"query_id": "E001024", "created_ts": "2024-03-04 17:35:55", "analyst": "analyst_04", "archetype": "marketing_last_touch", "sql_id": "S001024", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001292", "created_ts": "2024-03-04 19:07:08", "analyst": "analyst_11", "archetype": "deals_pipeline", "sql_id": "S001292", "expected_sources": ["crm_deals", "tmp_e001292"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}, {"name": "tmp_e001292", "expr": "temp materialization"}]}
{"query_id": "E000438", "created_ts": "2024-03-05 08:05:05", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000438", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000596", "created_ts": "2024-03-05 08:10:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000596", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001387", "created_ts": "2024-03-05 09:40:02", "analyst": "analyst_08", "archetype": "campaign_funnel", "sql_id": "S001387", "expected_sources": ["raw_digital_events", "tmp_e001387"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e001387", "expr": "temp materialization"}]}
{"query_id": "E000039", "created_ts": "2024-03-05 10:00:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000039", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000249", "created_ts": "2024-03-05 11:50:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000249", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001177", "created_ts": "2024-03-05 12:10:02", "analyst": "analyst_03", "archetype": "marketing_last_touch", "sql_id": "S001177", "expected_sources": ["raw_ticket_sales", "marketing_touches", "tmp_e001177"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}, {"name": "tmp_e001177", "expr": "temp materialization"}]}
{"query_id": "E000040", "created_ts": "2024-03-06 08:20:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000040", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000439", "created_ts": "2024-03-06 08:40:08", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000439", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000597", "created_ts": "2024-03-06 10:30:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000597", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000250", "created_ts": "2024-03-07 08:30:21", "analyst": "analyst_03", "archetype": "ticket_revenue_daily", "sql_id": "S000250", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000440", "created_ts": "2024-03-07 08:30:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000440", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000251", "created_ts": "2024-03-08 09:05:00", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000251", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000041", "created_ts": "2024-03-08 10:10:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000041", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001084", "created_ts": "2024-03-08 17:25:08", "analyst": "analyst_02", "archetype": "marketing_last_touch", "sql_id": "S001084", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000441", "created_ts": "2024-03-09 09:00:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000441", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001213", "created_ts": "2024-03-10 10:45:00", "analyst": "analyst_07", "archetype": "refund_spike", "sql_id": "S001213", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000252", "created_ts": "2024-03-11 08:00:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000252", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000709", "created_ts": "2024-03-11 09:00:01", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000709", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000744", "created_ts": "2024-03-11 09:20:55", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000744", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000042", "created_ts": "2024-03-11 10:05:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000042", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000779", "created_ts": "2024-03-11 10:30:00", "analyst": "analyst_04", "archetype": "support_sla", "sql_id": "S000779", "expected_sources": ["support_tickets", "tmp_e000779"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}, {"name": "tmp_e000779", "expr": "temp materialization"}]}
{"query_id": "E000442", "created_ts": "2024-03-11 10:30:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000442", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000812", "created_ts": "2024-03-11 10:50:03", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000812", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000598", "created_ts": "2024-03-11 11:05:02", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000598", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001013", "created_ts": "2024-03-11 12:15:02", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S001013", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000599", "created_ts": "2024-03-12 09:15:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000599", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000043", "created_ts": "2024-03-12 10:20:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000043", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000044", "created_ts": "2024-03-13 10:20:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000044", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000600", "created_ts": "2024-03-14 10:50:00", "analyst": "analyst_08", "archetype": "campaign_funnel", "sql_id": "S000600", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000253", "created_ts": "2024-03-14 11:40:00", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000253", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001039", "created_ts": "2024-03-14 17:10:01", "analyst": "analyst_12", "archetype": "ticket_revenue_daily", "sql_id": "S001039", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000045", "created_ts": "2024-03-15 10:30:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000045", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000601", "created_ts": "2024-03-15 11:45:01", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000601", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000443", "created_ts": "2024-03-16 11:40:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000443", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000444", "created_ts": "2024-03-17 09:00:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000444", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000813", "created_ts": "2024-03-18 09:10:01", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000813", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000602", "created_ts": "2024-03-18 09:40:01", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000602", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000046", "created_ts": "2024-03-18 10:00:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000046", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000710", "created_ts": "2024-03-18 11:00:21", "analyst": "analyst_09", "archetype": "refund_spike", "sql_id": "S000710", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000745", "created_ts": "2024-03-18 11:40:02", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000745", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001420", "created_ts": "2024-03-18 12:10:21", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S001420", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001246", "created_ts": "2024-03-18 14:40:02", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S001246", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000994", "created_ts": "2024-03-18 15:20:05", "analyst": "analyst_11", "archetype": "support_sla", "sql_id": "S000994", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000983", "created_ts": "2024-03-18 15:30:34", "analyst": "analyst_12", "archetype": "marketing_last_touch", "sql_id": "S000983", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001027", "created_ts": "2024-03-18 17:30:55", "analyst": "analyst_06", "archetype": "marketing_last_touch", "sql_id": "S001027", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000445", "created_ts": "2024-03-19 09:50:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000445", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000254", "created_ts": "2024-03-19 11:50:08", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S000254", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000255", "created_ts": "2024-03-20 09:40:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000255", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000603", "created_ts": "2024-03-20 11:20:00", "analyst": "analyst_11", "archetype": "campaign_funnel", "sql_id": "S000603", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000446", "created_ts": "2024-03-20 11:20:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000446", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001497", "created_ts": "2024-03-20 15:40:05", "analyst": "analyst_08", "archetype": "attendance_rate", "sql_id": "S001497", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000447", "created_ts": "2024-03-21 09:20:02", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000447", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000256", "created_ts": "2024-03-21 11:00:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000256", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000604", "created_ts": "2024-03-22 08:10:01", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000604", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000448", "created_ts": "2024-03-22 08:40:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000448", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000047", "created_ts": "2024-03-25 09:45:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000047", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000257", "created_ts": "2024-03-25 11:20:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000257", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001332", "created_ts": "2024-03-25 12:45:21", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S001332", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001268", "created_ts": "2024-03-25 13:07:01", "analyst": "analyst_02", "archetype": "marketing_last_touch", "sql_id": "S001268", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000746", "created_ts": "2024-03-25 14:10:34", "analyst": "analyst_12", "archetype": "attach_rate", "sql_id": "S000746", "expected_sources": ["raw_ticket_sales", "raw_merch_orders", "tmp_e000746"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}, {"name": "tmp_e000746", "expr": "temp materialization"}]}
{"query_id": "E001472", "created_ts": "2024-03-25 14:15:21", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S001472", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000814", "created_ts": "2024-03-25 14:30:13", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000814", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000048", "created_ts": "2024-03-26 09:50:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000048", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000605", "created_ts": "2024-03-26 10:15:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000605", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000258", "created_ts": "2024-03-26 10:45:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000258", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001147", "created_ts": "2024-03-26 16:15:03", "analyst": "analyst_12", "archetype": "deals_pipeline", "sql_id": "S001147", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000049", "created_ts": "2024-03-27 09:20:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000049", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000606", "created_ts": "2024-03-27 09:50:00", "analyst": "analyst_01", "archetype": "campaign_funnel", "sql_id": "S000606", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000259", "created_ts": "2024-03-27 11:45:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000259", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001340", "created_ts": "2024-03-27 12:15:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S001340", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001390", "created_ts": "2024-03-27 15:03:13", "analyst": "analyst_07", "archetype": "refund_spike", "sql_id": "S001390", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000050", "created_ts": "2024-03-28 11:05:34", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S000050", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001190", "created_ts": "2024-03-28 13:25:13", "analyst": "analyst_10", "archetype": "marketing_last_touch", "sql_id": "S001190", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001489", "created_ts": "2024-03-28 16:10:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S001489", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001096", "created_ts": "2024-03-28 18:35:00", "analyst": "analyst_01", "archetype": "deals_pipeline", "sql_id": "S001096", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001380", "created_ts": "2024-03-29 13:10:55", "analyst": "analyst_11", "archetype": "campaign_funnel", "sql_id": "S001380", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001209", "created_ts": "2024-03-29 16:40:05", "analyst": "analyst_04", "archetype": "attach_rate", "sql_id": "S001209", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001461", "created_ts": "2024-03-29 18:30:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S001461", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000051", "created_ts": "2024-03-31 10:05:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000051", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000449", "created_ts": "2024-04-01 08:50:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000449", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000260", "created_ts": "2024-04-01 09:20:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000260", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000853", "created_ts": "2024-04-01 10:30:00", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S000853", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001416", "created_ts": "2024-04-01 11:07:08", "analyst": "analyst_03", "archetype": "rfm_segmentation", "sql_id": "S001416", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000780", "created_ts": "2024-04-01 11:30:05", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000780", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000607", "created_ts": "2024-04-01 11:40:05", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000607", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000863", "created_ts": "2024-04-01 12:45:02", "analyst": "analyst_04", "archetype": "support_sla", "sql_id": "S000863", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001486", "created_ts": "2024-04-01 12:45:02", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S001486", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000874", "created_ts": "2024-04-01 13:00:05", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000874", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001105", "created_ts": "2024-04-01 14:07:34", "analyst": "analyst_03", "archetype": "ticket_revenue_daily", "sql_id": "S001105", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001492", "created_ts": "2024-04-01 14:30:55", "analyst": "analyst_07", "archetype": "refund_spike", "sql_id": "S001492", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000844", "created_ts": "2024-04-01 15:00:05", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S000844", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001256", "created_ts": "2024-04-01 20:03:05", "analyst": "analyst_10", "archetype": "support_sla", "sql_id": "S001256", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000052", "created_ts": "2024-04-02 09:30:00", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000052", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000450", "created_ts": "2024-04-02 10:10:00", "analyst": "analyst_05", "archetype": "attendance_rate", "sql_id": "S000450", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000451", "created_ts": "2024-04-03 08:00:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000451", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000261", "created_ts": "2024-04-03 08:05:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000261", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000053", "created_ts": "2024-04-03 09:00:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000053", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000054", "created_ts": "2024-04-04 09:50:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000054", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000608", "created_ts": "2024-04-04 11:40:01", "analyst": "analyst_11", "archetype": "campaign_funnel", "sql_id": "S000608", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001094", "created_ts": "2024-04-04 12:10:34", "analyst": "analyst_01", "archetype": "marketing_last_touch", "sql_id": "S001094", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000452", "created_ts": "2024-04-05 08:00:34", "analyst": "analyst_11", "archetype": "attendance_rate", "sql_id": "S000452", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001317", "created_ts": "2024-04-05 10:15:05", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S001317", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000055", "created_ts": "2024-04-05 11:30:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000055", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001095", "created_ts": "2024-04-05 12:45:08", "analyst": "analyst_07", "archetype": "attendance_rate", "sql_id": "S001095", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000056", "created_ts": "2024-04-08 08:40:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000056", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001188", "created_ts": "2024-04-08 10:45:55", "analyst": "analyst_12", "archetype": "support_sla", "sql_id": "S001188", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000781", "created_ts": "2024-04-08 13:00:13", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000781", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001137", "created_ts": "2024-04-08 13:25:00", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S001137", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e001137"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e001137", "expr": "temp materialization"}]}
{"query_id": "E001214", "created_ts": "2024-04-08 13:45:55", "analyst": "analyst_09", "archetype": "marketing_last_touch", "sql_id": "S001214", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000815", "created_ts": "2024-04-08 14:20:34", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000815", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001357", "created_ts": "2024-04-08 16:15:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S001357", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001092", "created_ts": "2024-04-08 17:40:34", "analyst": "analyst_08", "archetype": "attendance_rate", "sql_id": "S001092", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000609", "created_ts": "2024-04-09 10:15:13", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000609", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000057", "created_ts": "2024-04-09 11:05:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000057", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000610", "created_ts": "2024-04-10 08:30:00", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000610", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000058", "created_ts": "2024-04-10 11:20:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000058", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001349", "created_ts": "2024-04-10 12:15:03", "analyst": "analyst_02", "archetype": "deals_pipeline", "sql_id": "S001349", "expected_sources": ["crm_deals", "tmp_e001349"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}, {"name": "tmp_e001349", "expr": "temp materialization"}]}
{"query_id": "E001293", "created_ts": "2024-04-10 17:25:55", "analyst": "analyst_01", "archetype": "refund_spike", "sql_id": "S001293", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000059", "created_ts": "2024-04-11 08:40:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000059", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000262", "created_ts": "2024-04-11 09:40:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000262", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000453", "created_ts": "2024-04-11 10:15:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000453", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001375", "created_ts": "2024-04-11 15:07:34", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S001375", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001301", "created_ts": "2024-04-11 15:50:13", "analyst": "analyst_07", "archetype": "campaign_funnel", "sql_id": "S001301", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001045", "created_ts": "2024-04-11 17:25:13", "analyst": "analyst_04", "archetype": "deals_pipeline", "sql_id": "S001045", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000060", "created_ts": "2024-04-12 10:00:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000060", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000454", "created_ts": "2024-04-12 10:50:34", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000454", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000263", "created_ts": "2024-04-12 11:00:01", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000263", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001178", "created_ts": "2024-04-12 15:10:03", "analyst": "analyst_11", "archetype": "attendance_rate", "sql_id": "S001178", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000455", "created_ts": "2024-04-13 10:45:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000455", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e000455"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e000455", "expr": "temp materialization"}]}
{"query_id": "E000061", "created_ts": "2024-04-14 08:05:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000061", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000456", "created_ts": "2024-04-15 08:45:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000456", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e000456"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e000456", "expr": "temp materialization"}]}
{"query_id": "E000611", "created_ts": "2024-04-15 10:05:02", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000611", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001093", "created_ts": "2024-04-15 10:30:02", "analyst": "analyst_12", "archetype": "support_sla", "sql_id": "S001093", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000264", "created_ts": "2024-04-15 11:15:01", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000264", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001025", "created_ts": "2024-04-15 12:00:55", "analyst": "analyst_10", "archetype": "marketing_last_touch", "sql_id": "S001025", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001215", "created_ts": "2024-04-15 14:55:02", "analyst": "analyst_09", "archetype": "refund_spike", "sql_id": "S001215", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000965", "created_ts": "2024-04-15 17:35:21", "analyst": "analyst_04", "archetype": "attendance_rate", "sql_id": "S000965", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000966", "created_ts": "2024-04-15 17:43:21", "analyst": "analyst_04", "archetype": "attendance_rate", "sql_id": "S000966", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000967", "created_ts": "2024-04-15 19:05:21", "analyst": "analyst_04", "archetype": "attendance_rate", "sql_id": "S000967", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000062", "created_ts": "2024-04-16 08:15:34", "analyst": "analyst_12", "archetype": "ticket_revenue_daily", "sql_id": "S000062", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000265", "created_ts": "2024-04-16 09:10:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000265", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000063", "created_ts": "2024-04-17 10:50:21", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000063", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001289", "created_ts": "2024-04-17 11:00:03", "analyst": "analyst_11", "archetype": "ticket_revenue_daily", "sql_id": "S001289", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000612", "created_ts": "2024-04-17 11:10:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000612", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001447", "created_ts": "2024-04-17 17:35:13", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S001447", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e001447"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e001447", "expr": "temp materialization"}]}
{"query_id": "E000457", "created_ts": "2024-04-18 09:40:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000457", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001422", "created_ts": "2024-04-18 10:07:05", "analyst": "analyst_07", "archetype": "marketing_last_touch", "sql_id": "S001422", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001244", "created_ts": "2024-04-18 10:15:01", "analyst": "analyst_05", "archetype": "attendance_rate", "sql_id": "S001244", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000064", "created_ts": "2024-04-18 10:15:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000064", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000266", "created_ts": "2024-04-18 11:15:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000266", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000065", "created_ts": "2024-04-19 08:50:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000065", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000267", "created_ts": "2024-04-19 11:00:01", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000267", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000267"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000267", "expr": "temp materialization"}]}
{"query_id": "E000066", "created_ts": "2024-04-22 08:05:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000066", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000885", "created_ts": "2024-04-22 09:30:05", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S000885", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000886", "created_ts": "2024-04-22 09:38:05", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S000886", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000887", "created_ts": "2024-04-22 09:54:05", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S000887", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000268", "created_ts": "2024-04-22 10:00:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000268", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000782", "created_ts": "2024-04-22 10:10:13", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000782", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000888", "created_ts": "2024-04-22 10:15:05", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S000888", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000747", "created_ts": "2024-04-22 10:50:21", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000747", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000458", "created_ts": "2024-04-22 11:50:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000458", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001014", "created_ts": "2024-04-22 12:10:34", "analyst": "analyst_09", "archetype": "support_sla", "sql_id": "S001014", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000711", "created_ts": "2024-04-22 14:50:05", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000711", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001377", "created_ts": "2024-04-22 15:25:34", "analyst": "analyst_11", "archetype": "attach_rate", "sql_id": "S001377", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001072", "created_ts": "2024-04-22 17:40:03", "analyst": "analyst_01", "archetype": "refund_spike", "sql_id": "S001072", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001204", "created_ts": "2024-04-22 18:40:00", "analyst": "analyst_01", "archetype": "deals_pipeline", "sql_id": "S001204", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000269", "created_ts": "2024-04-23 08:40:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000269", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000067", "created_ts": "2024-04-23 09:50:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000067", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000613", "created_ts": "2024-04-23 11:15:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000613", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000068", "created_ts": "2024-04-24 08:10:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000068", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000459", "created_ts": "2024-04-24 08:45:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000459", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001083", "created_ts": "2024-04-24 09:07:02", "analyst": "analyst_12", "archetype": "deals_pipeline", "sql_id": "S001083", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000270", "created_ts": "2024-04-24 11:20:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000270", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000614", "created_ts": "2024-04-25 08:20:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000614", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000271", "created_ts": "2024-04-25 08:30:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000271", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000460", "created_ts": "2024-04-25 08:50:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000460", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000272", "created_ts": "2024-04-26 08:50:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000272", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000069", "created_ts": "2024-04-26 10:05:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000069", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000615", "created_ts": "2024-04-27 10:15:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000615", "expected_sources": ["raw_digital_events", "tmp_e000615"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000615", "expr": "temp materialization"}]}
{"query_id": "E000783", "created_ts": "2024-04-29 09:00:21", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000783", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000070", "created_ts": "2024-04-29 09:10:13", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S000070", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001460", "created_ts": "2024-04-29 09:35:00", "analyst": "analyst_11", "archetype": "attendance_rate", "sql_id": "S001460", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000273", "created_ts": "2024-04-29 10:40:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000273", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000461", "created_ts": "2024-04-29 11:50:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000461", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e000461"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e000461", "expr": "temp materialization"}]}
{"query_id": "E000712", "created_ts": "2024-04-29 13:10:08", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000712", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000816", "created_ts": "2024-04-29 13:20:05", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000816", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000274", "created_ts": "2024-04-30 10:30:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000274", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000071", "created_ts": "2024-04-30 11:45:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000071", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000462", "created_ts": "2024-05-01 08:50:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000462", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000072", "created_ts": "2024-05-01 10:45:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000072", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000854", "created_ts": "2024-05-01 10:45:00", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S000854", "expected_sources": ["crm_deals", "tmp_e000854"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}, {"name": "tmp_e000854", "expr": "temp materialization"}]}
{"query_id": "E000275", "created_ts": "2024-05-01 10:50:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000275", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000970", "created_ts": "2024-05-01 12:50:13", "analyst": "analyst_12", "archetype": "attendance_rate", "sql_id": "S000970", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000864", "created_ts": "2024-05-01 13:30:01", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000864", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000971", "created_ts": "2024-05-01 13:35:13", "analyst": "analyst_12", "archetype": "attendance_rate", "sql_id": "S000971", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001378", "created_ts": "2024-05-01 18:40:05", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S001378", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000073", "created_ts": "2024-05-02 09:50:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000073", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000276", "created_ts": "2024-05-02 11:10:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000276", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000947", "created_ts": "2024-05-02 12:50:03", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S000947", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000948", "created_ts": "2024-05-02 12:58:03", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S000948", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000949", "created_ts": "2024-05-02 13:06:03", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S000949", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001032", "created_ts": "2024-05-02 15:10:03", "analyst": "analyst_02", "archetype": "rfm_segmentation", "sql_id": "S001032", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001111", "created_ts": "2024-05-02 17:00:21", "analyst": "analyst_09", "archetype": "attendance_rate", "sql_id": "S001111", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001077", "created_ts": "2024-05-02 17:07:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S001077", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000074", "created_ts": "2024-05-03 08:45:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000074", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000277", "created_ts": "2024-05-05 09:30:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000277", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000616", "created_ts": "2024-05-06 09:00:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000616", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000278", "created_ts": "2024-05-06 09:20:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000278", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000075", "created_ts": "2024-05-06 09:40:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000075", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000784", "created_ts": "2024-05-06 13:00:01", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000784", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001365", "created_ts": "2024-05-06 13:07:03", "analyst": "analyst_07", "archetype": "refund_spike", "sql_id": "S001365", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000748", "created_ts": "2024-05-06 13:40:08", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000748", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001108", "created_ts": "2024-05-06 18:10:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S001108", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001165", "created_ts": "2024-05-06 18:50:08", "analyst": "analyst_02", "archetype": "attendance_rate", "sql_id": "S001165", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000076", "created_ts": "2024-05-07 09:00:02", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S000076", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000463", "created_ts": "2024-05-07 11:45:02", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000463", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001274", "created_ts": "2024-05-07 12:40:03", "analyst": "analyst_05", "archetype": "attendance_rate", "sql_id": "S001274", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001049", "created_ts": "2024-05-07 13:50:08", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001049", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000077", "created_ts": "2024-05-08 09:10:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000077", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000279", "created_ts": "2024-05-08 10:20:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000279", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001239", "created_ts": "2024-05-08 14:45:00", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S001239", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000280", "created_ts": "2024-05-09 08:00:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000280", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000078", "created_ts": "2024-05-09 08:10:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000078", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000936", "created_ts": "2024-05-09 09:25:34", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S000936", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000938", "created_ts": "2024-05-09 09:49:34", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S000938", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000937", "created_ts": "2024-05-09 09:55:34", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S000937", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000939", "created_ts": "2024-05-09 11:40:34", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S000939", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001069", "created_ts": "2024-05-09 13:03:02", "analyst": "analyst_03", "archetype": "refund_spike", "sql_id": "S001069", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001110", "created_ts": "2024-05-09 13:10:55", "analyst": "analyst_03", "archetype": "attach_rate", "sql_id": "S001110", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001004", "created_ts": "2024-05-09 19:25:01", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S001004", "expected_sources": ["raw_digital_events", "tmp_e001004"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e001004", "expr": "temp materialization"}]}
{"query_id": "E000464", "created_ts": "2024-05-10 10:20:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000464", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001220", "created_ts": "2024-05-10 11:20:03", "analyst": "analyst_04", "archetype": "refund_spike", "sql_id": "S001220", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001088", "created_ts": "2024-05-13 09:40:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S001088", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000817", "created_ts": "2024-05-13 09:50:05", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000817", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000281", "created_ts": "2024-05-13 10:00:00", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000281", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000079", "created_ts": "2024-05-13 10:10:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000079", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000713", "created_ts": "2024-05-13 10:30:03", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000713", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000749", "created_ts": "2024-05-13 10:30:55", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000749", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000465", "created_ts": "2024-05-13 10:40:05", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000465", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000617", "created_ts": "2024-05-13 10:45:08", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000617", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001441", "created_ts": "2024-05-13 16:07:00", "analyst": "analyst_09", "archetype": "refund_spike", "sql_id": "S001441", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000282", "created_ts": "2024-05-14 08:20:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000282", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000282"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000282", "expr": "temp materialization"}]}
{"query_id": "E000618", "created_ts": "2024-05-14 08:50:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000618", "expected_sources": ["raw_digital_events", "tmp_e000618"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000618", "expr": "temp materialization"}]}
{"query_id": "E000466", "created_ts": "2024-05-14 09:00:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000466", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000080", "created_ts": "2024-05-14 11:40:13", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S000080", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001437", "created_ts": "2024-05-14 12:07:21", "analyst": "analyst_07", "archetype": "attendance_rate", "sql_id": "S001437", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001020", "created_ts": "2024-05-14 12:15:08", "analyst": "analyst_04", "archetype": "ticket_revenue_daily", "sql_id": "S001020", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000619", "created_ts": "2024-05-15 10:45:01", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000619", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001391", "created_ts": "2024-05-15 11:15:13", "analyst": "analyst_10", "archetype": "support_sla", "sql_id": "S001391", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000081", "created_ts": "2024-05-15 11:30:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000081", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001401", "created_ts": "2024-05-15 15:35:34", "analyst": "analyst_08", "archetype": "rfm_segmentation", "sql_id": "S001401", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000984", "created_ts": "2024-05-15 16:00:05", "analyst": "analyst_12", "archetype": "ticket_revenue_daily", "sql_id": "S000984", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000283", "created_ts": "2024-05-16 09:00:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000283", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000467", "created_ts": "2024-05-16 11:15:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000467", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000082", "created_ts": "2024-05-16 11:50:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000082", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001344", "created_ts": "2024-05-16 12:30:05", "analyst": "analyst_06", "archetype": "refund_spike", "sql_id": "S001344", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001238", "created_ts": "2024-05-16 15:40:13", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S001238", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e001238"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e001238", "expr": "temp materialization"}]}
{"query_id": "E001356", "created_ts": "2024-05-16 18:45:03", "analyst": "analyst_10", "archetype": "attach_rate", "sql_id": "S001356", "expected_sources": ["raw_ticket_sales", "raw_merch_orders", "tmp_e001356"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}, {"name": "tmp_e001356", "expr": "temp materialization"}]}
{"query_id": "E000083", "created_ts": "2024-05-17 09:05:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000083", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000284", "created_ts": "2024-05-17 11:05:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000284", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000620", "created_ts": "2024-05-19 09:15:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000620", "expected_sources": ["raw_digital_events", "tmp_e000620"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000620", "expr": "temp materialization"}]}
{"query_id": "E001066", "created_ts": "2024-05-20 09:15:08", "analyst": "analyst_07", "archetype": "deals_pipeline", "sql_id": "S001066", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000714", "created_ts": "2024-05-20 09:20:13", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000714", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000785", "created_ts": "2024-05-20 10:40:55", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000785", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000468", "created_ts": "2024-05-20 10:45:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000468", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001200", "created_ts": "2024-05-20 11:40:34", "analyst": "analyst_03", "archetype": "attach_rate", "sql_id": "S001200", "expected_sources": ["raw_ticket_sales", "raw_merch_orders", "tmp_e001200"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}, {"name": "tmp_e001200", "expr": "temp materialization"}]}
{"query_id": "E000818", "created_ts": "2024-05-20 14:00:13", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000818", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001412", "created_ts": "2024-05-20 15:35:08", "analyst": "analyst_06", "archetype": "deals_pipeline", "sql_id": "S001412", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001273", "created_ts": "2024-05-20 17:25:08", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S001273", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001339", "created_ts": "2024-05-20 17:55:00", "analyst": "analyst_02", "archetype": "deals_pipeline", "sql_id": "S001339", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000084", "created_ts": "2024-05-21 09:30:21", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S000084", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000285", "created_ts": "2024-05-21 10:15:21", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S000285", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000469", "created_ts": "2024-05-21 11:10:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000469", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000085", "created_ts": "2024-05-22 08:20:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000085", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000085"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000085", "expr": "temp materialization"}]}
{"query_id": "E000286", "created_ts": "2024-05-22 09:05:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000286", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001366", "created_ts": "2024-05-22 15:07:01", "analyst": "analyst_12", "archetype": "campaign_funnel", "sql_id": "S001366", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000989", "created_ts": "2024-05-22 16:25:01", "analyst": "analyst_08", "archetype": "attendance_rate", "sql_id": "S000989", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e000989"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e000989", "expr": "temp materialization"}]}
{"query_id": "E001234", "created_ts": "2024-05-23 09:10:08", "analyst": "analyst_12", "archetype": "marketing_last_touch", "sql_id": "S001234", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000086", "created_ts": "2024-05-24 09:15:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000086", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000470", "created_ts": "2024-05-24 10:50:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000470", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001307", "created_ts": "2024-05-24 16:50:02", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S001307", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000287", "created_ts": "2024-05-26 10:30:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000287", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001036", "created_ts": "2024-05-27 09:03:55", "analyst": "analyst_10", "archetype": "support_sla", "sql_id": "S001036", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000288", "created_ts": "2024-05-27 09:50:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000288", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000087", "created_ts": "2024-05-27 10:00:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000087", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000715", "created_ts": "2024-05-27 11:00:55", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000715", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001227", "created_ts": "2024-05-27 12:50:03", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S001227", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001260", "created_ts": "2024-05-27 13:20:00", "analyst": "analyst_11", "archetype": "campaign_funnel", "sql_id": "S001260", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000786", "created_ts": "2024-05-27 13:20:13", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000786", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000750", "created_ts": "2024-05-27 13:40:01", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000750", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000088", "created_ts": "2024-05-28 09:00:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000088", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000088"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000088", "expr": "temp materialization"}]}
{"query_id": "E001182", "created_ts": "2024-05-28 11:00:03", "analyst": "analyst_06", "archetype": "marketing_last_touch", "sql_id": "S001182", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000471", "created_ts": "2024-05-28 11:40:21", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S000471", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000089", "created_ts": "2024-05-29 08:00:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000089", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000089"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000089", "expr": "temp materialization"}]}
{"query_id": "E000289", "created_ts": "2024-05-29 09:10:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000289", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001164", "created_ts": "2024-05-29 13:35:55", "analyst": "analyst_01", "archetype": "support_sla", "sql_id": "S001164", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001452", "created_ts": "2024-05-29 13:50:34", "analyst": "analyst_06", "archetype": "support_sla", "sql_id": "S001452", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000472", "created_ts": "2024-05-30 08:15:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000472", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000090", "created_ts": "2024-05-30 10:05:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000090", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001252", "created_ts": "2024-05-30 10:15:34", "analyst": "analyst_07", "archetype": "marketing_last_touch", "sql_id": "S001252", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001275", "created_ts": "2024-05-30 12:07:00", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S001275", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001397", "created_ts": "2024-05-30 16:55:01", "analyst": "analyst_05", "archetype": "deals_pipeline", "sql_id": "S001397", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000091", "created_ts": "2024-05-31 09:00:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000091", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000290", "created_ts": "2024-05-31 10:00:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000290", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000473", "created_ts": "2024-05-31 11:15:03", "analyst": "analyst_05", "archetype": "attendance_rate", "sql_id": "S000473", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e000473"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e000473", "expr": "temp materialization"}]}
{"query_id": "E001467", "created_ts": "2024-05-31 11:55:08", "analyst": "analyst_06", "archetype": "refund_spike", "sql_id": "S001467", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001449", "created_ts": "2024-05-31 14:55:13", "analyst": "analyst_12", "archetype": "ticket_revenue_daily", "sql_id": "S001449", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001211", "created_ts": "2024-05-31 16:50:13", "analyst": "analyst_06", "archetype": "refund_spike", "sql_id": "S001211", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000855", "created_ts": "2024-06-03 10:45:21", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S000855", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000092", "created_ts": "2024-06-03 11:00:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000092", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000291", "created_ts": "2024-06-03 11:45:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000291", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000992", "created_ts": "2024-06-03 12:00:55", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S000992", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001373", "created_ts": "2024-06-03 12:40:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S001373", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e001373"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e001373", "expr": "temp materialization"}]}
{"query_id": "E001071", "created_ts": "2024-06-03 14:10:01", "analyst": "analyst_09", "archetype": "attach_rate", "sql_id": "S001071", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000819", "created_ts": "2024-06-03 14:10:02", "analyst": "analyst_01", "archetype": "marketing_last_touch", "sql_id": "S000819", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000716", "created_ts": "2024-06-03 14:40:55", "analyst": "analyst_11", "archetype": "refund_spike", "sql_id": "S000716", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000751", "created_ts": "2024-06-03 14:50:02", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000751", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000845", "created_ts": "2024-06-03 15:00:13", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S000845", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000865", "created_ts": "2024-06-03 15:00:21", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000865", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000621", "created_ts": "2024-06-04 08:45:01", "analyst": "analyst_10", "archetype": "campaign_funnel", "sql_id": "S000621", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001424", "created_ts": "2024-06-04 09:35:13", "analyst": "analyst_05", "archetype": "campaign_funnel", "sql_id": "S001424", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000474", "created_ts": "2024-06-04 09:40:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000474", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e000474"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e000474", "expr": "temp materialization"}]}
{"query_id": "E000292", "created_ts": "2024-06-04 09:40:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000292", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000292"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000292", "expr": "temp materialization"}]}
{"query_id": "E000093", "created_ts": "2024-06-04 11:45:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000093", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000094", "created_ts": "2024-06-05 09:45:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000094", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001243", "created_ts": "2024-06-05 15:35:05", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S001243", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000095", "created_ts": "2024-06-06 08:05:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000095", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000475", "created_ts": "2024-06-06 08:30:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000475", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000622", "created_ts": "2024-06-06 10:00:05", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000622", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000293", "created_ts": "2024-06-06 10:00:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000293", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000893", "created_ts": "2024-06-06 12:03:00", "analyst": "analyst_12", "archetype": "refund_spike", "sql_id": "S000893", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000895", "created_ts": "2024-06-06 12:19:00", "analyst": "analyst_12", "archetype": "refund_spike", "sql_id": "S000895", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000894", "created_ts": "2024-06-06 13:03:00", "analyst": "analyst_12", "archetype": "refund_spike", "sql_id": "S000894", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001288", "created_ts": "2024-06-06 18:20:05", "analyst": "analyst_07", "archetype": "attendance_rate", "sql_id": "S001288", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001019", "created_ts": "2024-06-06 19:03:00", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S001019", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000623", "created_ts": "2024-06-07 08:45:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000623", "expected_sources": ["raw_digital_events", "tmp_e000623"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000623", "expr": "temp materialization"}]}
{"query_id": "E000096", "created_ts": "2024-06-07 09:20:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000096", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000476", "created_ts": "2024-06-07 10:10:34", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000476", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001405", "created_ts": "2024-06-07 10:25:08", "analyst": "analyst_02", "archetype": "marketing_last_touch", "sql_id": "S001405", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000294", "created_ts": "2024-06-07 11:05:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000294", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001287", "created_ts": "2024-06-08 18:15:08", "analyst": "analyst_03", "archetype": "marketing_last_touch", "sql_id": "S001287", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001155", "created_ts": "2024-06-09 10:00:05", "analyst": "analyst_02", "archetype": "attendance_rate", "sql_id": "S001155", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001348", "created_ts": "2024-06-09 15:45:03", "analyst": "analyst_10", "archetype": "refund_spike", "sql_id": "S001348", "expected_sources": ["raw_ticket_sales", "tmp_e001348"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}, {"name": "tmp_e001348", "expr": "temp materialization"}]}
{"query_id": "E000295", "created_ts": "2024-06-10 08:00:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000295", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000097", "created_ts": "2024-06-10 09:15:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000097", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000624", "created_ts": "2024-06-10 10:00:02", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000624", "expected_sources": ["raw_digital_events", "tmp_e000624"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000624", "expr": "temp materialization"}]}
{"query_id": "E000477", "created_ts": "2024-06-10 10:30:34", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000477", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001168", "created_ts": "2024-06-10 17:20:34", "analyst": "analyst_08", "archetype": "attendance_rate", "sql_id": "S001168", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001341", "created_ts": "2024-06-10 18:30:05", "analyst": "analyst_12", "archetype": "deals_pipeline", "sql_id": "S001341", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000296", "created_ts": "2024-06-11 10:10:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000296", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000098", "created_ts": "2024-06-11 11:05:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000098", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000478", "created_ts": "2024-06-11 11:40:55", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S000478", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000625", "created_ts": "2024-06-12 08:45:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000625", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000479", "created_ts": "2024-06-12 09:50:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000479", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000297", "created_ts": "2024-06-12 10:05:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000297", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000099", "created_ts": "2024-06-12 10:10:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000099", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001120", "created_ts": "2024-06-12 12:55:34", "analyst": "analyst_02", "archetype": "support_sla", "sql_id": "S001120", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000100", "created_ts": "2024-06-13 08:15:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000100", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000100"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000100", "expr": "temp materialization"}]}
{"query_id": "E001271", "created_ts": "2024-06-13 09:40:34", "analyst": "analyst_10", "archetype": "refund_spike", "sql_id": "S001271", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001279", "created_ts": "2024-06-13 10:00:34", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S001279", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001278", "created_ts": "2024-06-13 10:20:02", "analyst": "analyst_06", "archetype": "marketing_last_touch", "sql_id": "S001278", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001478", "created_ts": "2024-06-13 14:00:21", "analyst": "analyst_12", "archetype": "ticket_revenue_daily", "sql_id": "S001478", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001134", "created_ts": "2024-06-13 16:40:21", "analyst": "analyst_12", "archetype": "marketing_last_touch", "sql_id": "S001134", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001342", "created_ts": "2024-06-13 18:45:00", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S001342", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000101", "created_ts": "2024-06-14 09:00:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000101", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000480", "created_ts": "2024-06-14 09:45:08", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000480", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000298", "created_ts": "2024-06-14 10:50:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000298", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001355", "created_ts": "2024-06-14 15:55:03", "analyst": "analyst_12", "archetype": "attach_rate", "sql_id": "S001355", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001393", "created_ts": "2024-06-14 15:55:55", "analyst": "analyst_11", "archetype": "attach_rate", "sql_id": "S001393", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001003", "created_ts": "2024-06-15 09:40:21", "analyst": "analyst_08", "archetype": "deals_pipeline", "sql_id": "S001003", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000102", "created_ts": "2024-06-15 10:10:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000102", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000102"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000102", "expr": "temp materialization"}]}
{"query_id": "E000299", "created_ts": "2024-06-16 08:40:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000299", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000481", "created_ts": "2024-06-17 08:50:02", "analyst": "analyst_09", "archetype": "attendance_rate", "sql_id": "S000481", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000103", "created_ts": "2024-06-17 09:30:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000103", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000300", "created_ts": "2024-06-17 09:45:13", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000300", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000717", "created_ts": "2024-06-17 10:00:03", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000717", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000820", "created_ts": "2024-06-17 10:00:34", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000820", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001251", "created_ts": "2024-06-17 11:35:13", "analyst": "analyst_12", "archetype": "marketing_last_touch", "sql_id": "S001251", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001063", "created_ts": "2024-06-17 13:00:13", "analyst": "analyst_10", "archetype": "marketing_last_touch", "sql_id": "S001063", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001480", "created_ts": "2024-06-17 14:03:34", "analyst": "analyst_06", "archetype": "support_sla", "sql_id": "S001480", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000934", "created_ts": "2024-06-17 16:10:34", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000934", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000935", "created_ts": "2024-06-17 16:40:34", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000935", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000482", "created_ts": "2024-06-18 09:15:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000482", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000301", "created_ts": "2024-06-18 09:50:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000301", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000104", "created_ts": "2024-06-18 11:00:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000104", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001498", "created_ts": "2024-06-18 12:15:21", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S001498", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000626", "created_ts": "2024-06-19 10:10:05", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000626", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001098", "created_ts": "2024-06-19 10:10:08", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001098", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e001098"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e001098", "expr": "temp materialization"}]}
{"query_id": "E000105", "created_ts": "2024-06-19 10:15:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000105", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001005", "created_ts": "2024-06-19 13:15:05", "analyst": "analyst_08", "archetype": "support_sla", "sql_id": "S001005", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000483", "created_ts": "2024-06-20 11:00:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000483", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000106", "created_ts": "2024-06-20 11:05:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000106", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000302", "created_ts": "2024-06-20 11:45:00", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000302", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000303", "created_ts": "2024-06-21 08:45:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000303", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000484", "created_ts": "2024-06-21 10:40:34", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000484", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000107", "created_ts": "2024-06-21 11:45:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000107", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000485", "created_ts": "2024-06-24 09:10:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000485", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001434", "created_ts": "2024-06-24 10:35:55", "analyst": "analyst_11", "archetype": "attendance_rate", "sql_id": "S001434", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000821", "created_ts": "2024-06-24 10:40:13", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000821", "expected_sources": ["raw_ticket_sales", "marketing_touches", "tmp_e000821"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}, {"name": "tmp_e000821", "expr": "temp materialization"}]}
{"query_id": "E000108", "created_ts": "2024-06-24 11:50:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000108", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000718", "created_ts": "2024-06-24 13:00:55", "analyst": "analyst_01", "archetype": "refund_spike", "sql_id": "S000718", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001300", "created_ts": "2024-06-24 15:50:05", "analyst": "analyst_11", "archetype": "support_sla", "sql_id": "S001300", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001181", "created_ts": "2024-06-24 17:25:05", "analyst": "analyst_02", "archetype": "attendance_rate", "sql_id": "S001181", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000627", "created_ts": "2024-06-25 08:20:55", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S000627", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000486", "created_ts": "2024-06-25 10:30:34", "analyst": "analyst_09", "archetype": "attendance_rate", "sql_id": "S000486", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000109", "created_ts": "2024-06-25 11:20:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000109", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000487", "created_ts": "2024-06-26 08:50:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000487", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000628", "created_ts": "2024-06-26 09:00:02", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000628", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000304", "created_ts": "2024-06-26 11:05:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000304", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000968", "created_ts": "2024-06-26 14:40:02", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S000968", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000969", "created_ts": "2024-06-26 14:52:02", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S000969", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000969"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000969", "expr": "temp materialization"}]}
{"query_id": "E000488", "created_ts": "2024-06-27 08:45:05", "analyst": "analyst_01", "archetype": "attendance_rate", "sql_id": "S000488", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000110", "created_ts": "2024-06-27 10:45:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000110", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000110"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000110", "expr": "temp materialization"}]}
{"query_id": "E000305", "created_ts": "2024-06-27 11:20:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000305", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000629", "created_ts": "2024-06-28 11:30:08", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000629", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000306", "created_ts": "2024-06-28 11:40:34", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S000306", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001231", "created_ts": "2024-06-30 15:10:05", "analyst": "analyst_02", "archetype": "campaign_funnel", "sql_id": "S001231", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000822", "created_ts": "2024-07-01 09:20:01", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000822", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000719", "created_ts": "2024-07-01 09:30:08", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000719", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000856", "created_ts": "2024-07-01 10:00:01", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S000856", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000630", "created_ts": "2024-07-01 10:05:05", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000630", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000875", "created_ts": "2024-07-01 10:15:08", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000875", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001085", "created_ts": "2024-07-01 10:20:05", "analyst": "analyst_08", "archetype": "attendance_rate", "sql_id": "S001085", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000489", "created_ts": "2024-07-01 11:05:05", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000489", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000111", "created_ts": "2024-07-01 11:20:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000111", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000307", "created_ts": "2024-07-01 11:40:05", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000307", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000752", "created_ts": "2024-07-01 13:00:21", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000752", "expected_sources": ["raw_ticket_sales", "raw_merch_orders", "tmp_e000752"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}, {"name": "tmp_e000752", "expr": "temp materialization"}]}
{"query_id": "E000846", "created_ts": "2024-07-01 15:15:01", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S000846", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000112", "created_ts": "2024-07-02 09:00:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000112", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001384", "created_ts": "2024-07-02 10:00:34", "analyst": "analyst_02", "archetype": "attach_rate", "sql_id": "S001384", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000631", "created_ts": "2024-07-02 11:10:13", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000631", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001323", "created_ts": "2024-07-02 13:35:03", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S001323", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000632", "created_ts": "2024-07-03 10:45:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000632", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000490", "created_ts": "2024-07-03 11:20:05", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000490", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001116", "created_ts": "2024-07-03 16:15:08", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S001116", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000308", "created_ts": "2024-07-04 08:00:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000308", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000308"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000308", "expr": "temp materialization"}]}
{"query_id": "E000491", "created_ts": "2024-07-04 08:20:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000491", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000113", "created_ts": "2024-07-04 09:00:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000113", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000309", "created_ts": "2024-07-05 09:40:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000309", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000309"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000309", "expr": "temp materialization"}]}
{"query_id": "E000114", "created_ts": "2024-07-05 10:45:21", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000114", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001463", "created_ts": "2024-07-05 12:40:08", "analyst": "analyst_05", "archetype": "campaign_funnel", "sql_id": "S001463", "expected_sources": ["raw_digital_events", "tmp_e001463"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e001463", "expr": "temp materialization"}]}
{"query_id": "E000115", "created_ts": "2024-07-06 11:40:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000115", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000310", "created_ts": "2024-07-08 09:20:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000310", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000116", "created_ts": "2024-07-08 10:05:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000116", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000116"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000116", "expr": "temp materialization"}]}
{"query_id": "E000492", "created_ts": "2024-07-08 10:40:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000492", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001006", "created_ts": "2024-07-08 14:50:34", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S001006", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001477", "created_ts": "2024-07-08 15:25:08", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S001477", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001331", "created_ts": "2024-07-08 16:03:34", "analyst": "analyst_01", "archetype": "attach_rate", "sql_id": "S001331", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000918", "created_ts": "2024-07-08 19:15:21", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S000918", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000919", "created_ts": "2024-07-08 20:00:21", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S000919", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000117", "created_ts": "2024-07-09 10:45:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000117", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000493", "created_ts": "2024-07-09 11:10:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000493", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000928", "created_ts": "2024-07-09 14:00:55", "analyst": "analyst_02", "archetype": "attendance_rate", "sql_id": "S000928", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000929", "created_ts": "2024-07-09 14:12:55", "analyst": "analyst_02", "archetype": "attendance_rate", "sql_id": "S000929", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000930", "created_ts": "2024-07-09 14:24:55", "analyst": "analyst_02", "archetype": "attendance_rate", "sql_id": "S000930", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000633", "created_ts": "2024-07-10 08:10:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000633", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000494", "created_ts": "2024-07-10 08:15:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000494", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000311", "created_ts": "2024-07-10 09:30:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000311", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000118", "created_ts": "2024-07-10 09:50:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000118", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000495", "created_ts": "2024-07-11 09:10:08", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000495", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000119", "created_ts": "2024-07-11 10:10:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000119", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000634", "created_ts": "2024-07-11 11:00:02", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000634", "expected_sources": ["raw_digital_events", "tmp_e000634"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000634", "expr": "temp materialization"}]}
{"query_id": "E001291", "created_ts": "2024-07-11 12:07:21", "analyst": "analyst_07", "archetype": "attach_rate", "sql_id": "S001291", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000635", "created_ts": "2024-07-12 08:50:08", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000635", "expected_sources": ["raw_digital_events", "tmp_e000635"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000635", "expr": "temp materialization"}]}
{"query_id": "E000120", "created_ts": "2024-07-12 10:00:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000120", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000312", "created_ts": "2024-07-12 10:15:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000312", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000121", "created_ts": "2024-07-15 08:15:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000121", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000753", "created_ts": "2024-07-15 09:00:01", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000753", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000720", "created_ts": "2024-07-15 09:00:05", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000720", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001438", "created_ts": "2024-07-15 09:30:34", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S001438", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000787", "created_ts": "2024-07-15 09:40:01", "analyst": "analyst_09", "archetype": "support_sla", "sql_id": "S000787", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001202", "created_ts": "2024-07-15 10:15:02", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S001202", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000823", "created_ts": "2024-07-15 11:50:02", "analyst": "analyst_09", "archetype": "marketing_last_touch", "sql_id": "S000823", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001125", "created_ts": "2024-07-15 13:40:01", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S001125", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001333", "created_ts": "2024-07-15 14:25:00", "analyst": "analyst_03", "archetype": "ticket_revenue_daily", "sql_id": "S001333", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000996", "created_ts": "2024-07-15 20:10:02", "analyst": "analyst_03", "archetype": "rfm_segmentation", "sql_id": "S000996", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000496", "created_ts": "2024-07-16 09:00:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000496", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000313", "created_ts": "2024-07-16 09:05:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000313", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000636", "created_ts": "2024-07-16 10:30:02", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000636", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001248", "created_ts": "2024-07-16 10:50:02", "analyst": "analyst_05", "archetype": "attendance_rate", "sql_id": "S001248", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000122", "created_ts": "2024-07-16 11:00:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000122", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001023", "created_ts": "2024-07-16 11:40:08", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S001023", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000123", "created_ts": "2024-07-17 08:00:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000123", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000637", "created_ts": "2024-07-17 08:20:00", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000637", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000497", "created_ts": "2024-07-17 10:50:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000497", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000314", "created_ts": "2024-07-17 11:10:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000314", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001124", "created_ts": "2024-07-17 11:30:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S001124", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000315", "created_ts": "2024-07-18 08:10:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000315", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000315"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000315", "expr": "temp materialization"}]}
{"query_id": "E000498", "created_ts": "2024-07-18 09:40:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000498", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000638", "created_ts": "2024-07-18 10:40:08", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000638", "expected_sources": ["raw_digital_events", "tmp_e000638"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000638", "expr": "temp materialization"}]}
{"query_id": "E000124", "created_ts": "2024-07-18 11:40:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000124", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001016", "created_ts": "2024-07-18 14:50:01", "analyst": "analyst_02", "archetype": "refund_spike", "sql_id": "S001016", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000499", "created_ts": "2024-07-19 08:00:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000499", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000125", "created_ts": "2024-07-19 09:00:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000125", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000316", "created_ts": "2024-07-19 10:40:08", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000316", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001490", "created_ts": "2024-07-19 11:55:34", "analyst": "analyst_11", "archetype": "deals_pipeline", "sql_id": "S001490", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001198", "created_ts": "2024-07-19 13:30:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S001198", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001197", "created_ts": "2024-07-19 13:45:13", "analyst": "analyst_10", "archetype": "support_sla", "sql_id": "S001197", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001435", "created_ts": "2024-07-21 11:00:05", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S001435", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000500", "created_ts": "2024-07-22 08:45:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000500", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000126", "created_ts": "2024-07-22 09:05:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000126", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000721", "created_ts": "2024-07-22 10:00:02", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000721", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000953", "created_ts": "2024-07-22 10:15:05", "analyst": "analyst_01", "archetype": "refund_spike", "sql_id": "S000953", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000954", "created_ts": "2024-07-22 10:23:05", "analyst": "analyst_01", "archetype": "refund_spike", "sql_id": "S000954", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000955", "created_ts": "2024-07-22 10:31:05", "analyst": "analyst_01", "archetype": "refund_spike", "sql_id": "S000955", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000317", "created_ts": "2024-07-22 10:40:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000317", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000956", "created_ts": "2024-07-22 10:51:05", "analyst": "analyst_01", "archetype": "refund_spike", "sql_id": "S000956", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000788", "created_ts": "2024-07-22 13:50:01", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000788", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000824", "created_ts": "2024-07-22 14:50:03", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000824", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001363", "created_ts": "2024-07-22 18:55:01", "analyst": "analyst_06", "archetype": "marketing_last_touch", "sql_id": "S001363", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000501", "created_ts": "2024-07-23 08:45:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000501", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000639", "created_ts": "2024-07-23 09:45:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000639", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000127", "created_ts": "2024-07-23 10:05:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000127", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000318", "created_ts": "2024-07-23 10:15:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000318", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001448", "created_ts": "2024-07-23 11:07:01", "analyst": "analyst_03", "archetype": "ticket_revenue_daily", "sql_id": "S001448", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001496", "created_ts": "2024-07-23 18:35:05", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S001496", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000640", "created_ts": "2024-07-24 09:50:05", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000640", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001041", "created_ts": "2024-07-24 12:30:08", "analyst": "analyst_12", "archetype": "marketing_last_touch", "sql_id": "S001041", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001030", "created_ts": "2024-07-24 16:25:08", "analyst": "analyst_02", "archetype": "attendance_rate", "sql_id": "S001030", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000641", "created_ts": "2024-07-25 09:20:34", "analyst": "analyst_08", "archetype": "campaign_funnel", "sql_id": "S000641", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001476", "created_ts": "2024-07-25 10:35:21", "analyst": "analyst_01", "archetype": "attach_rate", "sql_id": "S001476", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001482", "created_ts": "2024-07-25 13:45:21", "analyst": "analyst_04", "archetype": "marketing_last_touch", "sql_id": "S001482", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000642", "created_ts": "2024-07-26 09:15:02", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S000642", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000319", "created_ts": "2024-07-26 09:45:01", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000319", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000319"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000319", "expr": "temp materialization"}]}
{"query_id": "E001369", "created_ts": "2024-07-26 10:30:13", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S001369", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000128", "created_ts": "2024-07-26 11:50:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000128", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000128"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000128", "expr": "temp materialization"}]}
{"query_id": "E000995", "created_ts": "2024-07-26 13:55:05", "analyst": "analyst_02", "archetype": "support_sla", "sql_id": "S000995", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001148", "created_ts": "2024-07-26 16:00:05", "analyst": "analyst_04", "archetype": "deals_pipeline", "sql_id": "S001148", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001073", "created_ts": "2024-07-28 10:35:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S001073", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000129", "created_ts": "2024-07-29 10:10:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000129", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000643", "created_ts": "2024-07-29 10:50:13", "analyst": "analyst_02", "archetype": "campaign_funnel", "sql_id": "S000643", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000722", "created_ts": "2024-07-29 11:00:00", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000722", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001237", "created_ts": "2024-07-29 11:40:08", "analyst": "analyst_08", "archetype": "support_sla", "sql_id": "S001237", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000825", "created_ts": "2024-07-29 13:00:08", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000825", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001176", "created_ts": "2024-07-29 18:20:13", "analyst": "analyst_03", "archetype": "refund_spike", "sql_id": "S001176", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001334", "created_ts": "2024-07-29 18:45:55", "analyst": "analyst_03", "archetype": "rfm_segmentation", "sql_id": "S001334", "expected_sources": ["raw_ticket_sales", "raw_merch_orders", "tmp_e001334"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}, {"name": "tmp_e001334", "expr": "temp materialization"}]}
{"query_id": "E000644", "created_ts": "2024-07-30 09:00:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000644", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000130", "created_ts": "2024-07-30 10:50:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000130", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001285", "created_ts": "2024-07-30 16:55:01", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S001285", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001459", "created_ts": "2024-07-30 18:50:03", "analyst": "analyst_12", "archetype": "attach_rate", "sql_id": "S001459", "expected_sources": ["raw_ticket_sales", "raw_merch_orders", "tmp_e001459"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}, {"name": "tmp_e001459", "expr": "temp materialization"}]}
{"query_id": "E000320", "created_ts": "2024-07-31 11:15:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000320", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000320"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000320", "expr": "temp materialization"}]}
{"query_id": "E001132", "created_ts": "2024-07-31 14:07:34", "analyst": "analyst_10", "archetype": "refund_spike", "sql_id": "S001132", "expected_sources": ["raw_ticket_sales", "tmp_e001132"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}, {"name": "tmp_e001132", "expr": "temp materialization"}]}
{"query_id": "E001021", "created_ts": "2024-07-31 17:45:21", "analyst": "analyst_11", "archetype": "deals_pipeline", "sql_id": "S001021", "expected_sources": ["crm_deals", "tmp_e001021"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}, {"name": "tmp_e001021", "expr": "temp materialization"}]}
{"query_id": "E000502", "created_ts": "2024-08-01 08:20:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000502", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000847", "created_ts": "2024-08-01 10:00:01", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S000847", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000876", "created_ts": "2024-08-01 10:15:21", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000876", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000131", "created_ts": "2024-08-01 10:40:05", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000131", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000321", "created_ts": "2024-08-01 11:20:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000321", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000857", "created_ts": "2024-08-01 13:30:03", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S000857", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000866", "created_ts": "2024-08-01 15:00:01", "analyst": "analyst_11", "archetype": "support_sla", "sql_id": "S000866", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001337", "created_ts": "2024-08-01 16:50:01", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001337", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000322", "created_ts": "2024-08-02 08:15:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000322", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000132", "created_ts": "2024-08-02 11:30:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000132", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000132"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000132", "expr": "temp materialization"}]}
{"query_id": "E001171", "created_ts": "2024-08-02 17:20:00", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001171", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e001171"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e001171", "expr": "temp materialization"}]}
{"query_id": "E000133", "created_ts": "2024-08-05 09:10:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000133", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000323", "created_ts": "2024-08-05 09:40:01", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000323", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000503", "created_ts": "2024-08-05 10:10:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000503", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000645", "created_ts": "2024-08-05 10:30:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000645", "expected_sources": ["raw_digital_events", "tmp_e000645"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000645", "expr": "temp materialization"}]}
{"query_id": "E000789", "created_ts": "2024-08-05 11:10:03", "analyst": "analyst_02", "archetype": "support_sla", "sql_id": "S000789", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001328", "created_ts": "2024-08-05 11:35:02", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S001328", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000723", "created_ts": "2024-08-05 13:40:55", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000723", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001261", "created_ts": "2024-08-05 17:30:13", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S001261", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000134", "created_ts": "2024-08-06 08:05:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000134", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000646", "created_ts": "2024-08-06 08:30:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000646", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000324", "created_ts": "2024-08-06 09:05:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000324", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000504", "created_ts": "2024-08-06 11:50:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000504", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000505", "created_ts": "2024-08-07 08:05:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000505", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001277", "created_ts": "2024-08-07 09:15:21", "analyst": "analyst_04", "archetype": "rfm_segmentation", "sql_id": "S001277", "expected_sources": ["raw_ticket_sales", "raw_merch_orders", "tmp_e001277"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}, {"name": "tmp_e001277", "expr": "temp materialization"}]}
{"query_id": "E000325", "created_ts": "2024-08-07 11:40:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000325", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000325"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000325", "expr": "temp materialization"}]}
{"query_id": "E000647", "created_ts": "2024-08-08 09:30:13", "analyst": "analyst_05", "archetype": "campaign_funnel", "sql_id": "S000647", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000506", "created_ts": "2024-08-08 09:50:05", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000506", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e000506"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e000506", "expr": "temp materialization"}]}
{"query_id": "E001281", "created_ts": "2024-08-08 11:50:03", "analyst": "analyst_01", "archetype": "support_sla", "sql_id": "S001281", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000507", "created_ts": "2024-08-09 08:45:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000507", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000135", "created_ts": "2024-08-09 09:15:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000135", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000326", "created_ts": "2024-08-09 11:20:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000326", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001359", "created_ts": "2024-08-09 17:55:21", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S001359", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000327", "created_ts": "2024-08-12 09:50:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000327", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000136", "created_ts": "2024-08-12 10:10:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000136", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000508", "created_ts": "2024-08-12 11:00:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000508", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000724", "created_ts": "2024-08-12 11:20:21", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000724", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000754", "created_ts": "2024-08-12 11:30:55", "analyst": "analyst_10", "archetype": "attach_rate", "sql_id": "S000754", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000790", "created_ts": "2024-08-12 13:30:55", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000790", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001249", "created_ts": "2024-08-12 15:07:08", "analyst": "analyst_04", "archetype": "attach_rate", "sql_id": "S001249", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001305", "created_ts": "2024-08-12 18:20:03", "analyst": "analyst_08", "archetype": "refund_spike", "sql_id": "S001305", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000328", "created_ts": "2024-08-13 08:45:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000328", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000509", "created_ts": "2024-08-13 11:10:34", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000509", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000137", "created_ts": "2024-08-13 11:45:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000137", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000137"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000137", "expr": "temp materialization"}]}
{"query_id": "E001345", "created_ts": "2024-08-13 13:30:21", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S001345", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000138", "created_ts": "2024-08-14 10:20:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000138", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000510", "created_ts": "2024-08-14 11:20:03", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S000510", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000329", "created_ts": "2024-08-14 11:45:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000329", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001033", "created_ts": "2024-08-14 14:15:05", "analyst": "analyst_08", "archetype": "rfm_segmentation", "sql_id": "S001033", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000330", "created_ts": "2024-08-15 10:05:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000330", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000330"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000330", "expr": "temp materialization"}]}
{"query_id": "E000511", "created_ts": "2024-08-15 10:05:08", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000511", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e000511"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e000511", "expr": "temp materialization"}]}
{"query_id": "E001195", "created_ts": "2024-08-15 11:20:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S001195", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001385", "created_ts": "2024-08-15 13:35:02", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S001385", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000512", "created_ts": "2024-08-16 08:50:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000512", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000139", "created_ts": "2024-08-16 09:00:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000139", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001236", "created_ts": "2024-08-16 15:15:13", "analyst": "analyst_08", "archetype": "refund_spike", "sql_id": "S001236", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000331", "created_ts": "2024-08-18 08:40:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000331", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000513", "created_ts": "2024-08-18 08:45:05", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000513", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000648", "created_ts": "2024-08-18 09:45:01", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000648", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000649", "created_ts": "2024-08-19 08:40:05", "analyst": "analyst_12", "archetype": "campaign_funnel", "sql_id": "S000649", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000140", "created_ts": "2024-08-19 08:45:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000140", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000755", "created_ts": "2024-08-19 09:20:34", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000755", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000332", "created_ts": "2024-08-19 09:50:05", "analyst": "analyst_12", "archetype": "ticket_revenue_daily", "sql_id": "S000332", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001067", "created_ts": "2024-08-19 10:25:02", "analyst": "analyst_09", "archetype": "support_sla", "sql_id": "S001067", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001186", "created_ts": "2024-08-19 10:50:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S001186", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000725", "created_ts": "2024-08-19 11:20:05", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000725", "expected_sources": ["raw_ticket_sales", "tmp_e000725"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}, {"name": "tmp_e000725", "expr": "temp materialization"}]}
{"query_id": "E000791", "created_ts": "2024-08-19 11:40:34", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000791", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000514", "created_ts": "2024-08-19 11:50:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000514", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000826", "created_ts": "2024-08-19 13:20:03", "analyst": "analyst_05", "archetype": "marketing_last_touch", "sql_id": "S000826", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001240", "created_ts": "2024-08-19 18:03:05", "analyst": "analyst_06", "archetype": "support_sla", "sql_id": "S001240", "expected_sources": ["support_tickets", "tmp_e001240"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}, {"name": "tmp_e001240", "expr": "temp materialization"}]}
{"query_id": "E000333", "created_ts": "2024-08-20 08:05:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000333", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000515", "created_ts": "2024-08-20 10:20:34", "analyst": "analyst_02", "archetype": "attendance_rate", "sql_id": "S000515", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001352", "created_ts": "2024-08-20 13:07:05", "analyst": "analyst_03", "archetype": "ticket_revenue_daily", "sql_id": "S001352", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000141", "created_ts": "2024-08-21 08:50:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000141", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000516", "created_ts": "2024-08-21 09:50:03", "analyst": "analyst_09", "archetype": "attendance_rate", "sql_id": "S000516", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001223", "created_ts": "2024-08-21 14:30:21", "analyst": "analyst_12", "archetype": "deals_pipeline", "sql_id": "S001223", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000517", "created_ts": "2024-08-22 08:10:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000517", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000142", "created_ts": "2024-08-22 08:50:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000142", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000334", "created_ts": "2024-08-22 09:20:00", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000334", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000650", "created_ts": "2024-08-23 10:05:05", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000650", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000335", "created_ts": "2024-08-23 10:15:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000335", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000143", "created_ts": "2024-08-23 11:20:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000143", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000986", "created_ts": "2024-08-23 13:40:13", "analyst": "analyst_04", "archetype": "attendance_rate", "sql_id": "S000986", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001142", "created_ts": "2024-08-24 19:50:05", "analyst": "analyst_12", "archetype": "support_sla", "sql_id": "S001142", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000144", "created_ts": "2024-08-26 08:40:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000144", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000518", "created_ts": "2024-08-26 09:50:05", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000518", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001040", "created_ts": "2024-08-26 10:00:13", "analyst": "analyst_02", "archetype": "attach_rate", "sql_id": "S001040", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000792", "created_ts": "2024-08-26 10:10:13", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000792", "expected_sources": ["support_tickets", "tmp_e000792"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}, {"name": "tmp_e000792", "expr": "temp materialization"}]}
{"query_id": "E000827", "created_ts": "2024-08-26 10:20:08", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000827", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000756", "created_ts": "2024-08-26 11:40:08", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000756", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000519", "created_ts": "2024-08-27 08:15:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000519", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e000519"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e000519", "expr": "temp materialization"}]}
{"query_id": "E000651", "created_ts": "2024-08-27 09:40:03", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S000651", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000336", "created_ts": "2024-08-27 10:05:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000336", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000336"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000336", "expr": "temp materialization"}]}
{"query_id": "E000145", "created_ts": "2024-08-27 11:00:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000145", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000916", "created_ts": "2024-08-27 11:20:34", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S000916", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000917", "created_ts": "2024-08-27 11:40:34", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S000917", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000652", "created_ts": "2024-08-28 08:50:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000652", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000146", "created_ts": "2024-08-28 10:40:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000146", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001121", "created_ts": "2024-08-28 13:55:13", "analyst": "analyst_10", "archetype": "marketing_last_touch", "sql_id": "S001121", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001286", "created_ts": "2024-08-28 17:45:13", "analyst": "analyst_07", "archetype": "refund_spike", "sql_id": "S001286", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000653", "created_ts": "2024-08-29 08:40:08", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000653", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000337", "created_ts": "2024-08-29 10:05:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000337", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001372", "created_ts": "2024-08-29 11:03:08", "analyst": "analyst_11", "archetype": "campaign_funnel", "sql_id": "S001372", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000520", "created_ts": "2024-08-29 11:15:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000520", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000147", "created_ts": "2024-08-29 11:30:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000147", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001114", "created_ts": "2024-08-29 19:30:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S001114", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000148", "created_ts": "2024-08-30 09:20:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000148", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000338", "created_ts": "2024-08-30 11:20:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000338", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000902", "created_ts": "2024-08-30 14:15:03", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S000902", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000903", "created_ts": "2024-08-30 14:30:03", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S000903", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000905", "created_ts": "2024-08-30 14:51:03", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S000905", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000904", "created_ts": "2024-08-30 14:55:03", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S000904", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001117", "created_ts": "2024-09-01 11:20:13", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S001117", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000149", "created_ts": "2024-09-02 08:05:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000149", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000521", "created_ts": "2024-09-02 09:00:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000521", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000339", "created_ts": "2024-09-02 09:30:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000339", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000726", "created_ts": "2024-09-02 09:40:08", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000726", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000979", "created_ts": "2024-09-02 10:00:01", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S000979", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000867", "created_ts": "2024-09-02 10:00:21", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000867", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000654", "created_ts": "2024-09-02 10:00:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000654", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001153", "created_ts": "2024-09-02 10:25:02", "analyst": "analyst_02", "archetype": "attach_rate", "sql_id": "S001153", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000828", "created_ts": "2024-09-02 11:00:00", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000828", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000858", "created_ts": "2024-09-02 11:00:05", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S000858", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000877", "created_ts": "2024-09-02 11:45:01", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000877", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001445", "created_ts": "2024-09-02 13:20:03", "analyst": "analyst_07", "archetype": "attach_rate", "sql_id": "S001445", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001330", "created_ts": "2024-09-02 13:40:01", "analyst": "analyst_11", "archetype": "ticket_revenue_daily", "sql_id": "S001330", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000848", "created_ts": "2024-09-02 13:45:03", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S000848", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001321", "created_ts": "2024-09-02 14:40:02", "analyst": "analyst_04", "archetype": "marketing_last_touch", "sql_id": "S001321", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001325", "created_ts": "2024-09-02 15:10:13", "analyst": "analyst_09", "archetype": "marketing_last_touch", "sql_id": "S001325", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001222", "created_ts": "2024-09-02 19:10:55", "analyst": "analyst_04", "archetype": "ticket_revenue_daily", "sql_id": "S001222", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000150", "created_ts": "2024-09-03 08:45:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000150", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000340", "created_ts": "2024-09-03 08:50:00", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000340", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001091", "created_ts": "2024-09-03 09:30:05", "analyst": "analyst_12", "archetype": "rfm_segmentation", "sql_id": "S001091", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001374", "created_ts": "2024-09-03 09:50:00", "analyst": "analyst_04", "archetype": "deals_pipeline", "sql_id": "S001374", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001350", "created_ts": "2024-09-03 12:55:13", "analyst": "analyst_03", "archetype": "attach_rate", "sql_id": "S001350", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001371", "created_ts": "2024-09-03 13:40:08", "analyst": "analyst_02", "archetype": "attach_rate", "sql_id": "S001371", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000991", "created_ts": "2024-09-03 14:30:21", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S000991", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001126", "created_ts": "2024-09-03 14:50:08", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S001126", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001109", "created_ts": "2024-09-03 16:15:55", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S001109", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001283", "created_ts": "2024-09-03 19:30:13", "analyst": "analyst_01", "archetype": "deals_pipeline", "sql_id": "S001283", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000655", "created_ts": "2024-09-04 08:05:00", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000655", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000151", "created_ts": "2024-09-04 10:20:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000151", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000341", "created_ts": "2024-09-04 10:45:01", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000341", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001075", "created_ts": "2024-09-04 12:07:03", "analyst": "analyst_03", "archetype": "marketing_last_touch", "sql_id": "S001075", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001421", "created_ts": "2024-09-04 15:07:21", "analyst": "analyst_08", "archetype": "campaign_funnel", "sql_id": "S001421", "expected_sources": ["raw_digital_events", "tmp_e001421"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e001421", "expr": "temp materialization"}]}
{"query_id": "E000993", "created_ts": "2024-09-05 09:20:55", "analyst": "analyst_10", "archetype": "support_sla", "sql_id": "S000993", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000152", "created_ts": "2024-09-05 10:05:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000152", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000656", "created_ts": "2024-09-05 10:50:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000656", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001318", "created_ts": "2024-09-05 13:07:00", "analyst": "analyst_02", "archetype": "campaign_funnel", "sql_id": "S001318", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001135", "created_ts": "2024-09-05 19:07:00", "analyst": "analyst_06", "archetype": "support_sla", "sql_id": "S001135", "expected_sources": ["support_tickets", "tmp_e001135"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}, {"name": "tmp_e001135", "expr": "temp materialization"}]}
{"query_id": "E000657", "created_ts": "2024-09-06 10:10:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000657", "expected_sources": ["raw_digital_events", "tmp_e000657"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000657", "expr": "temp materialization"}]}
{"query_id": "E000153", "created_ts": "2024-09-06 10:30:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000153", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001474", "created_ts": "2024-09-06 11:10:05", "analyst": "analyst_12", "archetype": "attach_rate", "sql_id": "S001474", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000342", "created_ts": "2024-09-06 11:20:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000342", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001022", "created_ts": "2024-09-06 18:35:05", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S001022", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000343", "created_ts": "2024-09-09 08:40:01", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000343", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000522", "created_ts": "2024-09-09 09:05:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000522", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001444", "created_ts": "2024-09-09 09:30:00", "analyst": "analyst_09", "archetype": "support_sla", "sql_id": "S001444", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000154", "created_ts": "2024-09-09 10:10:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000154", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001408", "created_ts": "2024-09-09 10:25:34", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S001408", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000829", "created_ts": "2024-09-09 11:10:01", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000829", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000757", "created_ts": "2024-09-09 14:30:03", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000757", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001376", "created_ts": "2024-09-09 18:07:05", "analyst": "analyst_03", "archetype": "ticket_revenue_daily", "sql_id": "S001376", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001409", "created_ts": "2024-09-09 18:50:55", "analyst": "analyst_11", "archetype": "campaign_funnel", "sql_id": "S001409", "expected_sources": ["raw_digital_events", "tmp_e001409"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e001409", "expr": "temp materialization"}]}
{"query_id": "E000155", "created_ts": "2024-09-10 08:05:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000155", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000523", "created_ts": "2024-09-10 08:40:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000523", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000658", "created_ts": "2024-09-10 10:05:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000658", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001047", "created_ts": "2024-09-10 13:25:13", "analyst": "analyst_01", "archetype": "support_sla", "sql_id": "S001047", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001159", "created_ts": "2024-09-10 15:03:21", "analyst": "analyst_02", "archetype": "support_sla", "sql_id": "S001159", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000659", "created_ts": "2024-09-11 09:20:08", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000659", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000524", "created_ts": "2024-09-11 10:00:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000524", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001400", "created_ts": "2024-09-11 15:00:21", "analyst": "analyst_10", "archetype": "marketing_last_touch", "sql_id": "S001400", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001145", "created_ts": "2024-09-11 15:03:01", "analyst": "analyst_03", "archetype": "ticket_revenue_daily", "sql_id": "S001145", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001394", "created_ts": "2024-09-11 18:15:02", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001394", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000525", "created_ts": "2024-09-12 09:45:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000525", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000344", "created_ts": "2024-09-12 10:40:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000344", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001413", "created_ts": "2024-09-13 09:15:08", "analyst": "analyst_06", "archetype": "rfm_segmentation", "sql_id": "S001413", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001015", "created_ts": "2024-09-14 15:00:55", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S001015", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000830", "created_ts": "2024-09-16 09:00:34", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000830", "expected_sources": ["raw_ticket_sales", "marketing_touches", "tmp_e000830"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}, {"name": "tmp_e000830", "expr": "temp materialization"}]}
{"query_id": "E000345", "created_ts": "2024-09-16 09:40:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000345", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000526", "created_ts": "2024-09-16 10:05:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000526", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000758", "created_ts": "2024-09-16 10:10:02", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000758", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000881", "created_ts": "2024-09-16 10:40:05", "analyst": "analyst_04", "archetype": "refund_spike", "sql_id": "S000881", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000660", "created_ts": "2024-09-16 10:40:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000660", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000882", "created_ts": "2024-09-16 10:52:05", "analyst": "analyst_04", "archetype": "refund_spike", "sql_id": "S000882", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000884", "created_ts": "2024-09-16 11:04:05", "analyst": "analyst_04", "archetype": "refund_spike", "sql_id": "S000884", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000883", "created_ts": "2024-09-16 11:40:05", "analyst": "analyst_04", "archetype": "refund_spike", "sql_id": "S000883", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001295", "created_ts": "2024-09-16 14:30:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S001295", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001481", "created_ts": "2024-09-16 15:45:55", "analyst": "analyst_04", "archetype": "refund_spike", "sql_id": "S001481", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001160", "created_ts": "2024-09-16 18:20:00", "analyst": "analyst_05", "archetype": "attendance_rate", "sql_id": "S001160", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000346", "created_ts": "2024-09-17 08:00:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000346", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001180", "created_ts": "2024-09-17 09:00:55", "analyst": "analyst_11", "archetype": "deals_pipeline", "sql_id": "S001180", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000156", "created_ts": "2024-09-17 09:10:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000156", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001418", "created_ts": "2024-09-17 09:30:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S001418", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000527", "created_ts": "2024-09-17 11:45:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000527", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001280", "created_ts": "2024-09-17 14:35:08", "analyst": "analyst_03", "archetype": "ticket_revenue_daily", "sql_id": "S001280", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001457", "created_ts": "2024-09-17 14:50:08", "analyst": "analyst_02", "archetype": "support_sla", "sql_id": "S001457", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001402", "created_ts": "2024-09-17 15:15:34", "analyst": "analyst_09", "archetype": "deals_pipeline", "sql_id": "S001402", "expected_sources": ["crm_deals", "tmp_e001402"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}, {"name": "tmp_e001402", "expr": "temp materialization"}]}
{"query_id": "E000528", "created_ts": "2024-09-18 10:05:08", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000528", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000157", "created_ts": "2024-09-18 10:10:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000157", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000157"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000157", "expr": "temp materialization"}]}
{"query_id": "E001410", "created_ts": "2024-09-18 10:30:01", "analyst": "analyst_03", "archetype": "attach_rate", "sql_id": "S001410", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000347", "created_ts": "2024-09-19 09:10:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000347", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000529", "created_ts": "2024-09-19 09:50:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000529", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000158", "created_ts": "2024-09-19 09:50:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000158", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000900", "created_ts": "2024-09-19 16:45:01", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S000900", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000900"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000900", "expr": "temp materialization"}]}
{"query_id": "E000901", "created_ts": "2024-09-19 16:53:01", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S000901", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001228", "created_ts": "2024-09-19 19:50:13", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S001228", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000661", "created_ts": "2024-09-20 08:10:05", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000661", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000348", "created_ts": "2024-09-20 08:20:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000348", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000159", "created_ts": "2024-09-20 08:40:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000159", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001146", "created_ts": "2024-09-20 15:07:21", "analyst": "analyst_03", "archetype": "attach_rate", "sql_id": "S001146", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001207", "created_ts": "2024-09-20 16:10:13", "analyst": "analyst_07", "archetype": "campaign_funnel", "sql_id": "S001207", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001495", "created_ts": "2024-09-21 13:03:34", "analyst": "analyst_09", "archetype": "marketing_last_touch", "sql_id": "S001495", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001007", "created_ts": "2024-09-21 15:40:13", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S001007", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000349", "created_ts": "2024-09-22 10:45:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000349", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001440", "created_ts": "2024-09-22 15:10:21", "analyst": "analyst_11", "archetype": "campaign_funnel", "sql_id": "S001440", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000350", "created_ts": "2024-09-23 09:10:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000350", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001127", "created_ts": "2024-09-23 10:15:00", "analyst": "analyst_01", "archetype": "attendance_rate", "sql_id": "S001127", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000530", "created_ts": "2024-09-23 10:45:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000530", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000160", "created_ts": "2024-09-23 11:30:55", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S000160", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001156", "created_ts": "2024-09-23 11:35:03", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S001156", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000793", "created_ts": "2024-09-23 11:40:01", "analyst": "analyst_04", "archetype": "support_sla", "sql_id": "S000793", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000727", "created_ts": "2024-09-23 14:00:05", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000727", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000831", "created_ts": "2024-09-23 14:30:08", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000831", "expected_sources": ["raw_ticket_sales", "marketing_touches", "tmp_e000831"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}, {"name": "tmp_e000831", "expr": "temp materialization"}]}
{"query_id": "E000910", "created_ts": "2024-09-23 16:03:00", "analyst": "analyst_11", "archetype": "refund_spike", "sql_id": "S000910", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000911", "created_ts": "2024-09-23 16:15:00", "analyst": "analyst_11", "archetype": "refund_spike", "sql_id": "S000911", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000912", "created_ts": "2024-09-23 16:27:00", "analyst": "analyst_11", "archetype": "refund_spike", "sql_id": "S000912", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000913", "created_ts": "2024-09-23 16:48:00", "analyst": "analyst_11", "archetype": "refund_spike", "sql_id": "S000913", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001205", "created_ts": "2024-09-23 16:55:03", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S001205", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001012", "created_ts": "2024-09-23 18:45:13", "analyst": "analyst_05", "archetype": "attendance_rate", "sql_id": "S001012", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001455", "created_ts": "2024-09-23 19:45:55", "analyst": "analyst_10", "archetype": "attendance_rate", "sql_id": "S001455", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000662", "created_ts": "2024-09-24 09:50:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000662", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001383", "created_ts": "2024-09-24 09:55:00", "analyst": "analyst_11", "archetype": "campaign_funnel", "sql_id": "S001383", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000351", "created_ts": "2024-09-24 10:00:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000351", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000161", "created_ts": "2024-09-24 11:50:05", "analyst": "analyst_11", "archetype": "ticket_revenue_daily", "sql_id": "S000161", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001106", "created_ts": "2024-09-24 13:00:08", "analyst": "analyst_11", "archetype": "attach_rate", "sql_id": "S001106", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001089", "created_ts": "2024-09-24 14:25:08", "analyst": "analyst_04", "archetype": "attach_rate", "sql_id": "S001089", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001138", "created_ts": "2024-09-24 18:00:01", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S001138", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000162", "created_ts": "2024-09-25 08:50:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000162", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000663", "created_ts": "2024-09-25 10:15:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000663", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000531", "created_ts": "2024-09-25 11:15:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000531", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001386", "created_ts": "2024-09-25 17:00:55", "analyst": "analyst_04", "archetype": "rfm_segmentation", "sql_id": "S001386", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000163", "created_ts": "2024-09-26 09:00:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000163", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000352", "created_ts": "2024-09-26 10:50:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000352", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000664", "created_ts": "2024-09-26 11:30:02", "analyst": "analyst_08", "archetype": "campaign_funnel", "sql_id": "S000664", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001187", "created_ts": "2024-09-26 13:35:02", "analyst": "analyst_07", "archetype": "attach_rate", "sql_id": "S001187", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001029", "created_ts": "2024-09-26 17:07:13", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S001029", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000931", "created_ts": "2024-09-26 18:50:34", "analyst": "analyst_02", "archetype": "campaign_funnel", "sql_id": "S000931", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000933", "created_ts": "2024-09-26 19:30:34", "analyst": "analyst_02", "archetype": "campaign_funnel", "sql_id": "S000933", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000932", "created_ts": "2024-09-26 19:35:34", "analyst": "analyst_02", "archetype": "campaign_funnel", "sql_id": "S000932", "expected_sources": ["raw_digital_events", "tmp_e000932"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000932", "expr": "temp materialization"}]}
{"query_id": "E001210", "created_ts": "2024-09-27 09:10:05", "analyst": "analyst_08", "archetype": "campaign_funnel", "sql_id": "S001210", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000532", "created_ts": "2024-09-27 11:15:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000532", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000353", "created_ts": "2024-09-27 11:20:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000353", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001338", "created_ts": "2024-09-27 11:45:34", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S001338", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000957", "created_ts": "2024-09-27 19:30:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000957", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000958", "created_ts": "2024-09-27 20:00:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000958", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000958"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000958", "expr": "temp materialization"}]}
{"query_id": "E000959", "created_ts": "2024-09-27 21:30:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000959", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001346", "created_ts": "2024-09-28 13:45:34", "analyst": "analyst_12", "archetype": "rfm_segmentation", "sql_id": "S001346", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001010", "created_ts": "2024-09-29 17:00:34", "analyst": "analyst_10", "archetype": "support_sla", "sql_id": "S001010", "expected_sources": ["support_tickets", "tmp_e001010"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}, {"name": "tmp_e001010", "expr": "temp materialization"}]}
{"query_id": "E000354", "created_ts": "2024-09-30 09:45:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000354", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000794", "created_ts": "2024-09-30 10:00:00", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000794", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001255", "created_ts": "2024-09-30 10:35:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S001255", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000759", "created_ts": "2024-09-30 11:20:13", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000759", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000665", "created_ts": "2024-09-30 11:20:21", "analyst": "analyst_01", "archetype": "campaign_funnel", "sql_id": "S000665", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000832", "created_ts": "2024-09-30 13:50:01", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000832", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001453", "created_ts": "2024-09-30 17:30:34", "analyst": "analyst_04", "archetype": "marketing_last_touch", "sql_id": "S001453", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001468", "created_ts": "2024-09-30 18:45:03", "analyst": "analyst_02", "archetype": "attendance_rate", "sql_id": "S001468", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000533", "created_ts": "2024-10-01 09:15:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000533", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000355", "created_ts": "2024-10-01 10:00:03", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S000355", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000355"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000355", "expr": "temp materialization"}]}
{"query_id": "E000849", "created_ts": "2024-10-01 10:15:03", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S000849", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000164", "created_ts": "2024-10-01 11:15:34", "analyst": "analyst_04", "archetype": "ticket_revenue_daily", "sql_id": "S000164", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000859", "created_ts": "2024-10-01 11:30:21", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S000859", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000878", "created_ts": "2024-10-01 12:00:00", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000878", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000868", "created_ts": "2024-10-01 12:15:21", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000868", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000534", "created_ts": "2024-10-02 09:00:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000534", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000165", "created_ts": "2024-10-02 10:45:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000165", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000914", "created_ts": "2024-10-02 16:10:02", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000914", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000914"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000914", "expr": "temp materialization"}]}
{"query_id": "E000915", "created_ts": "2024-10-02 16:22:02", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000915", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001140", "created_ts": "2024-10-02 18:40:55", "analyst": "analyst_08", "archetype": "deals_pipeline", "sql_id": "S001140", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000535", "created_ts": "2024-10-03 09:05:08", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000535", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000166", "created_ts": "2024-10-03 09:30:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000166", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000666", "created_ts": "2024-10-03 10:00:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000666", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000356", "created_ts": "2024-10-03 11:50:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000356", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001320", "created_ts": "2024-10-03 16:10:03", "analyst": "analyst_02", "archetype": "attach_rate", "sql_id": "S001320", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001326", "created_ts": "2024-10-03 19:00:34", "analyst": "analyst_06", "archetype": "marketing_last_touch", "sql_id": "S001326", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000667", "created_ts": "2024-10-04 08:00:01", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000667", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000536", "created_ts": "2024-10-04 09:10:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000536", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000167", "created_ts": "2024-10-04 11:00:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000167", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001104", "created_ts": "2024-10-04 13:15:00", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S001104", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001224", "created_ts": "2024-10-04 14:35:00", "analyst": "analyst_02", "archetype": "attendance_rate", "sql_id": "S001224", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000168", "created_ts": "2024-10-05 10:50:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000168", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001329", "created_ts": "2024-10-05 17:35:08", "analyst": "analyst_12", "archetype": "refund_spike", "sql_id": "S001329", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001216", "created_ts": "2024-10-07 09:03:55", "analyst": "analyst_12", "archetype": "deals_pipeline", "sql_id": "S001216", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000537", "created_ts": "2024-10-07 10:30:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000537", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000760", "created_ts": "2024-10-07 10:40:02", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000760", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000795", "created_ts": "2024-10-07 13:50:55", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000795", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001115", "created_ts": "2024-10-07 14:07:13", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S001115", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001284", "created_ts": "2024-10-07 15:20:03", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S001284", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001471", "created_ts": "2024-10-07 15:50:13", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S001471", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001411", "created_ts": "2024-10-07 16:07:55", "analyst": "analyst_04", "archetype": "deals_pipeline", "sql_id": "S001411", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001054", "created_ts": "2024-10-07 18:10:02", "analyst": "analyst_09", "archetype": "marketing_last_touch", "sql_id": "S001054", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000889", "created_ts": "2024-10-07 19:35:00", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S000889", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000890", "created_ts": "2024-10-07 20:05:00", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S000890", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000891", "created_ts": "2024-10-07 20:15:00", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S000891", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000892", "created_ts": "2024-10-07 21:50:00", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S000892", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000668", "created_ts": "2024-10-08 09:40:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000668", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000169", "created_ts": "2024-10-08 10:10:08", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S000169", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000357", "created_ts": "2024-10-08 11:30:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000357", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000975", "created_ts": "2024-10-08 18:50:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000975", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000358", "created_ts": "2024-10-09 08:50:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000358", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000669", "created_ts": "2024-10-09 09:00:01", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000669", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000538", "created_ts": "2024-10-09 09:10:08", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000538", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000170", "created_ts": "2024-10-09 11:15:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000170", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000170"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000170", "expr": "temp materialization"}]}
{"query_id": "E000920", "created_ts": "2024-10-09 18:20:01", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000920", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000921", "created_ts": "2024-10-09 18:35:01", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000921", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000670", "created_ts": "2024-10-10 08:40:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000670", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000539", "created_ts": "2024-10-10 09:30:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000539", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000171", "created_ts": "2024-10-10 10:30:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000171", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001206", "created_ts": "2024-10-10 14:03:34", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S001206", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001107", "created_ts": "2024-10-10 17:55:21", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S001107", "expected_sources": ["raw_ticket_sales", "tmp_e001107"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}, {"name": "tmp_e001107", "expr": "temp materialization"}]}
{"query_id": "E000540", "created_ts": "2024-10-11 10:40:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000540", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001282", "created_ts": "2024-10-11 10:50:34", "analyst": "analyst_05", "archetype": "rfm_segmentation", "sql_id": "S001282", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000359", "created_ts": "2024-10-11 11:30:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000359", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001432", "created_ts": "2024-10-11 16:15:01", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S001432", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001403", "created_ts": "2024-10-12 17:03:13", "analyst": "analyst_05", "archetype": "deals_pipeline", "sql_id": "S001403", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000541", "created_ts": "2024-10-13 09:45:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000541", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e000541"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e000541", "expr": "temp materialization"}]}
{"query_id": "E000988", "created_ts": "2024-10-13 10:40:01", "analyst": "analyst_08", "archetype": "attendance_rate", "sql_id": "S000988", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000360", "created_ts": "2024-10-13 10:50:55", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S000360", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000172", "created_ts": "2024-10-14 09:45:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000172", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001157", "created_ts": "2024-10-14 09:45:21", "analyst": "analyst_04", "archetype": "support_sla", "sql_id": "S001157", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000361", "created_ts": "2024-10-14 10:40:00", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000361", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000796", "created_ts": "2024-10-14 11:20:13", "analyst": "analyst_02", "archetype": "support_sla", "sql_id": "S000796", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000833", "created_ts": "2024-10-14 11:40:13", "analyst": "analyst_01", "archetype": "marketing_last_touch", "sql_id": "S000833", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000761", "created_ts": "2024-10-14 13:10:55", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000761", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001149", "created_ts": "2024-10-14 13:25:02", "analyst": "analyst_01", "archetype": "deals_pipeline", "sql_id": "S001149", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001336", "created_ts": "2024-10-14 14:15:34", "analyst": "analyst_07", "archetype": "deals_pipeline", "sql_id": "S001336", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001028", "created_ts": "2024-10-14 15:30:03", "analyst": "analyst_05", "archetype": "campaign_funnel", "sql_id": "S001028", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001070", "created_ts": "2024-10-15 11:15:02", "analyst": "analyst_09", "archetype": "refund_spike", "sql_id": "S001070", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000173", "created_ts": "2024-10-15 11:20:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000173", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001500", "created_ts": "2024-10-15 12:30:13", "analyst": "analyst_12", "archetype": "attach_rate", "sql_id": "S001500", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000998", "created_ts": "2024-10-15 13:10:05", "analyst": "analyst_08", "archetype": "rfm_segmentation", "sql_id": "S000998", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001429", "created_ts": "2024-10-15 15:45:05", "analyst": "analyst_03", "archetype": "marketing_last_touch", "sql_id": "S001429", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000174", "created_ts": "2024-10-16 08:15:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000174", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000362", "created_ts": "2024-10-16 11:15:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000362", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001018", "created_ts": "2024-10-16 14:10:55", "analyst": "analyst_01", "archetype": "refund_spike", "sql_id": "S001018", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000671", "created_ts": "2024-10-17 10:05:21", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S000671", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000363", "created_ts": "2024-10-17 10:45:00", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000363", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000175", "created_ts": "2024-10-17 11:10:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000175", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001052", "created_ts": "2024-10-17 12:50:02", "analyst": "analyst_06", "archetype": "support_sla", "sql_id": "S001052", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001265", "created_ts": "2024-10-17 14:35:02", "analyst": "analyst_09", "archetype": "attendance_rate", "sql_id": "S001265", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001417", "created_ts": "2024-10-17 17:07:13", "analyst": "analyst_07", "archetype": "attach_rate", "sql_id": "S001417", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000672", "created_ts": "2024-10-18 08:05:08", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000672", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000364", "created_ts": "2024-10-18 08:10:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000364", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000542", "created_ts": "2024-10-18 09:10:02", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000542", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000176", "created_ts": "2024-10-18 10:45:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000176", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001192", "created_ts": "2024-10-19 09:40:02", "analyst": "analyst_11", "archetype": "campaign_funnel", "sql_id": "S001192", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000673", "created_ts": "2024-10-19 10:30:08", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000673", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000987", "created_ts": "2024-10-19 12:55:01", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S000987", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000177", "created_ts": "2024-10-20 08:50:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000177", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000365", "created_ts": "2024-10-21 08:50:03", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S000365", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000728", "created_ts": "2024-10-21 09:10:21", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000728", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000543", "created_ts": "2024-10-21 09:20:34", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000543", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001241", "created_ts": "2024-10-21 10:07:05", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S001241", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001296", "created_ts": "2024-10-21 10:10:02", "analyst": "analyst_07", "archetype": "deals_pipeline", "sql_id": "S001296", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000674", "created_ts": "2024-10-21 10:20:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000674", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000797", "created_ts": "2024-10-21 10:40:01", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000797", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000762", "created_ts": "2024-10-21 11:00:03", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000762", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000834", "created_ts": "2024-10-21 11:00:05", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000834", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000178", "created_ts": "2024-10-21 11:10:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000178", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001462", "created_ts": "2024-10-21 12:55:34", "analyst": "analyst_01", "archetype": "campaign_funnel", "sql_id": "S001462", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001276", "created_ts": "2024-10-21 13:03:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S001276", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001343", "created_ts": "2024-10-21 14:45:05", "analyst": "analyst_08", "archetype": "attendance_rate", "sql_id": "S001343", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001143", "created_ts": "2024-10-21 14:55:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S001143", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001311", "created_ts": "2024-10-21 16:20:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S001311", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001100", "created_ts": "2024-10-21 17:20:02", "analyst": "analyst_10", "archetype": "campaign_funnel", "sql_id": "S001100", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000179", "created_ts": "2024-10-22 08:50:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000179", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000675", "created_ts": "2024-10-22 09:15:00", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000675", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001425", "created_ts": "2024-10-22 10:45:55", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S001425", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001294", "created_ts": "2024-10-22 14:15:21", "analyst": "analyst_06", "archetype": "support_sla", "sql_id": "S001294", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000180", "created_ts": "2024-10-23 08:45:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000180", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000676", "created_ts": "2024-10-23 09:00:13", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000676", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000366", "created_ts": "2024-10-23 09:40:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000366", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001310", "created_ts": "2024-10-24 09:30:05", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S001310", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000544", "created_ts": "2024-10-24 10:20:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000544", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000181", "created_ts": "2024-10-24 10:45:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000181", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001398", "created_ts": "2024-10-24 12:25:08", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S001398", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001101", "created_ts": "2024-10-24 13:25:13", "analyst": "analyst_12", "archetype": "deals_pipeline", "sql_id": "S001101", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000182", "created_ts": "2024-10-25 08:00:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000182", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000182"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000182", "expr": "temp materialization"}]}
{"query_id": "E000545", "created_ts": "2024-10-25 10:30:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000545", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001230", "created_ts": "2024-10-26 18:03:00", "analyst": "analyst_05", "archetype": "rfm_segmentation", "sql_id": "S001230", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001136", "created_ts": "2024-10-26 20:45:01", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001136", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000367", "created_ts": "2024-10-28 08:45:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000367", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000367"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000367", "expr": "temp materialization"}]}
{"query_id": "E000980", "created_ts": "2024-10-28 09:07:21", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S000980", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000798", "created_ts": "2024-10-28 10:10:02", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000798", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000835", "created_ts": "2024-10-28 10:10:08", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000835", "expected_sources": ["raw_ticket_sales", "marketing_touches", "tmp_e000835"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}, {"name": "tmp_e000835", "expr": "temp materialization"}]}
{"query_id": "E000763", "created_ts": "2024-10-28 10:40:03", "analyst": "analyst_07", "archetype": "attach_rate", "sql_id": "S000763", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000183", "created_ts": "2024-10-28 11:00:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000183", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001167", "created_ts": "2024-10-28 11:40:03", "analyst": "analyst_08", "archetype": "attendance_rate", "sql_id": "S001167", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000729", "created_ts": "2024-10-28 14:40:34", "analyst": "analyst_04", "archetype": "refund_spike", "sql_id": "S000729", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000944", "created_ts": "2024-10-28 16:30:08", "analyst": "analyst_08", "archetype": "refund_spike", "sql_id": "S000944", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000945", "created_ts": "2024-10-28 16:45:08", "analyst": "analyst_08", "archetype": "refund_spike", "sql_id": "S000945", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000946", "created_ts": "2024-10-28 16:54:08", "analyst": "analyst_08", "archetype": "refund_spike", "sql_id": "S000946", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000368", "created_ts": "2024-10-29 09:20:08", "analyst": "analyst_03", "archetype": "ticket_revenue_daily", "sql_id": "S000368", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000677", "created_ts": "2024-10-29 09:45:00", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S000677", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000546", "created_ts": "2024-10-29 10:15:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000546", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001395", "created_ts": "2024-10-29 11:25:03", "analyst": "analyst_05", "archetype": "campaign_funnel", "sql_id": "S001395", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000184", "created_ts": "2024-10-29 11:45:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000184", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000369", "created_ts": "2024-10-30 09:05:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000369", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000547", "created_ts": "2024-10-30 11:00:02", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000547", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000678", "created_ts": "2024-10-30 11:15:13", "analyst": "analyst_02", "archetype": "campaign_funnel", "sql_id": "S000678", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000370", "created_ts": "2024-10-31 08:20:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000370", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000185", "created_ts": "2024-10-31 08:40:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000185", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000679", "created_ts": "2024-10-31 10:30:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000679", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000997", "created_ts": "2024-10-31 10:55:34", "analyst": "analyst_08", "archetype": "attach_rate", "sql_id": "S000997", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001379", "created_ts": "2024-10-31 12:45:00", "analyst": "analyst_01", "archetype": "attach_rate", "sql_id": "S001379", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001208", "created_ts": "2024-10-31 15:50:13", "analyst": "analyst_05", "archetype": "support_sla", "sql_id": "S001208", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000371", "created_ts": "2024-11-01 10:40:01", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000371", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000186", "created_ts": "2024-11-01 11:30:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000186", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000869", "created_ts": "2024-11-01 11:30:21", "analyst": "analyst_09", "archetype": "support_sla", "sql_id": "S000869", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000680", "created_ts": "2024-11-01 11:40:03", "analyst": "analyst_01", "archetype": "campaign_funnel", "sql_id": "S000680", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000978", "created_ts": "2024-11-01 12:15:08", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S000978", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000879", "created_ts": "2024-11-01 12:45:03", "analyst": "analyst_01", "archetype": "attach_rate", "sql_id": "S000879", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001430", "created_ts": "2024-11-01 17:45:05", "analyst": "analyst_10", "archetype": "rfm_segmentation", "sql_id": "S001430", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000681", "created_ts": "2024-11-02 09:30:13", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000681", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000372", "created_ts": "2024-11-02 09:40:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000372", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000372"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000372", "expr": "temp materialization"}]}
{"query_id": "E001314", "created_ts": "2024-11-02 19:45:05", "analyst": "analyst_07", "archetype": "campaign_funnel", "sql_id": "S001314", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000682", "created_ts": "2024-11-04 08:15:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000682", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001166", "created_ts": "2024-11-04 10:03:21", "analyst": "analyst_03", "archetype": "attach_rate", "sql_id": "S001166", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000187", "created_ts": "2024-11-04 10:20:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000187", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000836", "created_ts": "2024-11-04 10:30:05", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000836", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001494", "created_ts": "2024-11-04 11:10:00", "analyst": "analyst_08", "archetype": "refund_spike", "sql_id": "S001494", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000799", "created_ts": "2024-11-04 11:30:01", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000799", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000373", "created_ts": "2024-11-04 11:40:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000373", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001264", "created_ts": "2024-11-04 13:07:02", "analyst": "analyst_11", "archetype": "refund_spike", "sql_id": "S001264", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000764", "created_ts": "2024-11-04 14:30:13", "analyst": "analyst_07", "archetype": "attach_rate", "sql_id": "S000764", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001163", "created_ts": "2024-11-04 20:20:01", "analyst": "analyst_08", "archetype": "campaign_funnel", "sql_id": "S001163", "expected_sources": ["raw_digital_events", "tmp_e001163"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e001163", "expr": "temp materialization"}]}
{"query_id": "E000188", "created_ts": "2024-11-05 10:05:34", "analyst": "analyst_04", "archetype": "ticket_revenue_daily", "sql_id": "S000188", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000548", "created_ts": "2024-11-05 10:15:02", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000548", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000374", "created_ts": "2024-11-05 11:50:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000374", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000683", "created_ts": "2024-11-05 11:50:05", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000683", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001360", "created_ts": "2024-11-05 12:55:00", "analyst": "analyst_05", "archetype": "attach_rate", "sql_id": "S001360", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001050", "created_ts": "2024-11-05 13:25:55", "analyst": "analyst_01", "archetype": "deals_pipeline", "sql_id": "S001050", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001446", "created_ts": "2024-11-05 17:25:21", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S001446", "expected_sources": ["raw_digital_events", "tmp_e001446"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e001446", "expr": "temp materialization"}]}
{"query_id": "E000189", "created_ts": "2024-11-06 08:10:03", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S000189", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001226", "created_ts": "2024-11-06 09:20:08", "analyst": "analyst_10", "archetype": "attach_rate", "sql_id": "S001226", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000375", "created_ts": "2024-11-06 11:15:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000375", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000549", "created_ts": "2024-11-06 11:45:05", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000549", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000684", "created_ts": "2024-11-07 08:45:00", "analyst": "analyst_08", "archetype": "campaign_funnel", "sql_id": "S000684", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000376", "created_ts": "2024-11-07 10:05:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000376", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000550", "created_ts": "2024-11-07 11:40:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000550", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000960", "created_ts": "2024-11-07 15:10:00", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S000960", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000961", "created_ts": "2024-11-07 15:25:00", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S000961", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000190", "created_ts": "2024-11-08 08:50:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000190", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000551", "created_ts": "2024-11-08 10:10:05", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000551", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000685", "created_ts": "2024-11-08 10:50:00", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000685", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001312", "created_ts": "2024-11-08 18:35:02", "analyst": "analyst_02", "archetype": "campaign_funnel", "sql_id": "S001312", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000191", "created_ts": "2024-11-10 08:20:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000191", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000191"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000191", "expr": "temp materialization"}]}
{"query_id": "E001358", "created_ts": "2024-11-10 18:15:21", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S001358", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000192", "created_ts": "2024-11-11 08:40:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000192", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000765", "created_ts": "2024-11-11 09:50:55", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000765", "expected_sources": ["raw_ticket_sales", "raw_merch_orders", "tmp_e000765"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}, {"name": "tmp_e000765", "expr": "temp materialization"}]}
{"query_id": "E001347", "created_ts": "2024-11-11 13:40:03", "analyst": "analyst_03", "archetype": "marketing_last_touch", "sql_id": "S001347", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000730", "created_ts": "2024-11-11 14:40:55", "analyst": "analyst_04", "archetype": "refund_spike", "sql_id": "S000730", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000985", "created_ts": "2024-11-11 15:35:34", "analyst": "analyst_07", "archetype": "attendance_rate", "sql_id": "S000985", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000552", "created_ts": "2024-11-12 09:10:02", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000552", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000950", "created_ts": "2024-11-12 10:55:05", "analyst": "analyst_07", "archetype": "campaign_funnel", "sql_id": "S000950", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000952", "created_ts": "2024-11-12 11:19:05", "analyst": "analyst_07", "archetype": "campaign_funnel", "sql_id": "S000952", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001414", "created_ts": "2024-11-12 11:25:03", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S001414", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000951", "created_ts": "2024-11-12 11:40:05", "analyst": "analyst_07", "archetype": "campaign_funnel", "sql_id": "S000951", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001199", "created_ts": "2024-11-12 18:45:13", "analyst": "analyst_02", "archetype": "deals_pipeline", "sql_id": "S001199", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001426", "created_ts": "2024-11-12 19:35:55", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S001426", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000193", "created_ts": "2024-11-13 08:10:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000193", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000553", "created_ts": "2024-11-13 08:15:34", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000553", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000377", "created_ts": "2024-11-13 08:20:08", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000377", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001443", "created_ts": "2024-11-14 10:45:21", "analyst": "analyst_08", "archetype": "refund_spike", "sql_id": "S001443", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000378", "created_ts": "2024-11-14 11:10:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000378", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000554", "created_ts": "2024-11-14 11:15:08", "analyst": "analyst_05", "archetype": "attendance_rate", "sql_id": "S000554", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001141", "created_ts": "2024-11-14 11:45:02", "analyst": "analyst_03", "archetype": "ticket_revenue_daily", "sql_id": "S001141", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000686", "created_ts": "2024-11-14 11:45:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000686", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001493", "created_ts": "2024-11-14 14:15:34", "analyst": "analyst_06", "archetype": "refund_spike", "sql_id": "S001493", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001327", "created_ts": "2024-11-14 16:55:13", "analyst": "analyst_12", "archetype": "campaign_funnel", "sql_id": "S001327", "expected_sources": ["raw_digital_events", "tmp_e001327"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e001327", "expr": "temp materialization"}]}
{"query_id": "E000555", "created_ts": "2024-11-15 11:00:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000555", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000687", "created_ts": "2024-11-15 11:00:05", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000687", "expected_sources": ["raw_digital_events", "tmp_e000687"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000687", "expr": "temp materialization"}]}
{"query_id": "E000194", "created_ts": "2024-11-15 11:05:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000194", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001370", "created_ts": "2024-11-15 17:20:03", "analyst": "analyst_09", "archetype": "attach_rate", "sql_id": "S001370", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000195", "created_ts": "2024-11-18 09:30:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000195", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001097", "created_ts": "2024-11-18 09:35:21", "analyst": "analyst_10", "archetype": "attach_rate", "sql_id": "S001097", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001161", "created_ts": "2024-11-18 10:07:02", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S001161", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000999", "created_ts": "2024-11-18 10:20:55", "analyst": "analyst_09", "archetype": "deals_pipeline", "sql_id": "S000999", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001008", "created_ts": "2024-11-18 10:25:05", "analyst": "analyst_12", "archetype": "refund_spike", "sql_id": "S001008", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001043", "created_ts": "2024-11-18 10:40:08", "analyst": "analyst_07", "archetype": "attach_rate", "sql_id": "S001043", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000800", "created_ts": "2024-11-18 10:50:00", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000800", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000379", "created_ts": "2024-11-18 10:50:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000379", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000766", "created_ts": "2024-11-18 10:50:55", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000766", "expected_sources": ["raw_ticket_sales", "raw_merch_orders", "tmp_e000766"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}, {"name": "tmp_e000766", "expr": "temp materialization"}]}
{"query_id": "E000731", "created_ts": "2024-11-18 11:00:21", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000731", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000981", "created_ts": "2024-11-18 11:03:02", "analyst": "analyst_02", "archetype": "campaign_funnel", "sql_id": "S000981", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001382", "created_ts": "2024-11-18 12:07:05", "analyst": "analyst_02", "archetype": "support_sla", "sql_id": "S001382", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001086", "created_ts": "2024-11-18 13:03:01", "analyst": "analyst_09", "archetype": "attach_rate", "sql_id": "S001086", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001099", "created_ts": "2024-11-18 14:15:55", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S001099", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001058", "created_ts": "2024-11-18 17:40:05", "analyst": "analyst_05", "archetype": "attach_rate", "sql_id": "S001058", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001065", "created_ts": "2024-11-18 18:03:01", "analyst": "analyst_02", "archetype": "support_sla", "sql_id": "S001065", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001473", "created_ts": "2024-11-19 09:25:01", "analyst": "analyst_07", "archetype": "refund_spike", "sql_id": "S001473", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000196", "created_ts": "2024-11-19 10:15:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000196", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000977", "created_ts": "2024-11-19 11:03:05", "analyst": "analyst_11", "archetype": "rfm_segmentation", "sql_id": "S000977", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000688", "created_ts": "2024-11-19 11:50:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000688", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001302", "created_ts": "2024-11-19 18:45:02", "analyst": "analyst_07", "archetype": "marketing_last_touch", "sql_id": "S001302", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001037", "created_ts": "2024-11-19 19:45:05", "analyst": "analyst_12", "archetype": "campaign_funnel", "sql_id": "S001037", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000689", "created_ts": "2024-11-20 08:20:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000689", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000556", "created_ts": "2024-11-20 09:05:34", "analyst": "analyst_09", "archetype": "attendance_rate", "sql_id": "S000556", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000197", "created_ts": "2024-11-20 10:10:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000197", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000198", "created_ts": "2024-11-21 10:50:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000198", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000557", "created_ts": "2024-11-21 11:15:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000557", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000690", "created_ts": "2024-11-22 09:30:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000690", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000380", "created_ts": "2024-11-22 11:40:00", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000380", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000558", "created_ts": "2024-11-22 11:50:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000558", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001179", "created_ts": "2024-11-22 14:00:21", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S001179", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000990", "created_ts": "2024-11-22 16:00:55", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S000990", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000691", "created_ts": "2024-11-24 10:00:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000691", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001475", "created_ts": "2024-11-24 12:10:08", "analyst": "analyst_06", "archetype": "refund_spike", "sql_id": "S001475", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000767", "created_ts": "2024-11-25 09:10:02", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000767", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000982", "created_ts": "2024-11-25 09:55:05", "analyst": "analyst_12", "archetype": "attach_rate", "sql_id": "S000982", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001250", "created_ts": "2024-11-25 10:15:21", "analyst": "analyst_07", "archetype": "deals_pipeline", "sql_id": "S001250", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000381", "created_ts": "2024-11-25 10:20:34", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000381", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001031", "created_ts": "2024-11-25 11:40:03", "analyst": "analyst_09", "archetype": "deals_pipeline", "sql_id": "S001031", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000837", "created_ts": "2024-11-25 11:40:34", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000837", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001038", "created_ts": "2024-11-25 11:45:21", "analyst": "analyst_07", "archetype": "rfm_segmentation", "sql_id": "S001038", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000732", "created_ts": "2024-11-25 11:50:00", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000732", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000559", "created_ts": "2024-11-25 11:50:21", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000559", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001170", "created_ts": "2024-11-25 12:15:55", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S001170", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001259", "created_ts": "2024-11-25 13:03:13", "analyst": "analyst_07", "archetype": "rfm_segmentation", "sql_id": "S001259", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000801", "created_ts": "2024-11-25 13:20:00", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000801", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001218", "created_ts": "2024-11-25 13:25:05", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S001218", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001335", "created_ts": "2024-11-25 15:10:21", "analyst": "analyst_02", "archetype": "attendance_rate", "sql_id": "S001335", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001119", "created_ts": "2024-11-25 19:45:03", "analyst": "analyst_11", "archetype": "support_sla", "sql_id": "S001119", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000199", "created_ts": "2024-11-26 09:00:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000199", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000382", "created_ts": "2024-11-26 11:15:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000382", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000560", "created_ts": "2024-11-26 11:40:34", "analyst": "analyst_01", "archetype": "attendance_rate", "sql_id": "S000560", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001172", "created_ts": "2024-11-26 14:07:55", "analyst": "analyst_06", "archetype": "deals_pipeline", "sql_id": "S001172", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001131", "created_ts": "2024-11-26 14:20:00", "analyst": "analyst_08", "archetype": "attendance_rate", "sql_id": "S001131", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001306", "created_ts": "2024-11-26 15:25:08", "analyst": "analyst_10", "archetype": "support_sla", "sql_id": "S001306", "expected_sources": ["support_tickets", "tmp_e001306"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}, {"name": "tmp_e001306", "expr": "temp materialization"}]}
{"query_id": "E001269", "created_ts": "2024-11-26 16:40:21", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S001269", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001130", "created_ts": "2024-11-26 16:55:03", "analyst": "analyst_08", "archetype": "attendance_rate", "sql_id": "S001130", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e001130"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e001130", "expr": "temp materialization"}]}
{"query_id": "E000692", "created_ts": "2024-11-27 08:20:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000692", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000200", "created_ts": "2024-11-27 08:40:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000200", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000976", "created_ts": "2024-11-27 18:25:05", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S000976", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000201", "created_ts": "2024-11-28 09:10:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000201", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000561", "created_ts": "2024-11-28 09:10:34", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000561", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000383", "created_ts": "2024-11-28 10:00:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000383", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001174", "created_ts": "2024-11-28 10:35:21", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S001174", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001466", "created_ts": "2024-11-28 11:20:34", "analyst": "analyst_05", "archetype": "campaign_funnel", "sql_id": "S001466", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001450", "created_ts": "2024-11-28 13:35:05", "analyst": "analyst_02", "archetype": "attach_rate", "sql_id": "S001450", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001074", "created_ts": "2024-11-28 16:55:13", "analyst": "analyst_03", "archetype": "refund_spike", "sql_id": "S001074", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000940", "created_ts": "2024-11-28 18:07:34", "analyst": "analyst_02", "archetype": "refund_spike", "sql_id": "S000940", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000941", "created_ts": "2024-11-28 18:22:34", "analyst": "analyst_02", "archetype": "refund_spike", "sql_id": "S000941", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000943", "created_ts": "2024-11-28 18:31:34", "analyst": "analyst_02", "archetype": "refund_spike", "sql_id": "S000943", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000942", "created_ts": "2024-11-28 19:37:34", "analyst": "analyst_02", "archetype": "refund_spike", "sql_id": "S000942", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000202", "created_ts": "2024-11-29 10:20:02", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000202", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000384", "created_ts": "2024-11-29 10:45:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000384", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000384"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000384", "expr": "temp materialization"}]}
{"query_id": "E001203", "created_ts": "2024-11-29 11:15:00", "analyst": "analyst_09", "archetype": "support_sla", "sql_id": "S001203", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001087", "created_ts": "2024-11-29 16:07:00", "analyst": "analyst_07", "archetype": "campaign_funnel", "sql_id": "S001087", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001235", "created_ts": "2024-11-29 16:30:05", "analyst": "analyst_03", "archetype": "refund_spike", "sql_id": "S001235", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000203", "created_ts": "2024-12-02 09:30:05", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S000203", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001162", "created_ts": "2024-12-02 10:00:01", "analyst": "analyst_11", "archetype": "ticket_revenue_daily", "sql_id": "S001162", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001404", "created_ts": "2024-12-02 10:03:02", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001404", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e001404"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e001404", "expr": "temp materialization"}]}
{"query_id": "E001316", "created_ts": "2024-12-02 10:10:01", "analyst": "analyst_10", "archetype": "attendance_rate", "sql_id": "S001316", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000768", "created_ts": "2024-12-02 10:50:08", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000768", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000562", "created_ts": "2024-12-02 11:15:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000562", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000693", "created_ts": "2024-12-02 11:15:01", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000693", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000838", "created_ts": "2024-12-02 11:20:02", "analyst": "analyst_06", "archetype": "marketing_last_touch", "sql_id": "S000838", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001439", "created_ts": "2024-12-02 11:40:03", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S001439", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000870", "created_ts": "2024-12-02 11:45:01", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000870", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000850", "created_ts": "2024-12-02 11:45:55", "analyst": "analyst_09", "archetype": "rfm_segmentation", "sql_id": "S000850", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000860", "created_ts": "2024-12-02 13:00:00", "analyst": "analyst_10", "archetype": "deals_pipeline", "sql_id": "S000860", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001290", "created_ts": "2024-12-02 14:00:34", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S001290", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e001290"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e001290", "expr": "temp materialization"}]}
{"query_id": "E000802", "created_ts": "2024-12-02 14:40:00", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000802", "expected_sources": ["support_tickets", "tmp_e000802"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}, {"name": "tmp_e000802", "expr": "temp materialization"}]}
{"query_id": "E000880", "created_ts": "2024-12-02 15:15:55", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000880", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001059", "created_ts": "2024-12-02 17:00:03", "analyst": "analyst_09", "archetype": "campaign_funnel", "sql_id": "S001059", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001152", "created_ts": "2024-12-02 18:50:05", "analyst": "analyst_11", "archetype": "deals_pipeline", "sql_id": "S001152", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000204", "created_ts": "2024-12-03 08:20:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000204", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000563", "created_ts": "2024-12-03 09:30:01", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000563", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001308", "created_ts": "2024-12-03 10:40:34", "analyst": "analyst_07", "archetype": "refund_spike", "sql_id": "S001308", "expected_sources": ["raw_ticket_sales", "tmp_e001308"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}, {"name": "tmp_e001308", "expr": "temp materialization"}]}
{"query_id": "E001456", "created_ts": "2024-12-03 14:25:34", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001456", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000564", "created_ts": "2024-12-04 09:05:08", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000564", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000205", "created_ts": "2024-12-04 10:30:13", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000205", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000385", "created_ts": "2024-12-04 10:40:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000385", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000972", "created_ts": "2024-12-04 14:03:13", "analyst": "analyst_05", "archetype": "campaign_funnel", "sql_id": "S000972", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000973", "created_ts": "2024-12-04 14:11:13", "analyst": "analyst_05", "archetype": "campaign_funnel", "sql_id": "S000973", "expected_sources": ["raw_digital_events", "tmp_e000973"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}, {"name": "tmp_e000973", "expr": "temp materialization"}]}
{"query_id": "E001225", "created_ts": "2024-12-04 19:30:02", "analyst": "analyst_11", "archetype": "rfm_segmentation", "sql_id": "S001225", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000565", "created_ts": "2024-12-05 08:20:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000565", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000386", "created_ts": "2024-12-05 09:00:00", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000386", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000694", "created_ts": "2024-12-05 09:00:02", "analyst": "analyst_02", "archetype": "campaign_funnel", "sql_id": "S000694", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000206", "created_ts": "2024-12-05 09:40:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000206", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001406", "created_ts": "2024-12-05 16:00:02", "analyst": "analyst_12", "archetype": "refund_spike", "sql_id": "S001406", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000566", "created_ts": "2024-12-06 08:10:05", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000566", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000695", "created_ts": "2024-12-06 09:50:34", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000695", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001263", "created_ts": "2024-12-06 10:00:21", "analyst": "analyst_09", "archetype": "refund_spike", "sql_id": "S001263", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001183", "created_ts": "2024-12-06 11:00:05", "analyst": "analyst_12", "archetype": "attendance_rate", "sql_id": "S001183", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000962", "created_ts": "2024-12-06 11:55:05", "analyst": "analyst_07", "archetype": "attendance_rate", "sql_id": "S000962", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000963", "created_ts": "2024-12-06 12:55:05", "analyst": "analyst_07", "archetype": "attendance_rate", "sql_id": "S000963", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000964", "created_ts": "2024-12-06 13:55:05", "analyst": "analyst_07", "archetype": "attendance_rate", "sql_id": "S000964", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001068", "created_ts": "2024-12-06 14:20:02", "analyst": "analyst_03", "archetype": "ticket_revenue_daily", "sql_id": "S001068", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001419", "created_ts": "2024-12-06 15:15:34", "analyst": "analyst_03", "archetype": "campaign_funnel", "sql_id": "S001419", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001154", "created_ts": "2024-12-06 17:07:55", "analyst": "analyst_06", "archetype": "refund_spike", "sql_id": "S001154", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001221", "created_ts": "2024-12-06 17:30:08", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S001221", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000567", "created_ts": "2024-12-07 08:00:08", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000567", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001470", "created_ts": "2024-12-08 12:35:21", "analyst": "analyst_10", "archetype": "rfm_segmentation", "sql_id": "S001470", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E000387", "created_ts": "2024-12-09 09:05:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000387", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000387"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000387", "expr": "temp materialization"}]}
{"query_id": "E000839", "created_ts": "2024-12-09 11:00:00", "analyst": "analyst_01", "archetype": "marketing_last_touch", "sql_id": "S000839", "expected_sources": ["raw_ticket_sales", "marketing_touches", "tmp_e000839"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}, {"name": "tmp_e000839", "expr": "temp materialization"}]}
{"query_id": "E000207", "created_ts": "2024-12-09 11:10:21", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S000207", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000207"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000207", "expr": "temp materialization"}]}
{"query_id": "E000733", "created_ts": "2024-12-09 11:30:00", "analyst": "analyst_06", "archetype": "refund_spike", "sql_id": "S000733", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000568", "created_ts": "2024-12-09 11:50:34", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000568", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001433", "created_ts": "2024-12-09 12:45:55", "analyst": "analyst_11", "archetype": "attach_rate", "sql_id": "S001433", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001193", "created_ts": "2024-12-09 13:30:02", "analyst": "analyst_01", "archetype": "support_sla", "sql_id": "S001193", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000208", "created_ts": "2024-12-10 09:45:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000208", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000569", "created_ts": "2024-12-10 10:50:05", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000569", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000696", "created_ts": "2024-12-11 09:45:01", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000696", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001232", "created_ts": "2024-12-11 10:40:13", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S001232", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001354", "created_ts": "2024-12-11 15:55:00", "analyst": "analyst_08", "archetype": "refund_spike", "sql_id": "S001354", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000388", "created_ts": "2024-12-12 08:05:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000388", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001053", "created_ts": "2024-12-12 12:25:13", "analyst": "analyst_01", "archetype": "marketing_last_touch", "sql_id": "S001053", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001150", "created_ts": "2024-12-12 13:03:01", "analyst": "analyst_04", "archetype": "ticket_revenue_daily", "sql_id": "S001150", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001001", "created_ts": "2024-12-12 13:40:00", "analyst": "analyst_12", "archetype": "attendance_rate", "sql_id": "S001001", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e001001"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e001001", "expr": "temp materialization"}]}
{"query_id": "E001253", "created_ts": "2024-12-12 14:15:01", "analyst": "analyst_06", "archetype": "ticket_revenue_daily", "sql_id": "S001253", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001485", "created_ts": "2024-12-12 15:20:21", "analyst": "analyst_12", "archetype": "refund_spike", "sql_id": "S001485", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000697", "created_ts": "2024-12-13 08:00:03", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000697", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000570", "created_ts": "2024-12-13 08:20:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000570", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e000570"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e000570", "expr": "temp materialization"}]}
{"query_id": "E000389", "created_ts": "2024-12-13 08:50:55", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000389", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000389"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000389", "expr": "temp materialization"}]}
{"query_id": "E001002", "created_ts": "2024-12-13 16:45:08", "analyst": "analyst_11", "archetype": "attendance_rate", "sql_id": "S001002", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000571", "created_ts": "2024-12-14 09:40:34", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000571", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000209", "created_ts": "2024-12-16 08:00:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000209", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000572", "created_ts": "2024-12-16 09:45:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000572", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001415", "created_ts": "2024-12-16 11:40:34", "analyst": "analyst_12", "archetype": "support_sla", "sql_id": "S001415", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000390", "created_ts": "2024-12-16 11:45:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000390", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001009", "created_ts": "2024-12-16 12:07:01", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S001009", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001062", "created_ts": "2024-12-16 12:40:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S001062", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000803", "created_ts": "2024-12-16 13:20:05", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000803", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000769", "created_ts": "2024-12-16 13:40:34", "analyst": "analyst_06", "archetype": "attach_rate", "sql_id": "S000769", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001499", "created_ts": "2024-12-16 14:35:13", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S001499", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000734", "created_ts": "2024-12-16 14:50:05", "analyst": "analyst_11", "archetype": "refund_spike", "sql_id": "S000734", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001118", "created_ts": "2024-12-16 16:10:03", "analyst": "analyst_07", "archetype": "campaign_funnel", "sql_id": "S001118", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001442", "created_ts": "2024-12-16 16:10:03", "analyst": "analyst_08", "archetype": "campaign_funnel", "sql_id": "S001442", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001229", "created_ts": "2024-12-16 16:35:00", "analyst": "analyst_10", "archetype": "campaign_funnel", "sql_id": "S001229", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001151", "created_ts": "2024-12-16 18:15:21", "analyst": "analyst_12", "archetype": "marketing_last_touch", "sql_id": "S001151", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001479", "created_ts": "2024-12-16 18:40:03", "analyst": "analyst_10", "archetype": "campaign_funnel", "sql_id": "S001479", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001103", "created_ts": "2024-12-16 20:35:05", "analyst": "analyst_06", "archetype": "campaign_funnel", "sql_id": "S001103", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001061", "created_ts": "2024-12-17 10:45:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S001061", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e001061"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e001061", "expr": "temp materialization"}]}
{"query_id": "E000210", "created_ts": "2024-12-17 10:45:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000210", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e000210"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000210", "expr": "temp materialization"}]}
{"query_id": "E000391", "created_ts": "2024-12-17 11:05:13", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000391", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001465", "created_ts": "2024-12-17 16:25:08", "analyst": "analyst_04", "archetype": "deals_pipeline", "sql_id": "S001465", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001396", "created_ts": "2024-12-18 09:25:02", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S001396", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001064", "created_ts": "2024-12-18 09:45:03", "analyst": "analyst_09", "archetype": "attendance_rate", "sql_id": "S001064", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000573", "created_ts": "2024-12-18 09:50:00", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000573", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000392", "created_ts": "2024-12-18 10:45:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000392", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000698", "created_ts": "2024-12-18 11:45:05", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000698", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E001055", "created_ts": "2024-12-18 12:20:55", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S001055", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e001055"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e001055", "expr": "temp materialization"}]}
{"query_id": "E001056", "created_ts": "2024-12-18 13:35:34", "analyst": "analyst_08", "archetype": "attach_rate", "sql_id": "S001056", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001351", "created_ts": "2024-12-18 14:50:03", "analyst": "analyst_04", "archetype": "deals_pipeline", "sql_id": "S001351", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001078", "created_ts": "2024-12-18 16:50:13", "analyst": "analyst_05", "archetype": "ticket_revenue_daily", "sql_id": "S001078", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001102", "created_ts": "2024-12-18 18:00:13", "analyst": "analyst_11", "archetype": "ticket_revenue_daily", "sql_id": "S001102", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000574", "created_ts": "2024-12-19 08:10:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000574", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000393", "created_ts": "2024-12-19 09:20:34", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000393", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000699", "created_ts": "2024-12-19 11:30:05", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000699", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000211", "created_ts": "2024-12-19 11:40:01", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000211", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001423", "created_ts": "2024-12-19 12:07:08", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S001423", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001315", "created_ts": "2024-12-19 15:00:08", "analyst": "analyst_11", "archetype": "refund_spike", "sql_id": "S001315", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001112", "created_ts": "2024-12-20 10:30:02", "analyst": "analyst_08", "archetype": "attendance_rate", "sql_id": "S001112", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e001112"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e001112", "expr": "temp materialization"}]}
{"query_id": "E000212", "created_ts": "2024-12-20 11:00:03", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000212", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001000", "created_ts": "2024-12-20 18:15:21", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S001000", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000394", "created_ts": "2024-12-21 11:05:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000394", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000395", "created_ts": "2024-12-22 10:40:21", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000395", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000395"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000395", "expr": "temp materialization"}]}
{"query_id": "E001185", "created_ts": "2024-12-22 14:10:02", "analyst": "analyst_03", "archetype": "refund_spike", "sql_id": "S001185", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000213", "created_ts": "2024-12-23 08:00:13", "analyst": "analyst_09", "archetype": "ticket_revenue_daily", "sql_id": "S000213", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000575", "created_ts": "2024-12-23 09:45:02", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000575", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001488", "created_ts": "2024-12-23 10:30:01", "analyst": "analyst_01", "archetype": "deals_pipeline", "sql_id": "S001488", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001051", "created_ts": "2024-12-23 11:00:05", "analyst": "analyst_09", "archetype": "support_sla", "sql_id": "S001051", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000700", "created_ts": "2024-12-23 11:15:08", "analyst": "analyst_04", "archetype": "campaign_funnel", "sql_id": "S000700", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000396", "created_ts": "2024-12-23 11:20:02", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000396", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000840", "created_ts": "2024-12-23 11:30:13", "analyst": "analyst_08", "archetype": "marketing_last_touch", "sql_id": "S000840", "expected_sources": ["raw_ticket_sales", "marketing_touches", "tmp_e000840"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}, {"name": "tmp_e000840", "expr": "temp materialization"}]}
{"query_id": "E001322", "created_ts": "2024-12-23 12:25:21", "analyst": "analyst_12", "archetype": "attach_rate", "sql_id": "S001322", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000735", "created_ts": "2024-12-23 13:50:01", "analyst": "analyst_05", "archetype": "refund_spike", "sql_id": "S000735", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000804", "created_ts": "2024-12-23 13:50:13", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000804", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001368", "created_ts": "2024-12-23 16:15:03", "analyst": "analyst_01", "archetype": "rfm_segmentation", "sql_id": "S001368", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "customers", "expr": "COUNT(*)"}, {"name": "avg_value", "expr": "AVG(total_value)"}], "expected_intermediates": [{"name": "value", "expr": "ticket: net_revenue_excl_fees; merch: merch_subtotal"}, {"name": "rfm_segment", "expr": "CASE ... END"}]}
{"query_id": "E001046", "created_ts": "2024-12-23 16:25:02", "analyst": "analyst_09", "archetype": "attach_rate", "sql_id": "S001046", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E001122", "created_ts": "2024-12-23 16:45:21", "analyst": "analyst_10", "archetype": "marketing_last_touch", "sql_id": "S001122", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E001194", "created_ts": "2024-12-23 17:07:02", "analyst": "analyst_12", "archetype": "marketing_last_touch", "sql_id": "S001194", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000576", "created_ts": "2024-12-24 08:30:55", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000576", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000214", "created_ts": "2024-12-24 10:00:34", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000214", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001247", "created_ts": "2024-12-24 10:55:05", "analyst": "analyst_08", "archetype": "ticket_revenue_daily", "sql_id": "S001247", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer", "tmp_e001247"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e001247", "expr": "temp materialization"}]}
{"query_id": "E001184", "created_ts": "2024-12-24 11:07:02", "analyst": "analyst_10", "archetype": "ticket_revenue_daily", "sql_id": "S001184", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000577", "created_ts": "2024-12-25 10:20:02", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000577", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000215", "created_ts": "2024-12-25 10:40:00", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000215", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000397", "created_ts": "2024-12-25 10:40:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000397", "expected_sources": ["raw_ticket_sales", "dim_customer", "tmp_e000397"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}, {"name": "tmp_e000397", "expr": "temp materialization"}]}
{"query_id": "E001035", "created_ts": "2024-12-25 15:00:08", "analyst": "analyst_06", "archetype": "attendance_rate", "sql_id": "S001035", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans", "tmp_e001035"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}, {"name": "tmp_e001035", "expr": "temp materialization"}]}
{"query_id": "E001451", "created_ts": "2024-12-25 16:45:00", "analyst": "analyst_01", "archetype": "support_sla", "sql_id": "S001451", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E000578", "created_ts": "2024-12-26 08:05:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000578", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000398", "created_ts": "2024-12-26 10:05:03", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000398", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001034", "created_ts": "2024-12-26 10:45:05", "analyst": "analyst_07", "archetype": "refund_spike", "sql_id": "S001034", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001212", "created_ts": "2024-12-26 11:00:00", "analyst": "analyst_09", "archetype": "marketing_last_touch", "sql_id": "S001212", "expected_sources": ["raw_ticket_sales", "marketing_touches"], "expected_kpis": [{"name": "attributed_tickets", "expr": "COUNT(DISTINCT p.ticket_id)"}, {"name": "attributed_net_revenue", "expr": "SUM(p.net_revenue_excl_fees)"}], "expected_intermediates": [{"name": "net_revenue_excl_fees", "expr": "(face_value - COALESCE(discount_amount,0))"}, {"name": "last_touch_ts", "expr": "MAX(t.touch_ts)"}]}
{"query_id": "E000216", "created_ts": "2024-12-26 11:40:05", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000216", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001262", "created_ts": "2024-12-26 14:03:21", "analyst": "analyst_08", "archetype": "deals_pipeline", "sql_id": "S001262", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E001011", "created_ts": "2024-12-26 17:45:05", "analyst": "analyst_06", "archetype": "deals_pipeline", "sql_id": "S001011", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000579", "created_ts": "2024-12-27 11:20:03", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000579", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E000217", "created_ts": "2024-12-27 11:30:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000217", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001081", "created_ts": "2024-12-27 15:15:55", "analyst": "analyst_11", "archetype": "ticket_revenue_daily", "sql_id": "S001081", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001201", "created_ts": "2024-12-27 20:35:00", "analyst": "analyst_12", "archetype": "refund_spike", "sql_id": "S001201", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E000218", "created_ts": "2024-12-29 08:45:08", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000218", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000399", "created_ts": "2024-12-30 08:05:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000399", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000770", "created_ts": "2024-12-30 09:30:00", "analyst": "analyst_12", "archetype": "attach_rate", "sql_id": "S000770", "expected_sources": ["raw_ticket_sales", "raw_merch_orders"], "expected_kpis": [{"name": "tickets_sold", "expr": "COUNT(DISTINCT tickets.ticket_id)"}, {"name": "tickets_with_merch", "expr": "COUNT(DISTINCT attached.ticket_id)"}, {"name": "merch_attach_rate", "expr": "tickets_with_merch / tickets_sold"}], "expected_intermediates": [{"name": "attached", "expr": "ticket_id where merch order within window"}]}
{"query_id": "E000219", "created_ts": "2024-12-30 10:40:21", "analyst": "analyst_01", "archetype": "ticket_revenue_daily", "sql_id": "S000219", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001427", "created_ts": "2024-12-30 10:55:01", "analyst": "analyst_08", "archetype": "attendance_rate", "sql_id": "S001427", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001196", "created_ts": "2024-12-30 11:00:02", "analyst": "analyst_02", "archetype": "deals_pipeline", "sql_id": "S001196", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
{"query_id": "E000805", "created_ts": "2024-12-30 11:30:55", "analyst": "analyst_07", "archetype": "support_sla", "sql_id": "S000805", "expected_sources": ["support_tickets"], "expected_kpis": [{"name": "resolved_tickets", "expr": "COUNT(*)"}, {"name": "avg_resolution_hours", "expr": "AVG(resolution_hours)"}, {"name": "p90_resolution_hours", "expr": "PERCENTILE_CONT(0.9) ..."}], "expected_intermediates": [{"name": "resolution_hours", "expr": "EXTRACT(EPOCH FROM (resolved_ts-created_ts))/3600"}]}
{"query_id": "E001367", "created_ts": "2024-12-30 12:50:03", "analyst": "analyst_07", "archetype": "refund_spike", "sql_id": "S001367", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001381", "created_ts": "2024-12-30 14:03:13", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S001381", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E001090", "created_ts": "2024-12-30 15:07:34", "analyst": "analyst_03", "archetype": "refund_spike", "sql_id": "S001090", "expected_sources": ["raw_ticket_sales"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(*)"}, {"name": "refunded_tickets", "expr": "SUM(CASE WHEN refunded_flag THEN 1 END)"}, {"name": "refund_rate", "expr": "refunded_tickets / tickets"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', purchased_at)"}]}
{"query_id": "E001173", "created_ts": "2024-12-30 15:30:02", "analyst": "analyst_01", "archetype": "campaign_funnel", "sql_id": "S001173", "expected_sources": ["raw_digital_events"], "expected_kpis": [{"name": "sessions", "expr": "COUNT(*)"}, {"name": "sessions_with_purchase", "expr": "SUM(purchased)"}, {"name": "session_conversion_rate", "expr": "sessions_with_purchase / sessions"}], "expected_intermediates": [{"name": "saw_page", "expr": "MAX(CASE WHEN event_type='PAGE_VIEW' THEN 1 END)"}, {"name": "started_checkout", "expr": "MAX(CASE WHEN event_type='CHECKOUT_START' THEN 1 END)"}, {"name": "purchased", "expr": "MAX(CASE WHEN event_type='PURCHASE' THEN 1 END)"}]}
{"query_id": "E000220", "created_ts": "2024-12-31 10:15:13", "analyst": "analyst_07", "archetype": "ticket_revenue_daily", "sql_id": "S000220", "expected_sources": ["analytics.vw_ticket_sales_enriched", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(gross_revenue)"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000400", "created_ts": "2024-12-31 10:30:05", "analyst": "analyst_02", "archetype": "ticket_revenue_daily", "sql_id": "S000400", "expected_sources": ["raw_ticket_sales", "dim_customer"], "expected_kpis": [{"name": "gross_revenue", "expr": "SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0))"}, {"name": "net_revenue", "expr": "SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0))"}, {"name": "tickets_sold", "expr": "COUNT(DISTINCT t.ticket_id)"}], "expected_intermediates": [{"name": "day", "expr": "DATE_TRUNC('day', t.purchased_at)"}]}
{"query_id": "E000580", "created_ts": "2024-12-31 11:00:13", "analyst": "analyst_03", "archetype": "attendance_rate", "sql_id": "S000580", "expected_sources": ["raw_ticket_sales", "dim_event", "raw_attendance_scans"], "expected_kpis": [{"name": "tickets", "expr": "COUNT(DISTINCT b.ticket_id)"}, {"name": "attended", "expr": "SUM(COALESCE(s.attended_flag,0))"}, {"name": "attendance_rate", "expr": "attended / tickets"}], "expected_intermediates": [{"name": "event_week", "expr": "DATE_TRUNC('week', e.event_date::timestamp)"}, {"name": "attended_flag", "expr": "CASE WHEN scanned_at IS NOT NULL THEN 1 ELSE 0 END"}]}
{"query_id": "E001428", "created_ts": "2024-12-31 12:15:00", "analyst": "analyst_12", "archetype": "deals_pipeline", "sql_id": "S001428", "expected_sources": ["crm_deals"], "expected_kpis": [{"name": "deals_created", "expr": "COUNT(*)"}, {"name": "pipeline_amount", "expr": "SUM(amount)"}], "expected_intermediates": [{"name": "month", "expr": "DATE_TRUNC('month', created_ts)"}]}
