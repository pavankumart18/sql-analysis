const APP_DATA = [
  {
    "sql_id": "S000001",
    "query_hash": "65a2a9ee",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000002",
    "query_hash": "ffc12d7c",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000003",
    "query_hash": "17632312",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000004",
    "query_hash": "398ad8a4",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000005",
    "query_hash": "c5f4e93e",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000006",
    "query_hash": "9be87f0d",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000007",
    "query_hash": "749661f5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000008",
    "query_hash": "7a8010d8",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000009",
    "query_hash": "330488f1",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000010",
    "query_hash": "ba88f09a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000011",
    "query_hash": "8f5e8276",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000012",
    "query_hash": "73f4000b",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000013",
    "query_hash": "d2afbd2e",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000014",
    "query_hash": "eb4194d4",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000015",
    "query_hash": "4a3242df",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000016",
    "query_hash": "a6e3c739",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000017",
    "query_hash": "d3d7d06c",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000018",
    "query_hash": "6eac003d",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000019",
    "query_hash": "045385c5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000020",
    "query_hash": "cb13a271",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000021",
    "query_hash": "5479a1f9",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000022",
    "query_hash": "f2f84499",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000023",
    "query_hash": "88b9bed5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000024",
    "query_hash": "9fd43b2e",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000025",
    "query_hash": "180d5a9e",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000026",
    "query_hash": "eeed31db",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000027",
    "query_hash": "07227dca",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000028",
    "query_hash": "ecdb7423",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000029",
    "query_hash": "c8c620e4",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000030",
    "query_hash": "056f56ad",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000031",
    "query_hash": "a8bb7272",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000031"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000031 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000031 LIMIT 500;"
  },
  {
    "sql_id": "S000032",
    "query_hash": "1aea286e",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000033",
    "query_hash": "c0ef6382",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000034",
    "query_hash": "bcca1afe",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000035",
    "query_hash": "ed00e574",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000036",
    "query_hash": "50f08c43",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000037",
    "query_hash": "9c0029f7",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000038",
    "query_hash": "c3230683",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000039",
    "query_hash": "be0fce6c",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000040",
    "query_hash": "98e620a5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000041",
    "query_hash": "951d839b",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000042",
    "query_hash": "faa2e51f",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000043",
    "query_hash": "5f38553a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000044",
    "query_hash": "ba85346c",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000045",
    "query_hash": "0a025e0c",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000046",
    "query_hash": "cdc8cf76",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000047",
    "query_hash": "fcad9d92",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000048",
    "query_hash": "df5413e7",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000049",
    "query_hash": "71720c88",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000050",
    "query_hash": "4f6235a0",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000051",
    "query_hash": "1afc5640",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000052",
    "query_hash": "23080484",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000053",
    "query_hash": "7e8f63fd",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000054",
    "query_hash": "7083dfac",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000055",
    "query_hash": "a9eb4673",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000056",
    "query_hash": "574381c2",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000057",
    "query_hash": "169348bd",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000058",
    "query_hash": "66527ac7",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000059",
    "query_hash": "f2584ab8",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000060",
    "query_hash": "6da35bec",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000061",
    "query_hash": "a531ff35",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000062",
    "query_hash": "2cf00693",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000063",
    "query_hash": "6afb3239",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000064",
    "query_hash": "87384829",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000065",
    "query_hash": "066958db",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000066",
    "query_hash": "d34a4e89",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000067",
    "query_hash": "c1b2e4d7",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000068",
    "query_hash": "27ce86ca",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000069",
    "query_hash": "d9fab011",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000070",
    "query_hash": "4ed556f7",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000071",
    "query_hash": "6acb9d6a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000072",
    "query_hash": "2647483a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000073",
    "query_hash": "ece6b8d7",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000074",
    "query_hash": "495207f1",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000075",
    "query_hash": "d0a9a286",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000076",
    "query_hash": "c44a4cd2",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000077",
    "query_hash": "9bdacc48",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000078",
    "query_hash": "fc0ef021",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000079",
    "query_hash": "bff2488b",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000080",
    "query_hash": "c8158f04",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000081",
    "query_hash": "abf5ef61",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000082",
    "query_hash": "d4d3dadf",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000083",
    "query_hash": "6e4dfc49",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000084",
    "query_hash": "4c3ac422",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000085",
    "query_hash": "a4eb5dfc",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000085"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000085 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000085 LIMIT 500;"
  },
  {
    "sql_id": "S000086",
    "query_hash": "acf15309",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000087",
    "query_hash": "8031e4cf",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000088",
    "query_hash": "ff269a27",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000088"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000088 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000088 LIMIT 500;"
  },
  {
    "sql_id": "S000089",
    "query_hash": "bdff54f6",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000089"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000089 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000089 LIMIT 500;"
  },
  {
    "sql_id": "S000090",
    "query_hash": "58ca9b2d",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000091",
    "query_hash": "8083597d",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000092",
    "query_hash": "0629ebe4",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000093",
    "query_hash": "95c94a8a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000094",
    "query_hash": "6e61bb98",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000095",
    "query_hash": "aed9cedc",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000096",
    "query_hash": "6384f90a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000097",
    "query_hash": "a8788417",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000098",
    "query_hash": "e644e6b6",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000099",
    "query_hash": "517e9dcf",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000100",
    "query_hash": "e466d2ff",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000100"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000100 AS\n        -- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000100 LIMIT 500;"
  },
  {
    "sql_id": "S000101",
    "query_hash": "fd8ae4fa",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000102",
    "query_hash": "726bc7b8",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000102"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000102 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000102 LIMIT 500;"
  },
  {
    "sql_id": "S000103",
    "query_hash": "26ca9042",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000104",
    "query_hash": "1c22329b",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000105",
    "query_hash": "97bb6946",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000106",
    "query_hash": "521cc089",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000107",
    "query_hash": "06899da1",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000108",
    "query_hash": "2416bfb5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000109",
    "query_hash": "63160c0a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000110",
    "query_hash": "7795dfbd",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000110"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000110 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000110 LIMIT 500;"
  },
  {
    "sql_id": "S000111",
    "query_hash": "6bc6a0f3",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000112",
    "query_hash": "b4cf9ee0",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000113",
    "query_hash": "eb1032e1",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000114",
    "query_hash": "8b78a9b6",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000115",
    "query_hash": "386a7a7c",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000116",
    "query_hash": "786f7ef9",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000116"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000116 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000116 LIMIT 500;"
  },
  {
    "sql_id": "S000117",
    "query_hash": "9a31d553",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000118",
    "query_hash": "71eaf69c",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000119",
    "query_hash": "ef68ffd8",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000120",
    "query_hash": "b2e406bf",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000121",
    "query_hash": "311588be",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000122",
    "query_hash": "7e94dbf5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000123",
    "query_hash": "4499c256",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000124",
    "query_hash": "c78a5d21",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000125",
    "query_hash": "8c601d9f",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000126",
    "query_hash": "9521410f",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000127",
    "query_hash": "1ab12e16",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000128",
    "query_hash": "f1482dca",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000128"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000128 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000128 LIMIT 500;"
  },
  {
    "sql_id": "S000129",
    "query_hash": "c725be86",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000130",
    "query_hash": "d69bb6c5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000131",
    "query_hash": "80cf6041",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000132",
    "query_hash": "6eb479c8",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000132"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000132 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;\n        SELECT * FROM tmp_e000132 LIMIT 500;"
  },
  {
    "sql_id": "S000133",
    "query_hash": "e8cd0513",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000134",
    "query_hash": "58612bea",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000135",
    "query_hash": "46a1a654",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000136",
    "query_hash": "36bd1634",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000137",
    "query_hash": "1353b047",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000137"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000137 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000137 LIMIT 500;"
  },
  {
    "sql_id": "S000138",
    "query_hash": "50614d06",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000139",
    "query_hash": "ee061c24",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000140",
    "query_hash": "536d4a3d",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000141",
    "query_hash": "ce9a5e41",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000142",
    "query_hash": "b9711cfd",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000143",
    "query_hash": "89a578dc",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000144",
    "query_hash": "8fe88fa7",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000145",
    "query_hash": "4c4e3550",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000146",
    "query_hash": "a87b8bca",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000147",
    "query_hash": "b077306e",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000148",
    "query_hash": "a4a05941",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000149",
    "query_hash": "bca25663",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000150",
    "query_hash": "08af1420",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000151",
    "query_hash": "c537234f",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000152",
    "query_hash": "178b8a18",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000153",
    "query_hash": "ef0cbe7f",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000154",
    "query_hash": "daee3e14",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000155",
    "query_hash": "909625dc",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000156",
    "query_hash": "4b76f81c",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000157",
    "query_hash": "0cc669b4",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000157"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000157 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000157 LIMIT 500;"
  },
  {
    "sql_id": "S000158",
    "query_hash": "1acf40d9",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000159",
    "query_hash": "19e84d69",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000160",
    "query_hash": "026abc4c",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000161",
    "query_hash": "d1ac6789",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000162",
    "query_hash": "4eec3c8c",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000163",
    "query_hash": "3a697a22",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000164",
    "query_hash": "3cc53821",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000165",
    "query_hash": "31ddc96b",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000166",
    "query_hash": "26b60ddc",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000167",
    "query_hash": "4dc0aab8",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000168",
    "query_hash": "0e511420",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000169",
    "query_hash": "4298bab4",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000170",
    "query_hash": "07964150",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000170"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000170 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000170 LIMIT 500;"
  },
  {
    "sql_id": "S000171",
    "query_hash": "e46737f1",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000172",
    "query_hash": "81851670",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000173",
    "query_hash": "ed36d2ee",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000174",
    "query_hash": "92f54151",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000175",
    "query_hash": "2c78ebc1",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000176",
    "query_hash": "3aa19ee9",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000177",
    "query_hash": "a17532ab",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000178",
    "query_hash": "ef1624ed",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000179",
    "query_hash": "631163a9",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000180",
    "query_hash": "7cb33259",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000181",
    "query_hash": "edb7738a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000182",
    "query_hash": "5d8d5f5d",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000182"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000182 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000182 LIMIT 500;"
  },
  {
    "sql_id": "S000183",
    "query_hash": "064e6705",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000184",
    "query_hash": "8922d5e8",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000185",
    "query_hash": "50d961c5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000186",
    "query_hash": "e8e91720",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000187",
    "query_hash": "6e442f28",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000188",
    "query_hash": "53c7bbd7",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000189",
    "query_hash": "1d6dd68d",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000190",
    "query_hash": "61b9451b",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000191",
    "query_hash": "4da4cdc5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000191"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000191 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000191 LIMIT 500;"
  },
  {
    "sql_id": "S000192",
    "query_hash": "e636a558",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000193",
    "query_hash": "5f942852",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000194",
    "query_hash": "42f6ac7a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000195",
    "query_hash": "715601c5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000196",
    "query_hash": "68dc954c",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000197",
    "query_hash": "32c2ca26",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000198",
    "query_hash": "6f37e794",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000199",
    "query_hash": "26d4dfb6",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000200",
    "query_hash": "036f96b5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000201",
    "query_hash": "c0750161",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000202",
    "query_hash": "22a95e04",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000203",
    "query_hash": "8f588ee6",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000204",
    "query_hash": "5b10ce14",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000205",
    "query_hash": "3f847ae6",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000206",
    "query_hash": "75485f1f",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000207",
    "query_hash": "3285bd28",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000207"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000207 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000207 LIMIT 500;"
  },
  {
    "sql_id": "S000208",
    "query_hash": "8d9239dc",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000209",
    "query_hash": "5e22f900",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000210",
    "query_hash": "a231a9f7",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000210"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000210 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000210 LIMIT 500;"
  },
  {
    "sql_id": "S000211",
    "query_hash": "dc11482a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000212",
    "query_hash": "0fa7b3d7",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000213",
    "query_hash": "6d2b369e",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000214",
    "query_hash": "d4ba2eef",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000215",
    "query_hash": "27cebf07",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000216",
    "query_hash": "92a046ff",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000217",
    "query_hash": "d3945e9e",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000218",
    "query_hash": "a3ccfae6",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000219",
    "query_hash": "91a2a2bb",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000220",
    "query_hash": "e2a7d7ae",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2025-01-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000221",
    "query_hash": "e38c61a5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000222",
    "query_hash": "495c7309",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000223",
    "query_hash": "5ab24149",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000224",
    "query_hash": "e1ed7524",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000225",
    "query_hash": "c6d1b175",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000226",
    "query_hash": "74d1affc",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000227",
    "query_hash": "be41d951",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000228",
    "query_hash": "1949e6ab",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000229",
    "query_hash": "9ec29a53",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000230",
    "query_hash": "c3491abe",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000231",
    "query_hash": "c590ba6d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000232",
    "query_hash": "f5545a2d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000233",
    "query_hash": "6c1179f2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000234",
    "query_hash": "095b9b66",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000235",
    "query_hash": "576c1dc0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000236",
    "query_hash": "4db9ca13",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000237",
    "query_hash": "3d08ec33",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000238",
    "query_hash": "4ac6f80b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000239",
    "query_hash": "0ef99bcb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000240",
    "query_hash": "e0438ae9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000241",
    "query_hash": "1de6459a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000242",
    "query_hash": "ae427254",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000243",
    "query_hash": "763d2d9e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000244",
    "query_hash": "c0e7102b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000245",
    "query_hash": "badc79ec",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000246",
    "query_hash": "63902db1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000247",
    "query_hash": "e992a44c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000247"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000247 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000247 LIMIT 500;"
  },
  {
    "sql_id": "S000248",
    "query_hash": "d256cbea",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000249",
    "query_hash": "50a85b5c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000250",
    "query_hash": "d083d482",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000251",
    "query_hash": "bfd5bade",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000252",
    "query_hash": "1916869a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000253",
    "query_hash": "678107e0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000254",
    "query_hash": "2bdfe148",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000255",
    "query_hash": "c9a9eaad",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000256",
    "query_hash": "15094039",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000257",
    "query_hash": "8c1be32f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000258",
    "query_hash": "e98f0f5e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000259",
    "query_hash": "26ecf989",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000260",
    "query_hash": "f7281a41",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000261",
    "query_hash": "226917b5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000262",
    "query_hash": "2f702935",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000263",
    "query_hash": "8d57ea31",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000264",
    "query_hash": "0fc096d7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000265",
    "query_hash": "487b668c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000266",
    "query_hash": "ff5ff4f1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000267",
    "query_hash": "1dcfbf07",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000267"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000267 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000267 LIMIT 500;"
  },
  {
    "sql_id": "S000268",
    "query_hash": "6537f555",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000269",
    "query_hash": "7ba7ad02",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000270",
    "query_hash": "2f0fdea8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000271",
    "query_hash": "f2f913b9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000272",
    "query_hash": "d971f937",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000273",
    "query_hash": "d5312887",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000274",
    "query_hash": "365a7f23",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000275",
    "query_hash": "08b5ce15",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000276",
    "query_hash": "5acef02d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000277",
    "query_hash": "c47c169f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000278",
    "query_hash": "7fa8a29c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000279",
    "query_hash": "3bc8890e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000280",
    "query_hash": "6ef7af03",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000281",
    "query_hash": "fbb07fa4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000282",
    "query_hash": "9b22181a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000282"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000282 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000282 LIMIT 500;"
  },
  {
    "sql_id": "S000283",
    "query_hash": "797e1f19",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000284",
    "query_hash": "7eba8a1d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000285",
    "query_hash": "436426a3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000286",
    "query_hash": "39afb057",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000287",
    "query_hash": "602eece5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000288",
    "query_hash": "79f2aeab",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000289",
    "query_hash": "91772ddd",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000290",
    "query_hash": "c739580f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000291",
    "query_hash": "13cd4ff6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000292",
    "query_hash": "dc2f3354",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000292"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000292 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000292 LIMIT 500;"
  },
  {
    "sql_id": "S000293",
    "query_hash": "440cd5e4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000294",
    "query_hash": "169c97ce",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000295",
    "query_hash": "cac9ec3e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000296",
    "query_hash": "c01be826",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000297",
    "query_hash": "17b5d6d6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000298",
    "query_hash": "6c43f29d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000299",
    "query_hash": "27358431",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000300",
    "query_hash": "aecc2463",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000301",
    "query_hash": "0ce6d43c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000302",
    "query_hash": "eedfecb7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000303",
    "query_hash": "b6436477",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000304",
    "query_hash": "4cb51098",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000305",
    "query_hash": "8687d83e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000306",
    "query_hash": "07bf03eb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000307",
    "query_hash": "f2c5db23",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000308",
    "query_hash": "80e2f76d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000308"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000308 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000308 LIMIT 500;"
  },
  {
    "sql_id": "S000309",
    "query_hash": "0eacf274",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000309"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000309 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000309 LIMIT 500;"
  },
  {
    "sql_id": "S000310",
    "query_hash": "2859aec2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000311",
    "query_hash": "1032fc92",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000312",
    "query_hash": "bf8fae66",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000313",
    "query_hash": "2dc9be68",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000314",
    "query_hash": "a9345036",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000315",
    "query_hash": "1e84ae98",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000315"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000315 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000315 LIMIT 500;"
  },
  {
    "sql_id": "S000316",
    "query_hash": "6b68e8bf",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000317",
    "query_hash": "054d0b99",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000318",
    "query_hash": "844aea44",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000319",
    "query_hash": "a4bd555f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000319"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000319 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000319 LIMIT 500;"
  },
  {
    "sql_id": "S000320",
    "query_hash": "28bd348d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000320"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000320 AS\n        -- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000320 LIMIT 500;"
  },
  {
    "sql_id": "S000321",
    "query_hash": "2fc5be66",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000322",
    "query_hash": "51fb8b3d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000323",
    "query_hash": "fd6d5bec",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000324",
    "query_hash": "2a619610",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000325",
    "query_hash": "7d3baeac",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000325"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000325 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000325 LIMIT 500;"
  },
  {
    "sql_id": "S000326",
    "query_hash": "a0ed49ed",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000327",
    "query_hash": "c59d6bd7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000328",
    "query_hash": "f36e0104",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000329",
    "query_hash": "e41c2796",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000330",
    "query_hash": "4486690b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000330"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000330 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000330 LIMIT 500;"
  },
  {
    "sql_id": "S000331",
    "query_hash": "4a11bcc8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000332",
    "query_hash": "c62dd16f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000333",
    "query_hash": "934e9c1a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000334",
    "query_hash": "ebd65194",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000335",
    "query_hash": "fd0c5760",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000336",
    "query_hash": "7b0557f5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000336"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000336 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000336 LIMIT 500;"
  },
  {
    "sql_id": "S000337",
    "query_hash": "3cdd8f7f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000338",
    "query_hash": "63dea9b7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000339",
    "query_hash": "28bbc504",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000340",
    "query_hash": "810ab52b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000341",
    "query_hash": "7d3b6620",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000342",
    "query_hash": "98976541",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000343",
    "query_hash": "c6932499",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000344",
    "query_hash": "d75f78a6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000345",
    "query_hash": "bfa29e19",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000346",
    "query_hash": "8a9331f1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000347",
    "query_hash": "efff930b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000348",
    "query_hash": "d28ebca8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000349",
    "query_hash": "b30fba14",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000350",
    "query_hash": "421eed8e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000351",
    "query_hash": "de5ad077",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000352",
    "query_hash": "025d7453",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000353",
    "query_hash": "fb532120",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000354",
    "query_hash": "eab04b84",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000355",
    "query_hash": "37252cd6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000355"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000355 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000355 LIMIT 500;"
  },
  {
    "sql_id": "S000356",
    "query_hash": "ee8f0aa6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000357",
    "query_hash": "bde0e12d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000358",
    "query_hash": "e6202073",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000359",
    "query_hash": "182742f8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000360",
    "query_hash": "e5068cbc",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000361",
    "query_hash": "f7bc1bcb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000362",
    "query_hash": "1d31a561",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000363",
    "query_hash": "be3c6ca2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000364",
    "query_hash": "9f4d1204",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000365",
    "query_hash": "8a995619",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000366",
    "query_hash": "35fea654",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000367",
    "query_hash": "8c38d73f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000367"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000367 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000367 LIMIT 500;"
  },
  {
    "sql_id": "S000368",
    "query_hash": "9e189801",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000369",
    "query_hash": "c1dc677a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000370",
    "query_hash": "b370e8ad",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000371",
    "query_hash": "6fdfecef",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000372",
    "query_hash": "aff3bd60",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000372"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000372 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;\n        SELECT * FROM tmp_e000372 LIMIT 500;"
  },
  {
    "sql_id": "S000373",
    "query_hash": "c32148f9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000374",
    "query_hash": "c82cd1c1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000375",
    "query_hash": "ef439c4e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000376",
    "query_hash": "bcc040ab",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000377",
    "query_hash": "30f89b5d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000378",
    "query_hash": "ad53b2d4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000379",
    "query_hash": "98ece69c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000380",
    "query_hash": "6c190ce3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000381",
    "query_hash": "8d3ce272",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000382",
    "query_hash": "451a988d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000383",
    "query_hash": "d6c6281e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000384",
    "query_hash": "583e6c4e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000384"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000384 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000384 LIMIT 500;"
  },
  {
    "sql_id": "S000385",
    "query_hash": "b0ff8a52",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000386",
    "query_hash": "e6c14996",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000387",
    "query_hash": "9456a807",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000387"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000387 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000387 LIMIT 500;"
  },
  {
    "sql_id": "S000388",
    "query_hash": "ef2ea58a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000389",
    "query_hash": "78f2e68e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000389"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000389 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000389 LIMIT 500;"
  },
  {
    "sql_id": "S000390",
    "query_hash": "69fc2b30",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000391",
    "query_hash": "38a9865e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000392",
    "query_hash": "a95ecb6d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000393",
    "query_hash": "87eaad21",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000394",
    "query_hash": "452b5e9b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000395",
    "query_hash": "7ecea646",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000395"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000395 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;\n        SELECT * FROM tmp_e000395 LIMIT 500;"
  },
  {
    "sql_id": "S000396",
    "query_hash": "ab9199d4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000397",
    "query_hash": "6d6b6b1c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000397"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000397 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000397 LIMIT 500;"
  },
  {
    "sql_id": "S000398",
    "query_hash": "b615da80",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000399",
    "query_hash": "1ec37074",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000400",
    "query_hash": "93186da4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2025-01-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000401",
    "query_hash": "0743c5ff",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000402",
    "query_hash": "b857be57",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000403",
    "query_hash": "90993d01",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000404",
    "query_hash": "17e55d04",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000405",
    "query_hash": "e951e148",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000406",
    "query_hash": "4c5b24ef",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000407",
    "query_hash": "790192d0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000408",
    "query_hash": "40477143",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000409",
    "query_hash": "795e0522",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000410",
    "query_hash": "5f9c362f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000411",
    "query_hash": "ec38ea7b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000412",
    "query_hash": "a24be28c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000413",
    "query_hash": "70bf623f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000414",
    "query_hash": "b33051c3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000415",
    "query_hash": "1c708de6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000416",
    "query_hash": "07bc71f5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000417",
    "query_hash": "c472ade0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000418",
    "query_hash": "f6d4a3a8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000419",
    "query_hash": "f0510fe3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000420",
    "query_hash": "cb2f2d92",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000421",
    "query_hash": "f634ba27",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000422",
    "query_hash": "e217856f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000423",
    "query_hash": "8bd25fc9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e000423"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e000423 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e000423 LIMIT 500;"
  },
  {
    "sql_id": "S000424",
    "query_hash": "9ddf61a9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000425",
    "query_hash": "4a1bf8d4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000426",
    "query_hash": "b70c3160",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000427",
    "query_hash": "f1ae797b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000428",
    "query_hash": "fa43509d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000429",
    "query_hash": "4532404f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000430",
    "query_hash": "089c80ac",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000431",
    "query_hash": "5e851502",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000432",
    "query_hash": "58276eb0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000433",
    "query_hash": "91b697c1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000434",
    "query_hash": "47a1731d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000435",
    "query_hash": "09b2072b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000436",
    "query_hash": "9cf7fd90",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000437",
    "query_hash": "c54b754a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000438",
    "query_hash": "734aa510",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000439",
    "query_hash": "5e53c701",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000440",
    "query_hash": "6908133d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000441",
    "query_hash": "0acae20b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000442",
    "query_hash": "2c29d3fe",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000443",
    "query_hash": "e71121cb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000444",
    "query_hash": "be328faa",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000445",
    "query_hash": "8a24112c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000446",
    "query_hash": "7a2d61a4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000447",
    "query_hash": "74de210e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000448",
    "query_hash": "1265452d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000449",
    "query_hash": "c5a568a8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000450",
    "query_hash": "eb7590c9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000451",
    "query_hash": "ca659f2f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000452",
    "query_hash": "ec8695b7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000453",
    "query_hash": "ee7be46d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000454",
    "query_hash": "52bd37ad",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000455",
    "query_hash": "538fc420",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e000455"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e000455 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e000455 LIMIT 500;"
  },
  {
    "sql_id": "S000456",
    "query_hash": "97848741",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e000456"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e000456 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e000456 LIMIT 500;"
  },
  {
    "sql_id": "S000457",
    "query_hash": "0bb835e2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000458",
    "query_hash": "c34133fc",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000459",
    "query_hash": "8bea8505",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000460",
    "query_hash": "dba93451",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000461",
    "query_hash": "2757f2aa",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e000461"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e000461 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e000461 LIMIT 500;"
  },
  {
    "sql_id": "S000462",
    "query_hash": "544da6c8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000463",
    "query_hash": "06c0926a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000464",
    "query_hash": "7301b1a4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000465",
    "query_hash": "c47b614a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000466",
    "query_hash": "1b02b399",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000467",
    "query_hash": "4a4b3a20",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000468",
    "query_hash": "38523307",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000469",
    "query_hash": "438644a4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000470",
    "query_hash": "368bd09f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000471",
    "query_hash": "3351e6ea",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000472",
    "query_hash": "d13eb014",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000473",
    "query_hash": "4e7923c7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e000473"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e000473 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e000473 LIMIT 500;"
  },
  {
    "sql_id": "S000474",
    "query_hash": "ca89f62a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e000474"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e000474 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e000474 LIMIT 500;"
  },
  {
    "sql_id": "S000475",
    "query_hash": "6fb28657",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000476",
    "query_hash": "a1d040e7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000477",
    "query_hash": "754de1e7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000478",
    "query_hash": "f8d6201e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000479",
    "query_hash": "6fd3c1a2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000480",
    "query_hash": "e17a4dff",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000481",
    "query_hash": "d18afade",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000482",
    "query_hash": "030b334d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000483",
    "query_hash": "a20922f6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000484",
    "query_hash": "d7e9ef02",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000485",
    "query_hash": "a901980b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000486",
    "query_hash": "2e2e57a8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000487",
    "query_hash": "c020359c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000488",
    "query_hash": "b975f4b0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000489",
    "query_hash": "bd6f47aa",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000490",
    "query_hash": "6cae2dc2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000491",
    "query_hash": "43c146b8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000492",
    "query_hash": "0e9262f1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000493",
    "query_hash": "080f2e8b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000494",
    "query_hash": "108d4e33",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000495",
    "query_hash": "c4a99691",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000496",
    "query_hash": "82113de4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000497",
    "query_hash": "5fc0f43d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000498",
    "query_hash": "11118d6a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000499",
    "query_hash": "89800c25",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000500",
    "query_hash": "cc36d34a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000501",
    "query_hash": "f0679169",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000502",
    "query_hash": "7a6e74eb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000503",
    "query_hash": "7ce4eb83",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000504",
    "query_hash": "5357f5b5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000505",
    "query_hash": "aa983c45",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000506",
    "query_hash": "2488c699",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e000506"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e000506 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e000506 LIMIT 500;"
  },
  {
    "sql_id": "S000507",
    "query_hash": "6eceee5e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000508",
    "query_hash": "76ce1ab2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000509",
    "query_hash": "0d7ccc84",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000510",
    "query_hash": "18fc61ff",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000511",
    "query_hash": "5aab16ff",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e000511"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e000511 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e000511 LIMIT 500;"
  },
  {
    "sql_id": "S000512",
    "query_hash": "010d626b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000513",
    "query_hash": "fb411f6f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000514",
    "query_hash": "64019e55",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000515",
    "query_hash": "71fd6551",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000516",
    "query_hash": "420e3776",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000517",
    "query_hash": "49d71697",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000518",
    "query_hash": "3f501911",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000519",
    "query_hash": "af49c19b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e000519"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e000519 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e000519 LIMIT 500;"
  },
  {
    "sql_id": "S000520",
    "query_hash": "469ff3a4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000521",
    "query_hash": "b0f268f4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000522",
    "query_hash": "c646699b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000523",
    "query_hash": "1843d249",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000524",
    "query_hash": "56886dfe",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000525",
    "query_hash": "7b4bcd9e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000526",
    "query_hash": "327b3687",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000527",
    "query_hash": "2d220b28",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000528",
    "query_hash": "5a34b9a1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000529",
    "query_hash": "695fe433",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000530",
    "query_hash": "882051ef",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000531",
    "query_hash": "e9bf552e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000532",
    "query_hash": "8236d754",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000533",
    "query_hash": "984b6438",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000534",
    "query_hash": "4398ffa6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000535",
    "query_hash": "ea63155e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000536",
    "query_hash": "71929b61",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000537",
    "query_hash": "6b4f1cd3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000538",
    "query_hash": "5e8069f1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000539",
    "query_hash": "f26fa052",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000540",
    "query_hash": "0cb8a146",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000541",
    "query_hash": "a33dbd81",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e000541"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e000541 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e000541 LIMIT 500;"
  },
  {
    "sql_id": "S000542",
    "query_hash": "d293e575",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000543",
    "query_hash": "49707db5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000544",
    "query_hash": "900ea2b6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000545",
    "query_hash": "be21ba48",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000546",
    "query_hash": "03249173",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000547",
    "query_hash": "80abacd8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000548",
    "query_hash": "b20b81c1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000549",
    "query_hash": "5f181c5c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000550",
    "query_hash": "0d8599a4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000551",
    "query_hash": "3ac82b3b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000552",
    "query_hash": "fba66d5c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000553",
    "query_hash": "b618085f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000554",
    "query_hash": "b6fedbe9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000555",
    "query_hash": "d9cb492e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000556",
    "query_hash": "68d4768c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000557",
    "query_hash": "81cda84d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000558",
    "query_hash": "3b6dd49f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000559",
    "query_hash": "0df38f40",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000560",
    "query_hash": "5c49ac78",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000561",
    "query_hash": "e67a9de3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000562",
    "query_hash": "c29a6356",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000563",
    "query_hash": "a726971d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000564",
    "query_hash": "78d157a3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000565",
    "query_hash": "257b521a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000566",
    "query_hash": "b8a65018",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000567",
    "query_hash": "0ac87636",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000568",
    "query_hash": "dab9f685",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000569",
    "query_hash": "ee79d90e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000570",
    "query_hash": "22d7d60f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e000570"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e000570 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e000570 LIMIT 500;"
  },
  {
    "sql_id": "S000571",
    "query_hash": "5396aa9f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000572",
    "query_hash": "188753c6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000573",
    "query_hash": "3d70c29a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000574",
    "query_hash": "819b675e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000575",
    "query_hash": "d144ea9d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000576",
    "query_hash": "582915e1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000577",
    "query_hash": "5ad19886",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000578",
    "query_hash": "fc2b92f8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000579",
    "query_hash": "5ac53339",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000580",
    "query_hash": "5252243a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2025-01-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000581",
    "query_hash": "9b4bbf60",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-01 00:00:00' AND event_ts <  TIMESTAMP '2024-01-04 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000582",
    "query_hash": "e787b7a8",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-03 00:00:00' AND event_ts <  TIMESTAMP '2024-01-10 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000583",
    "query_hash": "a6388ea0",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-01 00:00:00' AND event_ts <  TIMESTAMP '2024-01-11 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000584",
    "query_hash": "3b4b806c",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-05 00:00:00' AND event_ts <  TIMESTAMP '2024-01-12 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000585",
    "query_hash": "27a775be",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-17 00:00:00' AND event_ts <  TIMESTAMP '2024-01-24 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000586",
    "query_hash": "ad8498f6",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-19 00:00:00' AND event_ts <  TIMESTAMP '2024-01-26 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000587",
    "query_hash": "2c9bea68",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-30 00:00:00' AND event_ts <  TIMESTAMP '2024-02-06 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000588",
    "query_hash": "f78ceb02",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-09 00:00:00' AND event_ts <  TIMESTAMP '2024-02-08 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000589",
    "query_hash": "60580abc",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-08 00:00:00' AND event_ts <  TIMESTAMP '2024-02-15 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000590",
    "query_hash": "a29c5d77",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-01 00:00:00' AND event_ts <  TIMESTAMP '2024-02-20 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000591",
    "query_hash": "199ae1b5",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-01 00:00:00' AND event_ts <  TIMESTAMP '2024-02-21 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000592",
    "query_hash": "030c9f2d",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-15 00:00:00' AND event_ts <  TIMESTAMP '2024-02-22 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000593",
    "query_hash": "58d74b4f",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-21 00:00:00' AND event_ts <  TIMESTAMP '2024-02-28 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000594",
    "query_hash": "836b313b",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-22 00:00:00' AND event_ts <  TIMESTAMP '2024-02-29 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000595",
    "query_hash": "84b1cb39",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-04 00:00:00' AND event_ts <  TIMESTAMP '2024-03-05 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000596",
    "query_hash": "a981775f",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-03-01 00:00:00' AND event_ts <  TIMESTAMP '2024-03-06 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000597",
    "query_hash": "a9b06882",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-06 00:00:00' AND event_ts <  TIMESTAMP '2024-03-07 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000598",
    "query_hash": "d2be966f",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-11 00:00:00' AND event_ts <  TIMESTAMP '2024-03-12 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000599",
    "query_hash": "3b983f29",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-03-01 00:00:00' AND event_ts <  TIMESTAMP '2024-03-13 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000600",
    "query_hash": "69334557",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-14 00:00:00' AND event_ts <  TIMESTAMP '2024-03-15 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000601",
    "query_hash": "f39982bd",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-15 00:00:00' AND event_ts <  TIMESTAMP '2024-03-16 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000602",
    "query_hash": "192f7ffd",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-03-12 00:00:00' AND event_ts <  TIMESTAMP '2024-03-19 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000603",
    "query_hash": "81816f87",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-03-14 00:00:00' AND event_ts <  TIMESTAMP '2024-03-21 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000604",
    "query_hash": "d55f1bea",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-22 00:00:00' AND event_ts <  TIMESTAMP '2024-03-23 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000605",
    "query_hash": "89821c2e",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-03-01 00:00:00' AND event_ts <  TIMESTAMP '2024-03-27 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000606",
    "query_hash": "09d2d041",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-27 00:00:00' AND event_ts <  TIMESTAMP '2024-03-28 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000607",
    "query_hash": "2aeb86db",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-03-26 00:00:00' AND event_ts <  TIMESTAMP '2024-04-02 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000608",
    "query_hash": "b3505cc5",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-03-29 00:00:00' AND event_ts <  TIMESTAMP '2024-04-05 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000609",
    "query_hash": "234b7341",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-03 00:00:00' AND event_ts <  TIMESTAMP '2024-04-10 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000610",
    "query_hash": "fddea3bb",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-04 00:00:00' AND event_ts <  TIMESTAMP '2024-04-11 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000611",
    "query_hash": "8810002f",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-09 00:00:00' AND event_ts <  TIMESTAMP '2024-04-16 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000612",
    "query_hash": "131c5f10",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-11 00:00:00' AND event_ts <  TIMESTAMP '2024-04-18 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000613",
    "query_hash": "0a89c4a6",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-17 00:00:00' AND event_ts <  TIMESTAMP '2024-04-24 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000614",
    "query_hash": "91e43b39",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-19 00:00:00' AND event_ts <  TIMESTAMP '2024-04-26 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000615",
    "query_hash": "69a9d5fd",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000615"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000615 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-03-29 00:00:00' AND event_ts <  TIMESTAMP '2024-04-28 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000615 LIMIT 500;"
  },
  {
    "sql_id": "S000616",
    "query_hash": "2d904459",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-07 00:00:00' AND event_ts <  TIMESTAMP '2024-05-07 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000617",
    "query_hash": "5c2b5fc0",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-05-07 00:00:00' AND event_ts <  TIMESTAMP '2024-05-14 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000618",
    "query_hash": "523d101c",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000618"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000618 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-15 00:00:00' AND event_ts <  TIMESTAMP '2024-05-15 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000618 LIMIT 500;"
  },
  {
    "sql_id": "S000619",
    "query_hash": "e34694be",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-16 00:00:00' AND event_ts <  TIMESTAMP '2024-05-16 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000620",
    "query_hash": "a25ff8ec",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000620"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000620 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-05-13 00:00:00' AND event_ts <  TIMESTAMP '2024-05-20 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000620 LIMIT 500;"
  },
  {
    "sql_id": "S000621",
    "query_hash": "375e3205",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-05-29 00:00:00' AND event_ts <  TIMESTAMP '2024-06-05 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000622",
    "query_hash": "a590bd64",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-05-31 00:00:00' AND event_ts <  TIMESTAMP '2024-06-07 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000623",
    "query_hash": "2ce7a19c",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000623"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000623 AS\n        -- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-01 00:00:00' AND event_ts <  TIMESTAMP '2024-06-08 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000623 LIMIT 500;"
  },
  {
    "sql_id": "S000624",
    "query_hash": "8836f83c",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000624"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000624 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-04 00:00:00' AND event_ts <  TIMESTAMP '2024-06-11 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000624 LIMIT 500;"
  },
  {
    "sql_id": "S000625",
    "query_hash": "b977c5a6",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-01 00:00:00' AND event_ts <  TIMESTAMP '2024-06-13 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000626",
    "query_hash": "9b220e4b",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-13 00:00:00' AND event_ts <  TIMESTAMP '2024-06-20 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000627",
    "query_hash": "abd681b9",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-05-27 00:00:00' AND event_ts <  TIMESTAMP '2024-06-26 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000628",
    "query_hash": "0b184504",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-20 00:00:00' AND event_ts <  TIMESTAMP '2024-06-27 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000629",
    "query_hash": "0edb12ad",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-05-30 00:00:00' AND event_ts <  TIMESTAMP '2024-06-29 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000630",
    "query_hash": "323da99f",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-02 00:00:00' AND event_ts <  TIMESTAMP '2024-07-02 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000631",
    "query_hash": "5fe36108",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-03 00:00:00' AND event_ts <  TIMESTAMP '2024-07-03 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000632",
    "query_hash": "a19833be",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-27 00:00:00' AND event_ts <  TIMESTAMP '2024-07-04 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000633",
    "query_hash": "360fb4cd",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-04 00:00:00' AND event_ts <  TIMESTAMP '2024-07-11 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000634",
    "query_hash": "f81ea3e0",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000634"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000634 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-12 00:00:00' AND event_ts <  TIMESTAMP '2024-07-12 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000634 LIMIT 500;"
  },
  {
    "sql_id": "S000635",
    "query_hash": "135f8a4d",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000635"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000635 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-06 00:00:00' AND event_ts <  TIMESTAMP '2024-07-13 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000635 LIMIT 500;"
  },
  {
    "sql_id": "S000636",
    "query_hash": "e00e3232",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-10 00:00:00' AND event_ts <  TIMESTAMP '2024-07-17 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000637",
    "query_hash": "8e9f8d26",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-11 00:00:00' AND event_ts <  TIMESTAMP '2024-07-18 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000638",
    "query_hash": "59892053",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000638"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000638 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-12 00:00:00' AND event_ts <  TIMESTAMP '2024-07-19 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000638 LIMIT 500;"
  },
  {
    "sql_id": "S000639",
    "query_hash": "5d9ea2cb",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-17 00:00:00' AND event_ts <  TIMESTAMP '2024-07-24 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000640",
    "query_hash": "87730bbb",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-25 00:00:00' AND event_ts <  TIMESTAMP '2024-07-25 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000641",
    "query_hash": "e8b5171d",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-26 00:00:00' AND event_ts <  TIMESTAMP '2024-07-26 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000642",
    "query_hash": "579b2c08",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-27 00:00:00' AND event_ts <  TIMESTAMP '2024-07-27 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000643",
    "query_hash": "6b4b1af1",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-23 00:00:00' AND event_ts <  TIMESTAMP '2024-07-30 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000644",
    "query_hash": "32c8e370",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-24 00:00:00' AND event_ts <  TIMESTAMP '2024-07-31 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000645",
    "query_hash": "75b5b288",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000645"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000645 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-30 00:00:00' AND event_ts <  TIMESTAMP '2024-08-06 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000645 LIMIT 500;"
  },
  {
    "sql_id": "S000646",
    "query_hash": "90f5526b",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-31 00:00:00' AND event_ts <  TIMESTAMP '2024-08-07 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000647",
    "query_hash": "17a60743",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-10 00:00:00' AND event_ts <  TIMESTAMP '2024-08-09 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000648",
    "query_hash": "d365657b",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-20 00:00:00' AND event_ts <  TIMESTAMP '2024-08-19 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000649",
    "query_hash": "e63edeba",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-01 00:00:00' AND event_ts <  TIMESTAMP '2024-08-20 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000650",
    "query_hash": "95df3d11",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-01 00:00:00' AND event_ts <  TIMESTAMP '2024-08-24 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000651",
    "query_hash": "9f2473aa",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-21 00:00:00' AND event_ts <  TIMESTAMP '2024-08-28 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000652",
    "query_hash": "1c0ec698",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-22 00:00:00' AND event_ts <  TIMESTAMP '2024-08-29 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000653",
    "query_hash": "8159b781",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-01 00:00:00' AND event_ts <  TIMESTAMP '2024-08-30 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000654",
    "query_hash": "0594ec1e",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-27 00:00:00' AND event_ts <  TIMESTAMP '2024-09-03 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000655",
    "query_hash": "6b992797",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-29 00:00:00' AND event_ts <  TIMESTAMP '2024-09-05 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000656",
    "query_hash": "50f683f3",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-07 00:00:00' AND event_ts <  TIMESTAMP '2024-09-06 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000657",
    "query_hash": "586cdae6",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000657"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000657 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-31 00:00:00' AND event_ts <  TIMESTAMP '2024-09-07 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000657 LIMIT 500;"
  },
  {
    "sql_id": "S000658",
    "query_hash": "428a0029",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-04 00:00:00' AND event_ts <  TIMESTAMP '2024-09-11 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000659",
    "query_hash": "1cacfb34",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-01 00:00:00' AND event_ts <  TIMESTAMP '2024-09-12 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000660",
    "query_hash": "354f5ce2",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-10 00:00:00' AND event_ts <  TIMESTAMP '2024-09-17 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000661",
    "query_hash": "411ac15a",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-14 00:00:00' AND event_ts <  TIMESTAMP '2024-09-21 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000662",
    "query_hash": "5d161140",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-18 00:00:00' AND event_ts <  TIMESTAMP '2024-09-25 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000663",
    "query_hash": "49a4a6a5",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-27 00:00:00' AND event_ts <  TIMESTAMP '2024-09-26 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000664",
    "query_hash": "afa72417",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-01 00:00:00' AND event_ts <  TIMESTAMP '2024-09-27 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000665",
    "query_hash": "617aabc2",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-01 00:00:00' AND event_ts <  TIMESTAMP '2024-10-01 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000666",
    "query_hash": "0caaeceb",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-27 00:00:00' AND event_ts <  TIMESTAMP '2024-10-04 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000667",
    "query_hash": "efb05061",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-05 00:00:00' AND event_ts <  TIMESTAMP '2024-10-05 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000668",
    "query_hash": "c72ea6f5",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-01 00:00:00' AND event_ts <  TIMESTAMP '2024-10-09 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000669",
    "query_hash": "eb00cde9",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-10 00:00:00' AND event_ts <  TIMESTAMP '2024-10-10 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000670",
    "query_hash": "54c73df7",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-04 00:00:00' AND event_ts <  TIMESTAMP '2024-10-11 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000671",
    "query_hash": "b8a4173a",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-11 00:00:00' AND event_ts <  TIMESTAMP '2024-10-18 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000672",
    "query_hash": "b19c5140",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-12 00:00:00' AND event_ts <  TIMESTAMP '2024-10-19 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000673",
    "query_hash": "eff63ead",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-20 00:00:00' AND event_ts <  TIMESTAMP '2024-10-20 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000674",
    "query_hash": "32a669dd",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-22 00:00:00' AND event_ts <  TIMESTAMP '2024-10-22 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000675",
    "query_hash": "e7a3f2d8",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-16 00:00:00' AND event_ts <  TIMESTAMP '2024-10-23 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000676",
    "query_hash": "72fe3a42",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-17 00:00:00' AND event_ts <  TIMESTAMP '2024-10-24 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000677",
    "query_hash": "21635a26",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-30 00:00:00' AND event_ts <  TIMESTAMP '2024-10-30 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000678",
    "query_hash": "6374a091",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-24 00:00:00' AND event_ts <  TIMESTAMP '2024-10-31 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000679",
    "query_hash": "c9e73043",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-25 00:00:00' AND event_ts <  TIMESTAMP '2024-11-01 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000680",
    "query_hash": "392a0a81",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-03 00:00:00' AND event_ts <  TIMESTAMP '2024-11-02 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000681",
    "query_hash": "4363fe91",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-04 00:00:00' AND event_ts <  TIMESTAMP '2024-11-03 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000682",
    "query_hash": "ebf4bbbc",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-29 00:00:00' AND event_ts <  TIMESTAMP '2024-11-05 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000683",
    "query_hash": "3226ee67",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-07 00:00:00' AND event_ts <  TIMESTAMP '2024-11-06 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000684",
    "query_hash": "51467623",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-01 00:00:00' AND event_ts <  TIMESTAMP '2024-11-08 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000685",
    "query_hash": "974c2191",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-10 00:00:00' AND event_ts <  TIMESTAMP '2024-11-09 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000686",
    "query_hash": "fb4e591e",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-01 00:00:00' AND event_ts <  TIMESTAMP '2024-11-15 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000687",
    "query_hash": "10e54dcd",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000687"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000687 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-09 00:00:00' AND event_ts <  TIMESTAMP '2024-11-16 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000687 LIMIT 500;"
  },
  {
    "sql_id": "S000688",
    "query_hash": "85c8b949",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-21 00:00:00' AND event_ts <  TIMESTAMP '2024-11-20 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000689",
    "query_hash": "b2295eb5",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-14 00:00:00' AND event_ts <  TIMESTAMP '2024-11-21 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000690",
    "query_hash": "ce34fed5",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-01 00:00:00' AND event_ts <  TIMESTAMP '2024-11-23 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000691",
    "query_hash": "1f2416e7",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-01 00:00:00' AND event_ts <  TIMESTAMP '2024-11-25 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000692",
    "query_hash": "e45c6397",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-29 00:00:00' AND event_ts <  TIMESTAMP '2024-11-28 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000693",
    "query_hash": "5434167a",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-03 00:00:00' AND event_ts <  TIMESTAMP '2024-12-03 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000694",
    "query_hash": "c0493549",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-29 00:00:00' AND event_ts <  TIMESTAMP '2024-12-06 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000695",
    "query_hash": "142a75b4",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-30 00:00:00' AND event_ts <  TIMESTAMP '2024-12-07 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000696",
    "query_hash": "55b4e615",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-12 00:00:00' AND event_ts <  TIMESTAMP '2024-12-12 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000697",
    "query_hash": "9d6e8c8c",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-12-07 00:00:00' AND event_ts <  TIMESTAMP '2024-12-14 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000698",
    "query_hash": "091e727e",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-12-01 00:00:00' AND event_ts <  TIMESTAMP '2024-12-19 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000699",
    "query_hash": "21f1929a",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-20 00:00:00' AND event_ts <  TIMESTAMP '2024-12-20 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000700",
    "query_hash": "f8dc56f4",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-24 00:00:00' AND event_ts <  TIMESTAMP '2024-12-24 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000701",
    "query_hash": "820a1f74",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-01-02 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000702",
    "query_hash": "cda1f947",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-01-09 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-01-16 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000703",
    "query_hash": "ae960d18",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-01-23 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-01-30 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000704",
    "query_hash": "9e2fa2c7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-02-06 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000705",
    "query_hash": "aae46721",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-02-06 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-02-13 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000706",
    "query_hash": "24170f99",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-02-13 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-02-20 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000707",
    "query_hash": "c7c6110d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-02-20 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-02-27 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000708",
    "query_hash": "84ffed08",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-03-05 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000709",
    "query_hash": "5716e329",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-02-27 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-03-12 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000710",
    "query_hash": "b9a26d4b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-03-19 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000711",
    "query_hash": "73a452f2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-04-16 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-04-23 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000712",
    "query_hash": "6a25cdb9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-04-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-04-30 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000713",
    "query_hash": "dec4b334",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-04-30 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-05-14 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000714",
    "query_hash": "a5973f07",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-04-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-05-21 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000715",
    "query_hash": "27ecbe5f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-05-21 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-05-28 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000716",
    "query_hash": "7e4e083c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-05-28 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-04 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000717",
    "query_hash": "94eed872",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-06-04 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-18 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000718",
    "query_hash": "1e5eb73c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-06-11 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-25 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000719",
    "query_hash": "3f85cad9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-06-25 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-07-02 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000720",
    "query_hash": "0fde3e63",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-09 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-07-16 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000721",
    "query_hash": "74cf7603",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-09 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-07-23 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000722",
    "query_hash": "4f760db1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-07-30 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000723",
    "query_hash": "0072b545",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-30 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-08-06 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000724",
    "query_hash": "034379f6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-30 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-08-13 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000725",
    "query_hash": "c0eb548d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "tmp_e000725"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000725 AS\n        SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-08-06 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-08-20 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;\n        SELECT * FROM tmp_e000725 LIMIT 500;"
  },
  {
    "sql_id": "S000726",
    "query_hash": "69485106",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-08-27 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-09-03 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000727",
    "query_hash": "4e7e9cb8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-09-17 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-09-24 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000728",
    "query_hash": "42e77402",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-10-08 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-10-22 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000729",
    "query_hash": "10502009",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-10-22 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-10-29 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000730",
    "query_hash": "89ee7ad3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-05 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-12 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000731",
    "query_hash": "cf673929",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-10-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-19 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000732",
    "query_hash": "c891121c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-10-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-26 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000733",
    "query_hash": "a8ea7c9c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-26 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-10 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000734",
    "query_hash": "5f25ad47",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-12-03 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-17 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000735",
    "query_hash": "3598ecd9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-12-17 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-24 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000736",
    "query_hash": "8e7ae578",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-02 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-01-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-01-02 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000737",
    "query_hash": "84f58f31",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-09 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-01-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-01-09 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000738",
    "query_hash": "140fc6f4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-09 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-23 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-01-09 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-01-23 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000739",
    "query_hash": "41a9fa88",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-23 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-30 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-01-23 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-01-30 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000740",
    "query_hash": "249ef236",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-30 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-02-06 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-01-30 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-02-06 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000741",
    "query_hash": "8dbba11a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-30 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-02-13 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-01-30 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-02-13 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000742",
    "query_hash": "2f1ed22c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-02-20 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-02-27 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-02-20 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-02-27 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000743",
    "query_hash": "a320b8c0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders",
      "tmp_e000743"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000743 AS\n        -- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-02-27 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-05 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-02-27 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-03-05 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;\n        SELECT * FROM tmp_e000743 LIMIT 500;"
  },
  {
    "sql_id": "S000744",
    "query_hash": "8a8e1d40",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-12 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-01-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-03-12 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000745",
    "query_hash": "aeb5ab04",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-05 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-03-05 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-03-19 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000746",
    "query_hash": "fd33fd9e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders",
      "tmp_e000746"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000746 AS\n        WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-19 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-26 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-03-19 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-03-26 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;\n        SELECT * FROM tmp_e000746 LIMIT 500;"
  },
  {
    "sql_id": "S000747",
    "query_hash": "126f2610",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-04-16 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-04-23 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-04-16 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-04-23 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000748",
    "query_hash": "80fed755",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-04-30 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-05-07 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-04-30 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-05-07 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000749",
    "query_hash": "ef29b50b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-04-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-05-14 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-04-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-05-14 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000750",
    "query_hash": "7665829e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-05-21 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-05-28 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-05-21 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-05-28 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000751",
    "query_hash": "24602d46",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-05-28 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-04 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-05-28 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-06-04 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000752",
    "query_hash": "52444373",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders",
      "tmp_e000752"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000752 AS\n        WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-06-25 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-02 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-06-25 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-07-02 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;\n        SELECT * FROM tmp_e000752 LIMIT 500;"
  },
  {
    "sql_id": "S000753",
    "query_hash": "b90cf912",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-09 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-16 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-07-09 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-07-16 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000754",
    "query_hash": "0c1363f4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-06 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-08-13 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-08-06 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-08-13 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000755",
    "query_hash": "bb6cd90b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-06 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-08-20 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-08-06 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-08-20 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000756",
    "query_hash": "7244185e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-13 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-08-27 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-08-13 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-08-27 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000757",
    "query_hash": "cd73e8a1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-10 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-07-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-10 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000758",
    "query_hash": "7ff13193",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-03 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-17 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-09-03 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-17 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000759",
    "query_hash": "cc32374c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-24 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-09-24 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-10-01 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000760",
    "query_hash": "4df8380e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-08 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-10-08 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000761",
    "query_hash": "4a48aff5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-08 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-15 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-08 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-10-15 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000762",
    "query_hash": "74c0710c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-22 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-10-22 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000763",
    "query_hash": "1c107e15",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-29 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-10-29 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000764",
    "query_hash": "fc0f56c6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-29 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-05 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-29 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-05 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000765",
    "query_hash": "07f915d7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders",
      "tmp_e000765"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000765 AS\n        WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-05 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-12 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-11-05 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-12 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;\n        SELECT * FROM tmp_e000765 LIMIT 500;"
  },
  {
    "sql_id": "S000766",
    "query_hash": "9ab6b013",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders",
      "tmp_e000766"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000766 AS\n        -- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-12 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-11-12 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-19 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;\n        SELECT * FROM tmp_e000766 LIMIT 500;"
  },
  {
    "sql_id": "S000767",
    "query_hash": "1058bc79",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-19 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-26 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-11-19 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-26 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000768",
    "query_hash": "bbbd6b26",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-26 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-03 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-11-26 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-12-03 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000769",
    "query_hash": "3a996ae3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-12-03 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-17 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-12-03 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-12-17 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000770",
    "query_hash": "12bf6371",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-12-24 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-31 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-12-24 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-12-31 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000771",
    "query_hash": "3a7badbf",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-01-01 00:00:00' AND created_ts <  TIMESTAMP '2024-01-09 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000772",
    "query_hash": "04cbb20c",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-01-16 00:00:00' AND created_ts <  TIMESTAMP '2024-01-23 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000773",
    "query_hash": "3e5b5c86",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-01-16 00:00:00' AND created_ts <  TIMESTAMP '2024-01-30 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000774",
    "query_hash": "4afc8e3a",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-01-30 00:00:00' AND created_ts <  TIMESTAMP '2024-02-06 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000775",
    "query_hash": "28f32964",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-01-30 00:00:00' AND created_ts <  TIMESTAMP '2024-02-13 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000776",
    "query_hash": "6fd3633a",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-02-13 00:00:00' AND created_ts <  TIMESTAMP '2024-02-20 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000777",
    "query_hash": "2e47dfbb",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-02-13 00:00:00' AND created_ts <  TIMESTAMP '2024-02-27 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000778",
    "query_hash": "29fd772d",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-01-01 00:00:00' AND created_ts <  TIMESTAMP '2024-03-05 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000779",
    "query_hash": "1b4a968d",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets",
      "tmp_e000779"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000779 AS\n        WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-02-27 00:00:00' AND created_ts <  TIMESTAMP '2024-03-12 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;\n        SELECT * FROM tmp_e000779 LIMIT 500;"
  },
  {
    "sql_id": "S000780",
    "query_hash": "d4e36922",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-03-26 00:00:00' AND created_ts <  TIMESTAMP '2024-04-02 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000781",
    "query_hash": "868dac9a",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-03-26 00:00:00' AND created_ts <  TIMESTAMP '2024-04-09 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000782",
    "query_hash": "418d0ccc",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-04-09 00:00:00' AND created_ts <  TIMESTAMP '2024-04-23 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000783",
    "query_hash": "662022ec",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-04-23 00:00:00' AND created_ts <  TIMESTAMP '2024-04-30 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000784",
    "query_hash": "90a819f6",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-04-30 00:00:00' AND created_ts <  TIMESTAMP '2024-05-07 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000785",
    "query_hash": "ffb9bf0a",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-05-14 00:00:00' AND created_ts <  TIMESTAMP '2024-05-21 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000786",
    "query_hash": "fc721d2c",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-05-21 00:00:00' AND created_ts <  TIMESTAMP '2024-05-28 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000787",
    "query_hash": "99d85e15",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-07-09 00:00:00' AND created_ts <  TIMESTAMP '2024-07-16 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000788",
    "query_hash": "ac048cef",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-07-09 00:00:00' AND created_ts <  TIMESTAMP '2024-07-23 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000789",
    "query_hash": "5e057646",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-07-30 00:00:00' AND created_ts <  TIMESTAMP '2024-08-06 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000790",
    "query_hash": "5938760c",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-08-06 00:00:00' AND created_ts <  TIMESTAMP '2024-08-13 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000791",
    "query_hash": "b9666362",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-07-01 00:00:00' AND created_ts <  TIMESTAMP '2024-08-20 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000792",
    "query_hash": "049ee0c4",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets",
      "tmp_e000792"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000792 AS\n        WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-08-20 00:00:00' AND created_ts <  TIMESTAMP '2024-08-27 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;\n        SELECT * FROM tmp_e000792 LIMIT 500;"
  },
  {
    "sql_id": "S000793",
    "query_hash": "dc31ba40",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-09-10 00:00:00' AND created_ts <  TIMESTAMP '2024-09-24 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000794",
    "query_hash": "2242b053",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-09-24 00:00:00' AND created_ts <  TIMESTAMP '2024-10-01 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000795",
    "query_hash": "c98319da",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-10-01 00:00:00' AND created_ts <  TIMESTAMP '2024-10-08 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000796",
    "query_hash": "2e7fea2f",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-10-08 00:00:00' AND created_ts <  TIMESTAMP '2024-10-15 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000797",
    "query_hash": "15bb287a",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-10-15 00:00:00' AND created_ts <  TIMESTAMP '2024-10-22 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000798",
    "query_hash": "3a4b17d2",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-10-15 00:00:00' AND created_ts <  TIMESTAMP '2024-10-29 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000799",
    "query_hash": "23fa9721",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-10-29 00:00:00' AND created_ts <  TIMESTAMP '2024-11-05 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000800",
    "query_hash": "aa0f4a2d",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-11-12 00:00:00' AND created_ts <  TIMESTAMP '2024-11-19 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000801",
    "query_hash": "f8cc058a",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-10-01 00:00:00' AND created_ts <  TIMESTAMP '2024-11-26 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000802",
    "query_hash": "69ae4daf",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets",
      "tmp_e000802"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000802 AS\n        WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-11-26 00:00:00' AND created_ts <  TIMESTAMP '2024-12-03 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;\n        SELECT * FROM tmp_e000802 LIMIT 500;"
  },
  {
    "sql_id": "S000803",
    "query_hash": "3e41257c",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-12-10 00:00:00' AND created_ts <  TIMESTAMP '2024-12-17 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000804",
    "query_hash": "cef58858",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-12-17 00:00:00' AND created_ts <  TIMESTAMP '2024-12-24 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000805",
    "query_hash": "4a178af7",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-12-24 00:00:00' AND created_ts <  TIMESTAMP '2024-12-31 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000806",
    "query_hash": "4f394e4b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-02 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000807",
    "query_hash": "11dd7ebb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-02 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-16 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000808",
    "query_hash": "43f2526b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches",
      "tmp_e000808"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000808 AS\n        WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-16 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-23 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;\n        SELECT * FROM tmp_e000808 LIMIT 500;"
  },
  {
    "sql_id": "S000809",
    "query_hash": "3af6ecad",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-23 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-30 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000810",
    "query_hash": "772abe5e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-02-13 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000811",
    "query_hash": "9013c4e3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-02-13 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-02-20 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000812",
    "query_hash": "82222b16",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-05 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-12 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000813",
    "query_hash": "d7d37815",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-12 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000814",
    "query_hash": "4f439c02",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-19 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-26 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000815",
    "query_hash": "c3d1e6a2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-26 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-04-09 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000816",
    "query_hash": "5ebbaac5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-04-16 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-04-30 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000817",
    "query_hash": "36fe15f2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-04-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-05-14 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000818",
    "query_hash": "6738b2ba",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-05-07 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-05-21 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000819",
    "query_hash": "c2ce3abb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-05-28 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-04 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000820",
    "query_hash": "bf5e46cc",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-06-11 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-18 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000821",
    "query_hash": "3e31a7e0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches",
      "tmp_e000821"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000821 AS\n        WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-04-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-25 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY attributed_net_revenue DESC;\n        SELECT * FROM tmp_e000821 LIMIT 500;"
  },
  {
    "sql_id": "S000822",
    "query_hash": "35119a34",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-06-25 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-02 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000823",
    "query_hash": "14a96d61",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-02 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-16 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000824",
    "query_hash": "d02ec726",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-16 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-23 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000825",
    "query_hash": "3a6b2b55",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-30 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000826",
    "query_hash": "5e3a3b3d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-13 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-08-20 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000827",
    "query_hash": "5a5e5c39",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-13 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-08-27 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000828",
    "query_hash": "3da92245",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-27 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-03 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000829",
    "query_hash": "826d0fff",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-27 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-10 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000830",
    "query_hash": "f41d5755",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches",
      "tmp_e000830"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000830 AS\n        WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-10 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-17 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;\n        SELECT * FROM tmp_e000830 LIMIT 500;"
  },
  {
    "sql_id": "S000831",
    "query_hash": "3e8dc423",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches",
      "tmp_e000831"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000831 AS\n        WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-17 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-24 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;\n        SELECT * FROM tmp_e000831 LIMIT 500;"
  },
  {
    "sql_id": "S000832",
    "query_hash": "cf566b47",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-24 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000833",
    "query_hash": "dcabc7c6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-08 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-15 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000834",
    "query_hash": "09a8a175",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-15 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-22 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000835",
    "query_hash": "29ee7293",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches",
      "tmp_e000835"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000835 AS\n        WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-22 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-29 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;\n        SELECT * FROM tmp_e000835 LIMIT 500;"
  },
  {
    "sql_id": "S000836",
    "query_hash": "80e3a284",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-29 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-05 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000837",
    "query_hash": "1a8ee7ff",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-19 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-26 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000838",
    "query_hash": "7c801483",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-26 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-03 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000839",
    "query_hash": "adf6ab86",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches",
      "tmp_e000839"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000839 AS\n        WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-10 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;\n        SELECT * FROM tmp_e000839 LIMIT 500;"
  },
  {
    "sql_id": "S000840",
    "query_hash": "4c64f7ff",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches",
      "tmp_e000840"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000840 AS\n        WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-12-17 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-24 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;\n        SELECT * FROM tmp_e000840 LIMIT 500;"
  },
  {
    "sql_id": "S000841",
    "query_hash": "d73f28de",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-02-01 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-02-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-02-01 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-02-01 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-02-01 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-02-01 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY customers DESC;"
  },
  {
    "sql_id": "S000842",
    "query_hash": "696e1e26",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-03-01 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-03-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-03-01 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-03-01 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-03-01 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-03-01 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S000843",
    "query_hash": "b0cee95d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-04-01 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-04-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-04-01 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-04-01 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-04-01 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-04-01 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY customers DESC;"
  },
  {
    "sql_id": "S000844",
    "query_hash": "bceff6de",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-05-01 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-05-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-05-01 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-05-01 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-05-01 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-05-01 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S000845",
    "query_hash": "a91fdb50",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-07-01 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-07-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-07-01 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-07-01 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-07-01 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-07-01 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S000846",
    "query_hash": "63da7903",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-08-01 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-08-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-08-01 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-08-01 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-08-01 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-08-01 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S000847",
    "query_hash": "f265e348",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-09-01 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-09-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-09-01 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-09-01 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-09-01 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-09-01 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S000848",
    "query_hash": "08cc5340",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-10-01 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-10-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-10-01 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-10-01 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-10-01 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-10-01 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S000849",
    "query_hash": "8672c841",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-11-01 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-11-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-11-01 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-11-01 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-11-01 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-11-01 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S000850",
    "query_hash": "02bda59c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2025-01-01 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2025-01-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2025-01-01 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2025-01-01 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2025-01-01 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2025-01-01 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S000851",
    "query_hash": "5bd57212",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 2,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-01-01 00:00:00' AND created_ts <  TIMESTAMP '2024-02-01 00:00:00' AND stage = 'WON'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S000852",
    "query_hash": "6fde2f06",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-02-01 00:00:00' AND created_ts <  TIMESTAMP '2024-03-01 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S000853",
    "query_hash": "849cc90e",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-04-01 00:00:00' AND created_ts <  TIMESTAMP '2024-05-01 00:00:00' AND stage = 'PROPOSAL'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S000854",
    "query_hash": "7acd4ee1",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals",
      "tmp_e000854"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "CREATE TEMP TABLE tmp_e000854 AS\n        SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-05-01 00:00:00' AND created_ts <  TIMESTAMP '2024-06-01 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    ORDER BY month, stage;\n        SELECT * FROM tmp_e000854 LIMIT 500;"
  },
  {
    "sql_id": "S000855",
    "query_hash": "1d338479",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-06-01 00:00:00' AND created_ts <  TIMESTAMP '2024-07-01 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S000856",
    "query_hash": "1e836f5f",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-07-01 00:00:00' AND created_ts <  TIMESTAMP '2024-08-01 00:00:00' AND stage = 'PROPOSAL'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S000857",
    "query_hash": "357d54fd",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-08-01 00:00:00' AND created_ts <  TIMESTAMP '2024-09-01 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S000858",
    "query_hash": "74b5cab6",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-09-01 00:00:00' AND created_ts <  TIMESTAMP '2024-10-01 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S000859",
    "query_hash": "dce4bd60",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 2,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-10-01 00:00:00' AND created_ts <  TIMESTAMP '2024-11-01 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S000860",
    "query_hash": "6d3793f7",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-12-01 00:00:00' AND created_ts <  TIMESTAMP '2025-01-01 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S000861",
    "query_hash": "8b1a3467",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-01-01 00:00:00' AND created_ts <  TIMESTAMP '2024-02-01 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000862",
    "query_hash": "ccaf81c0",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-03-01 00:00:00' AND created_ts <  TIMESTAMP '2024-04-01 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000863",
    "query_hash": "b90eab04",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-04-01 00:00:00' AND created_ts <  TIMESTAMP '2024-05-01 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000864",
    "query_hash": "45791276",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-05-01 00:00:00' AND created_ts <  TIMESTAMP '2024-06-01 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000865",
    "query_hash": "e544852c",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-06-01 00:00:00' AND created_ts <  TIMESTAMP '2024-07-01 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000866",
    "query_hash": "d75f8777",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-08-01 00:00:00' AND created_ts <  TIMESTAMP '2024-09-01 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000867",
    "query_hash": "70338e5b",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-09-01 00:00:00' AND created_ts <  TIMESTAMP '2024-10-01 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000868",
    "query_hash": "6a79e386",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-10-01 00:00:00' AND created_ts <  TIMESTAMP '2024-11-01 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000869",
    "query_hash": "0f5b09f1",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-11-01 00:00:00' AND created_ts <  TIMESTAMP '2024-12-01 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000870",
    "query_hash": "4498336b",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-12-01 00:00:00' AND created_ts <  TIMESTAMP '2025-01-01 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000871",
    "query_hash": "a9ec33d5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-02-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-01-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-02-01 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000872",
    "query_hash": "0f9a58fd",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-02-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-02-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-03-01 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000873",
    "query_hash": "d571b2e3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-04-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-03-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-04-01 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000874",
    "query_hash": "3b0ae32a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-04-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-05-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-04-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-05-01 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000875",
    "query_hash": "1d361eea",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-08-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-07-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-08-01 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000876",
    "query_hash": "9a0bdba4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-08-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-01 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000877",
    "query_hash": "7aa0bb43",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-09-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-10-01 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000878",
    "query_hash": "ccbba957",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-01 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000879",
    "query_hash": "cfd0fded",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-11-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-12-01 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000880",
    "query_hash": "f33587c6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-12-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2025-01-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-12-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2025-01-01 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000881",
    "query_hash": "c501815c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-09-03 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-09-17 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000882",
    "query_hash": "d7d0edf6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-09-09 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-09-17 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000883",
    "query_hash": "8ba8c440",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-09-17 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000884",
    "query_hash": "a09b8153",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-09-13 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-09-17 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000885",
    "query_hash": "f8cc6c67",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000886",
    "query_hash": "5f8cf933",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000887",
    "query_hash": "ab7826f2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000888",
    "query_hash": "88ee57e6",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000889",
    "query_hash": "1cacf85c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000890",
    "query_hash": "f1b305ce",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000891",
    "query_hash": "65059cce",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000892",
    "query_hash": "f4f0d72e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000893",
    "query_hash": "7fd6953b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-06-03 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-07 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000894",
    "query_hash": "435991a9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-04-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-07 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000895",
    "query_hash": "8707a40d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-05-24 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-07 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000896",
    "query_hash": "54fb0a85",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-24 00:00:00' AND event_ts <  TIMESTAMP '2024-02-27 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000897",
    "query_hash": "8c41290a",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-24 00:00:00' AND event_ts <  TIMESTAMP '2024-02-27 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000898",
    "query_hash": "caf9ed28",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-12 00:00:00' AND event_ts <  TIMESTAMP '2024-02-27 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000899",
    "query_hash": "b9b75aad",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-23 00:00:00' AND event_ts <  TIMESTAMP '2024-02-27 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000900",
    "query_hash": "b9f250ae",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000900"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000900 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000900 LIMIT 500;"
  },
  {
    "sql_id": "S000901",
    "query_hash": "da93c0d0",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000902",
    "query_hash": "7918b42d",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-28 00:00:00' AND event_ts <  TIMESTAMP '2024-08-31 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000903",
    "query_hash": "6accf399",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-20 00:00:00' AND event_ts <  TIMESTAMP '2024-08-31 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000904",
    "query_hash": "c046defe",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-24 00:00:00' AND event_ts <  TIMESTAMP '2024-08-31 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000905",
    "query_hash": "68e158b3",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-24 00:00:00' AND event_ts <  TIMESTAMP '2024-08-31 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000906",
    "query_hash": "ac77430d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000907",
    "query_hash": "85a0ebf9",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000908",
    "query_hash": "c72c2cde",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000909",
    "query_hash": "e6c609b4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000910",
    "query_hash": "ec95b435",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-09-17 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-09-24 00:00:00'\n    GROUP BY 1  -- variant,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000911",
    "query_hash": "cb00fff0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-09-18 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-09-24 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000912",
    "query_hash": "591ba051",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-09-18 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-09-24 00:00:00'\n    GROUP BY 1  -- variant,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000913",
    "query_hash": "194d4636",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-09-21 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-09-24 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000914",
    "query_hash": "b86471ef",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e000914"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000914 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000914 LIMIT 500;"
  },
  {
    "sql_id": "S000915",
    "query_hash": "56171128",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000916",
    "query_hash": "5fc71ce2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000917",
    "query_hash": "e594a98c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000918",
    "query_hash": "f7d7a76e",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-02 00:00:00' AND event_ts <  TIMESTAMP '2024-07-09 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000919",
    "query_hash": "2500073d",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-24 00:00:00' AND event_ts <  TIMESTAMP '2024-07-09 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000920",
    "query_hash": "1c81c3e0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000921",
    "query_hash": "e3fae205",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000922",
    "query_hash": "c2996001",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "tmp_e000922"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000922 AS\n        SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-02-04 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-02-10 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;\n        SELECT * FROM tmp_e000922 LIMIT 500;"
  },
  {
    "sql_id": "S000923",
    "query_hash": "e9af82ae",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-02-08 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-02-10 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000924",
    "query_hash": "f3f76c66",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-01-27 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-02-10 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000925",
    "query_hash": "0c2fd2a7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-01-27 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-02-10 00:00:00'\n    GROUP BY 1  -- variant,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000926",
    "query_hash": "f3fed703",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-01 00:00:00' AND event_ts <  TIMESTAMP '2024-01-12 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000927",
    "query_hash": "054d1ddf",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-06 00:00:00' AND event_ts <  TIMESTAMP '2024-01-12 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000928",
    "query_hash": "e9d8263d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000929",
    "query_hash": "58f933af",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000930",
    "query_hash": "55531617",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000931",
    "query_hash": "ff52077e",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-20 00:00:00' AND event_ts <  TIMESTAMP '2024-09-27 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000932",
    "query_hash": "10bbf969",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000932"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000932 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-21 00:00:00' AND event_ts <  TIMESTAMP '2024-09-27 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000932 LIMIT 500;"
  },
  {
    "sql_id": "S000933",
    "query_hash": "12645c08",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-12 00:00:00' AND event_ts <  TIMESTAMP '2024-09-27 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000934",
    "query_hash": "98d85583",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-06-10 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-18 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000935",
    "query_hash": "45ccb425",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-06-14 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-18 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000936",
    "query_hash": "66725e6f",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-12 00:00:00' AND event_ts <  TIMESTAMP '2024-05-10 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000937",
    "query_hash": "0bfdac38",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-01 00:00:00' AND event_ts <  TIMESTAMP '2024-05-10 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000938",
    "query_hash": "5669487f",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-05-03 00:00:00' AND event_ts <  TIMESTAMP '2024-05-10 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000939",
    "query_hash": "132e5fa4",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-01 00:00:00' AND event_ts <  TIMESTAMP '2024-05-10 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000940",
    "query_hash": "c81897d0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-26 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-29 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000941",
    "query_hash": "2463c515",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-29 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000942",
    "query_hash": "f8cbc57b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-21 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-29 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000943",
    "query_hash": "4c0861c1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-14 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-29 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000944",
    "query_hash": "6133189c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-10-23 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-10-29 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000945",
    "query_hash": "eb88eaae",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-10-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-10-29 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000946",
    "query_hash": "0a08db9b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-10-08 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-10-29 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000947",
    "query_hash": "a5e17e41",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000948",
    "query_hash": "1f2cd0e4",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000949",
    "query_hash": "abed99dd",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-29 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000950",
    "query_hash": "a6cbeff7",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-09 00:00:00' AND event_ts <  TIMESTAMP '2024-11-13 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000951",
    "query_hash": "f301a2bc",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-07 00:00:00' AND event_ts <  TIMESTAMP '2024-11-13 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000952",
    "query_hash": "e252a6df",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-11 00:00:00' AND event_ts <  TIMESTAMP '2024-11-13 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000953",
    "query_hash": "610eeeef",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-20 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-07-23 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000954",
    "query_hash": "9316a15c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-20 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-07-23 00:00:00'\n    GROUP BY 1  -- variant,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000955",
    "query_hash": "9316a15c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-20 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-07-23 00:00:00'\n    GROUP BY 1  -- variant,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000956",
    "query_hash": "00dd0bb4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-08 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-07-23 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S000957",
    "query_hash": "a6b6e5e7",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000958",
    "query_hash": "969776cb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000958"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000958 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;\n        SELECT * FROM tmp_e000958 LIMIT 500;"
  },
  {
    "sql_id": "S000959",
    "query_hash": "29fbbe42",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000960",
    "query_hash": "e13fef65",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-18 00:00:00' AND event_ts <  TIMESTAMP '2024-11-08 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000961",
    "query_hash": "e1b756a7",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-04 00:00:00' AND event_ts <  TIMESTAMP '2024-11-08 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000962",
    "query_hash": "12744df4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000963",
    "query_hash": "e096ba6c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000964",
    "query_hash": "d79c59d3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000965",
    "query_hash": "d645d0c4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000966",
    "query_hash": "0e504d8c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000967",
    "query_hash": "5b688801",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000968",
    "query_hash": "9533228f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000969",
    "query_hash": "1c553f46",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e000969"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e000969 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e000969 LIMIT 500;"
  },
  {
    "sql_id": "S000970",
    "query_hash": "f1a029f5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000971",
    "query_hash": "50920c57",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000972",
    "query_hash": "86cb1a00",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-12-01 00:00:00' AND event_ts <  TIMESTAMP '2024-12-05 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000973",
    "query_hash": "28efdca4",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e000973"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e000973 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-28 00:00:00' AND event_ts <  TIMESTAMP '2024-12-05 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e000973 LIMIT 500;"
  },
  {
    "sql_id": "S000974",
    "query_hash": "eb99a625",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-01 00:00:00' AND event_ts <  TIMESTAMP '2024-01-09 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000975",
    "query_hash": "6c7b55b1",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000976",
    "query_hash": "55e96fb7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000977",
    "query_hash": "0bcc412e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-11-20 00:00:00' - INTERVAL '90 days')\n        AND purchased_at <  TIMESTAMP '2024-11-20 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-11-20 00:00:00' - INTERVAL '90 days')\n        AND order_ts <  TIMESTAMP '2024-11-20 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-11-20 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-11-20 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S000978",
    "query_hash": "c015e118",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000979",
    "query_hash": "b439fded",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000980",
    "query_hash": "e95d01d7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000981",
    "query_hash": "58ceabbd",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-04 00:00:00' AND event_ts <  TIMESTAMP '2024-11-19 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000982",
    "query_hash": "b8e0bb02",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-24 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-26 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-09-24 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-26 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000983",
    "query_hash": "4739a3dc",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-16 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S000984",
    "query_hash": "3895b26a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000985",
    "query_hash": "20380aec",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000986",
    "query_hash": "a9741807",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000987",
    "query_hash": "fb366631",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-22 00:00:00' AND event_ts <  TIMESTAMP '2024-10-20 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S000988",
    "query_hash": "8aeeb63e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S000989",
    "query_hash": "47da48f7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e000989"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e000989 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e000989 LIMIT 500;"
  },
  {
    "sql_id": "S000990",
    "query_hash": "cdaa03ec",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S000991",
    "query_hash": "39f3a638",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-09-04 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-09-04 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-09-04 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-09-04 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-09-04 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-09-04 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S000992",
    "query_hash": "6c262ed2",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-05-29 00:00:00' AND created_ts <  TIMESTAMP '2024-06-04 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S000993",
    "query_hash": "cdd2477e",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-09-03 00:00:00' AND created_ts <  TIMESTAMP '2024-09-06 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000994",
    "query_hash": "aa4f2d67",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-03-13 00:00:00' AND created_ts <  TIMESTAMP '2024-03-19 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000995",
    "query_hash": "3afd80b7",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-07-19 00:00:00' AND created_ts <  TIMESTAMP '2024-07-27 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S000996",
    "query_hash": "216e3db1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-07-16 00:00:00' - INTERVAL '90 days')\n        AND purchased_at <  TIMESTAMP '2024-07-16 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-07-16 00:00:00' - INTERVAL '90 days')\n        AND order_ts <  TIMESTAMP '2024-07-16 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-07-16 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-07-16 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S000997",
    "query_hash": "a8078d8a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-25 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-25 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-01 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S000998",
    "query_hash": "e38a524c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-10-16 00:00:00' - INTERVAL '180 days')\n        AND purchased_at <  TIMESTAMP '2024-10-16 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-10-16 00:00:00' - INTERVAL '180 days')\n        AND order_ts <  TIMESTAMP '2024-10-16 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-10-16 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-10-16 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S000999",
    "query_hash": "dd11e5c4",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-11-13 00:00:00' AND created_ts <  TIMESTAMP '2024-11-19 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001000",
    "query_hash": "a85192b6",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-12-18 00:00:00' AND event_ts <  TIMESTAMP '2024-12-21 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001001",
    "query_hash": "4f363e5b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e001001"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e001001 AS\n        -- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e001001 LIMIT 500;"
  },
  {
    "sql_id": "S001002",
    "query_hash": "fc97d15d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "-- ad-hoc rerun\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001003",
    "query_hash": "926e7b3f",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-03-11 00:00:00' AND created_ts <  TIMESTAMP '2024-06-16 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001004",
    "query_hash": "72a978dc",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e001004"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001004 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-05-06 00:00:00' AND event_ts <  TIMESTAMP '2024-05-10 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e001004 LIMIT 500;"
  },
  {
    "sql_id": "S001005",
    "query_hash": "ce112a5c",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-06-13 00:00:00' AND created_ts <  TIMESTAMP '2024-06-20 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001006",
    "query_hash": "80fa40e8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001007",
    "query_hash": "0e2e3ec7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-09-22 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-09-22 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-09-22 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-09-22 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-09-22 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-09-22 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001008",
    "query_hash": "17798744",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-08 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-19 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001009",
    "query_hash": "d867d3e1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001010",
    "query_hash": "f0f8f063",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets",
      "tmp_e001010"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001010 AS\n        WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-09-27 00:00:00' AND created_ts <  TIMESTAMP '2024-09-30 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;\n        SELECT * FROM tmp_e001010 LIMIT 500;"
  },
  {
    "sql_id": "S001011",
    "query_hash": "2f30b38e",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-12-13 00:00:00' AND created_ts <  TIMESTAMP '2024-12-27 00:00:00' AND stage = 'WON'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001012",
    "query_hash": "e3e4868a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001013",
    "query_hash": "9da4460d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-03-12 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001014",
    "query_hash": "bd13a313",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-04-20 00:00:00' AND created_ts <  TIMESTAMP '2024-04-23 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001015",
    "query_hash": "f60236ee",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-08 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-15 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-09-08 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-15 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001016",
    "query_hash": "78e28097",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-15 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-07-19 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001017",
    "query_hash": "a617d56c",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-01-16 00:00:00' AND created_ts <  TIMESTAMP '2024-01-23 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001018",
    "query_hash": "22b756a8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-10-09 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-10-17 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001019",
    "query_hash": "6b34daf5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001020",
    "query_hash": "adfc14ed",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001021",
    "query_hash": "fba295ff",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals",
      "tmp_e001021"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "CREATE TEMP TABLE tmp_e001021 AS\n        SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-07-26 00:00:00' AND created_ts <  TIMESTAMP '2024-08-01 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    ORDER BY month, stage;\n        SELECT * FROM tmp_e001021 LIMIT 500;"
  },
  {
    "sql_id": "S001022",
    "query_hash": "dcbe6681",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001023",
    "query_hash": "ca71d6d0",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-17 00:00:00' AND event_ts <  TIMESTAMP '2024-07-17 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001024",
    "query_hash": "b08e31a4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-02-19 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-05 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001025",
    "query_hash": "c9538152",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-04-02 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-04-16 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001026",
    "query_hash": "d826902d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-01-04 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001027",
    "query_hash": "ae19230e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-08 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001028",
    "query_hash": "b9d7f8a8",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-09 00:00:00' AND event_ts <  TIMESTAMP '2024-10-15 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001029",
    "query_hash": "eeb4abce",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-23 00:00:00' AND event_ts <  TIMESTAMP '2024-09-27 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001030",
    "query_hash": "d0509518",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001031",
    "query_hash": "c2f73adb",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-11-20 00:00:00' AND created_ts <  TIMESTAMP '2024-11-26 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001032",
    "query_hash": "92f10d5d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-05-03 00:00:00' - INTERVAL '90 days')\n        AND purchased_at <  TIMESTAMP '2024-05-03 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-05-03 00:00:00' - INTERVAL '90 days')\n        AND order_ts <  TIMESTAMP '2024-05-03 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-05-03 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-05-03 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001033",
    "query_hash": "7b070c5b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-08-15 00:00:00' - INTERVAL '180 days')\n        AND purchased_at <  TIMESTAMP '2024-08-15 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-08-15 00:00:00' - INTERVAL '180 days')\n        AND order_ts <  TIMESTAMP '2024-08-15 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-08-15 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-08-15 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001034",
    "query_hash": "2ac7aa68",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-12-20 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-27 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001035",
    "query_hash": "7ba82b09",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e001035"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e001035 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e001035 LIMIT 500;"
  },
  {
    "sql_id": "S001036",
    "query_hash": "bcf954ef",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-05-21 00:00:00' AND created_ts <  TIMESTAMP '2024-05-28 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001037",
    "query_hash": "98951d2e",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-18 00:00:00' AND event_ts <  TIMESTAMP '2024-11-20 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001038",
    "query_hash": "ce240a5a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-11-26 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-11-26 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-11-26 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-11-26 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-11-26 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-11-26 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001039",
    "query_hash": "060eb60e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001040",
    "query_hash": "c39c592b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-19 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-08-27 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-08-19 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-08-27 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001041",
    "query_hash": "611dcd6d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-22 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-25 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001042",
    "query_hash": "2d4c5f1d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-02-28 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-02-28 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-02-28 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-02-28 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-02-28 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-02-28 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001043",
    "query_hash": "ab731328",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-11 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-11-11 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-19 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001044",
    "query_hash": "aaa7100d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-02 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-09 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001045",
    "query_hash": "84b6ced7",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-04-05 00:00:00' AND created_ts <  TIMESTAMP '2024-04-12 00:00:00' AND stage = 'PROPOSAL'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001046",
    "query_hash": "72b4ee7f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-12-22 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-24 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-12-22 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-12-24 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001047",
    "query_hash": "9b2ba4a2",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-08-21 00:00:00' AND created_ts <  TIMESTAMP '2024-09-11 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001048",
    "query_hash": "9a1731cf",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001049",
    "query_hash": "1ef1d2c4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001050",
    "query_hash": "5d5fcf68",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-10-31 00:00:00' AND created_ts <  TIMESTAMP '2024-11-06 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001051",
    "query_hash": "dfe982e4",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-12-09 00:00:00' AND created_ts <  TIMESTAMP '2024-12-24 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001052",
    "query_hash": "1257fbff",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-10-10 00:00:00' AND created_ts <  TIMESTAMP '2024-10-18 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001053",
    "query_hash": "eca9f76e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-15 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-13 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001054",
    "query_hash": "bb7d3516",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-23 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-08 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001055",
    "query_hash": "7e3a0116",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e001055"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001055 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e001055 LIMIT 500;"
  },
  {
    "sql_id": "S001056",
    "query_hash": "664feb27",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-12-04 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-12-04 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-12-19 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001057",
    "query_hash": "91a6af3a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-02-24 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-02-24 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-02-24 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-02-24 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-02-24 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-02-24 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001058",
    "query_hash": "1c161f1b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-08 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-11-08 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-19 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001059",
    "query_hash": "ddb9eceb",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-25 00:00:00' AND event_ts <  TIMESTAMP '2024-12-03 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001060",
    "query_hash": "9c8ffaaa",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals",
      "tmp_e001060"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "CREATE TEMP TABLE tmp_e001060 AS\n        SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-01-13 00:00:00' AND created_ts <  TIMESTAMP '2024-01-24 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    ORDER BY month, stage;\n        SELECT * FROM tmp_e001060 LIMIT 500;"
  },
  {
    "sql_id": "S001061",
    "query_hash": "1e3c4833",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e001061"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001061 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e001061 LIMIT 500;"
  },
  {
    "sql_id": "S001062",
    "query_hash": "76840ddb",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001063",
    "query_hash": "dfbe9b82",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "-- ad-hoc rerun\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-06-11 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-18 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001064",
    "query_hash": "233440d8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-05 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001065",
    "query_hash": "113ca9ca",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-11-13 00:00:00' AND created_ts <  TIMESTAMP '2024-11-19 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001066",
    "query_hash": "fcf1c3a9",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-05-07 00:00:00' AND created_ts <  TIMESTAMP '2024-05-21 00:00:00' AND stage = 'PROPOSAL'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001067",
    "query_hash": "c21743ff",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-08-17 00:00:00' AND created_ts <  TIMESTAMP '2024-08-20 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001068",
    "query_hash": "3ee39894",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001069",
    "query_hash": "9d2b15f8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-05-03 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-05-10 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001070",
    "query_hash": "c9e8c2e5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-10-05 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-10-16 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001071",
    "query_hash": "888231c6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-05-29 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-04 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-05-29 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-06-04 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001072",
    "query_hash": "3059d87d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-04-09 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-04-23 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001073",
    "query_hash": "0fac9c64",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-24 00:00:00' AND event_ts <  TIMESTAMP '2024-07-29 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001074",
    "query_hash": "3b51c024",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- ad-hoc rerun\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-29 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001075",
    "query_hash": "c69f5a72",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-30 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-05 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001076",
    "query_hash": "df821054",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-02-17 00:00:00' AND created_ts <  TIMESTAMP '2024-02-24 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001077",
    "query_hash": "da40cf97",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001078",
    "query_hash": "865bdce7",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001079",
    "query_hash": "cf401043",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-06 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-01-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-01-06 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001080",
    "query_hash": "79cf28d1",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 2,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-01-01 00:00:00' AND created_ts <  TIMESTAMP '2024-03-05 00:00:00' AND stage = 'PROPOSAL'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001081",
    "query_hash": "a28ad258",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001082",
    "query_hash": "d2658207",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001083",
    "query_hash": "9ad573fb",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-04-18 00:00:00' AND created_ts <  TIMESTAMP '2024-04-25 00:00:00' AND stage = 'WON'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001084",
    "query_hash": "d96c8e7e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-02 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-09 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001085",
    "query_hash": "d6ae8351",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001086",
    "query_hash": "77def8aa",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-08 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-11-08 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-19 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001087",
    "query_hash": "0c696cf7",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-28 00:00:00' AND event_ts <  TIMESTAMP '2024-11-30 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001088",
    "query_hash": "a7e78dfb",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-29 00:00:00' AND event_ts <  TIMESTAMP '2024-05-14 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001089",
    "query_hash": "ac818dd3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-04 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-25 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-09-04 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-25 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001090",
    "query_hash": "f8f01b37",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-12-10 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-31 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001091",
    "query_hash": "c7024335",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "-- ad-hoc rerun\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-09-04 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-09-04 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-09-04 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-09-04 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-09-04 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-09-04 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY customers DESC;"
  },
  {
    "sql_id": "S001092",
    "query_hash": "dcd97e3b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001093",
    "query_hash": "4b4709f4",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-04-05 00:00:00' AND created_ts <  TIMESTAMP '2024-04-16 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001094",
    "query_hash": "391e6c01",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-25 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-04-05 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001095",
    "query_hash": "4cab909c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001096",
    "query_hash": "8a2fff83",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 2,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-03-27 00:00:00' AND created_ts <  TIMESTAMP '2024-03-29 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001097",
    "query_hash": "3008e1cd",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-08 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-11-08 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-19 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001098",
    "query_hash": "18521376",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e001098"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001098 AS\n        -- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e001098 LIMIT 500;"
  },
  {
    "sql_id": "S001099",
    "query_hash": "72ee3340",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-11 00:00:00' AND event_ts <  TIMESTAMP '2024-11-19 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001100",
    "query_hash": "2bb0232b",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-18 00:00:00' AND event_ts <  TIMESTAMP '2024-10-22 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001101",
    "query_hash": "996d7c51",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-10-22 00:00:00' AND created_ts <  TIMESTAMP '2024-10-25 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY month, stage;"
  },
  {
    "sql_id": "S001102",
    "query_hash": "09258c8a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001103",
    "query_hash": "00d69c3f",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-12-13 00:00:00' AND event_ts <  TIMESTAMP '2024-12-17 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001104",
    "query_hash": "d7649534",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001105",
    "query_hash": "a4631220",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001106",
    "query_hash": "7eadc68c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-19 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-25 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-09-19 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-25 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001107",
    "query_hash": "bb1831ac",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "tmp_e001107"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001107 AS\n        SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-09-10 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-10-11 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;\n        SELECT * FROM tmp_e001107 LIMIT 500;"
  },
  {
    "sql_id": "S001108",
    "query_hash": "283b25d2",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-05-05 00:00:00' AND event_ts <  TIMESTAMP '2024-05-07 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001109",
    "query_hash": "f1dbe4b0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001110",
    "query_hash": "4725a22d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-04-25 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-05-10 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-04-25 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-05-10 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001111",
    "query_hash": "ca55616b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001112",
    "query_hash": "aa849846",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e001112"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e001112 AS\n        -- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e001112 LIMIT 500;"
  },
  {
    "sql_id": "S001113",
    "query_hash": "23351289",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-01-22 00:00:00' AND created_ts <  TIMESTAMP '2024-02-06 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001114",
    "query_hash": "f765a0a8",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001115",
    "query_hash": "773db7a6",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-01 00:00:00' AND event_ts <  TIMESTAMP '2024-10-08 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001116",
    "query_hash": "6af471c3",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-19 00:00:00' AND event_ts <  TIMESTAMP '2024-07-04 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001117",
    "query_hash": "3f6789f3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001118",
    "query_hash": "5b369306",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-12-06 00:00:00' AND event_ts <  TIMESTAMP '2024-12-17 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001119",
    "query_hash": "0180875d",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-11-05 00:00:00' AND created_ts <  TIMESTAMP '2024-11-26 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001120",
    "query_hash": "86adaa24",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-05-30 00:00:00' AND created_ts <  TIMESTAMP '2024-06-13 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001121",
    "query_hash": "5b9d6b64",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-18 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-08-29 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001122",
    "query_hash": "802b5664",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "-- ad-hoc rerun\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-12-17 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-24 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001123",
    "query_hash": "24dbce43",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-01-30 00:00:00' - INTERVAL '180 days')\n        AND purchased_at <  TIMESTAMP '2024-01-30 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-01-30 00:00:00' - INTERVAL '180 days')\n        AND order_ts <  TIMESTAMP '2024-01-30 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-01-30 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-01-30 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001124",
    "query_hash": "bb5d64fb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001125",
    "query_hash": "5bdd682e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001126",
    "query_hash": "181c3cfc",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001127",
    "query_hash": "f73cb1df",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001128",
    "query_hash": "aeb3ae53",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001129",
    "query_hash": "08d2afe6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001130",
    "query_hash": "31da4e06",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e001130"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e001130 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e001130 LIMIT 500;"
  },
  {
    "sql_id": "S001131",
    "query_hash": "01bdfd26",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001132",
    "query_hash": "30d43bb8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "tmp_e001132"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001132 AS\n        SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-11 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-08-01 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;\n        SELECT * FROM tmp_e001132 LIMIT 500;"
  },
  {
    "sql_id": "S001133",
    "query_hash": "c962c66a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001134",
    "query_hash": "f783f498",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-06-07 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-14 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001135",
    "query_hash": "dd276f28",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets",
      "tmp_e001135"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001135 AS\n        -- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-08-29 00:00:00' AND created_ts <  TIMESTAMP '2024-09-06 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;\n        SELECT * FROM tmp_e001135 LIMIT 500;"
  },
  {
    "sql_id": "S001136",
    "query_hash": "e9380eec",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-12 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-27 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001137",
    "query_hash": "fc1a8b92",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e001137"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001137 AS\n        -- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e001137 LIMIT 500;"
  },
  {
    "sql_id": "S001138",
    "query_hash": "e7be15cc",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001139",
    "query_hash": "c340b03c",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-02-02 00:00:00' AND created_ts <  TIMESTAMP '2024-02-13 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001140",
    "query_hash": "143d3784",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-10-01 00:00:00' AND created_ts <  TIMESTAMP '2024-10-03 00:00:00' AND stage = 'WON'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001141",
    "query_hash": "3ffebfe7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001142",
    "query_hash": "c53e72a2",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-08-18 00:00:00' AND created_ts <  TIMESTAMP '2024-08-25 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001143",
    "query_hash": "42ca1ffd",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-11 00:00:00' AND event_ts <  TIMESTAMP '2024-10-22 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001144",
    "query_hash": "0c81b866",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001145",
    "query_hash": "be8b0c7d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001146",
    "query_hash": "2583ff49",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-15 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-21 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-09-15 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-21 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001147",
    "query_hash": "69835453",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-03-13 00:00:00' AND created_ts <  TIMESTAMP '2024-03-27 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001148",
    "query_hash": "b94c6887",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-07-13 00:00:00' AND created_ts <  TIMESTAMP '2024-07-27 00:00:00' AND stage = 'PROPOSAL'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001149",
    "query_hash": "66a9c1c0",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-10-08 00:00:00' AND created_ts <  TIMESTAMP '2024-10-15 00:00:00' AND stage = 'PROPOSAL'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001150",
    "query_hash": "6fb4a976",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001151",
    "query_hash": "0c94895f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-12-13 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-17 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001152",
    "query_hash": "78d88f29",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-11-27 00:00:00' AND created_ts <  TIMESTAMP '2024-12-03 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001153",
    "query_hash": "aad69371",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-03 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-07-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-03 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001154",
    "query_hash": "d4b2d96e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-12-04 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-07 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001155",
    "query_hash": "d827c7db",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001156",
    "query_hash": "c28c00a9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001157",
    "query_hash": "e8efaa6c",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-10-08 00:00:00' AND created_ts <  TIMESTAMP '2024-10-15 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001158",
    "query_hash": "6aa9579f",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-02-25 00:00:00' AND created_ts <  TIMESTAMP '2024-02-27 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001159",
    "query_hash": "b0c07453",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-09-08 00:00:00' AND created_ts <  TIMESTAMP '2024-09-11 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001160",
    "query_hash": "eb115f35",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001161",
    "query_hash": "bf83153f",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-11 00:00:00' AND event_ts <  TIMESTAMP '2024-11-19 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001162",
    "query_hash": "30537d2e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001163",
    "query_hash": "8316778d",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e001163"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001163 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-21 00:00:00' AND event_ts <  TIMESTAMP '2024-11-05 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e001163 LIMIT 500;"
  },
  {
    "sql_id": "S001164",
    "query_hash": "2651cd80",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-05-15 00:00:00' AND created_ts <  TIMESTAMP '2024-05-30 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001165",
    "query_hash": "eacff4cf",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001166",
    "query_hash": "ae7912ab",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-28 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-05 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-28 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-05 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001167",
    "query_hash": "fcc352d0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001168",
    "query_hash": "4e7c89b2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001169",
    "query_hash": "0c185fe7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001170",
    "query_hash": "c3187cf3",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-11-23 00:00:00' AND created_ts <  TIMESTAMP '2024-11-26 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001171",
    "query_hash": "5a772e8f",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e001171"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001171 AS\n        -- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e001171 LIMIT 500;"
  },
  {
    "sql_id": "S001172",
    "query_hash": "758b5d5c",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-11-13 00:00:00' AND created_ts <  TIMESTAMP '2024-11-27 00:00:00' AND stage = 'PROPOSAL'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001173",
    "query_hash": "44e15be6",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-12-27 00:00:00' AND event_ts <  TIMESTAMP '2024-12-31 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001174",
    "query_hash": "831ab3b5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001175",
    "query_hash": "39075639",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-02-08 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-02-22 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001176",
    "query_hash": "278266fe",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-09 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-07-30 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001177",
    "query_hash": "b9e4443b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches",
      "tmp_e001177"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001177 AS\n        WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-03 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-06 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY attributed_net_revenue DESC;\n        SELECT * FROM tmp_e001177 LIMIT 500;"
  },
  {
    "sql_id": "S001178",
    "query_hash": "2d5f5468",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001179",
    "query_hash": "0a42e8f7",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-21 00:00:00' AND event_ts <  TIMESTAMP '2024-11-23 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001180",
    "query_hash": "8086d770",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-09-03 00:00:00' AND created_ts <  TIMESTAMP '2024-09-18 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001181",
    "query_hash": "0d0e2e9b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001182",
    "query_hash": "89cf3873",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-05-26 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-05-29 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001183",
    "query_hash": "88b7b751",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001184",
    "query_hash": "23198b36",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001185",
    "query_hash": "5badc525",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-12-16 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-23 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001186",
    "query_hash": "ef75012a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001187",
    "query_hash": "58c42b91",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-20 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-27 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-09-20 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-27 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001188",
    "query_hash": "9215669c",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-04-02 00:00:00' AND created_ts <  TIMESTAMP '2024-04-09 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001189",
    "query_hash": "594e319c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-04 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-06 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-01-04 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-01-06 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001190",
    "query_hash": "411ea9aa",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-14 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-29 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001191",
    "query_hash": "815036a5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-02-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001192",
    "query_hash": "be6f49b7",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-13 00:00:00' AND event_ts <  TIMESTAMP '2024-10-20 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001193",
    "query_hash": "5a4e356e",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-11-29 00:00:00' AND created_ts <  TIMESTAMP '2024-12-10 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001194",
    "query_hash": "802b5664",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "-- ad-hoc rerun\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-12-17 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-24 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001195",
    "query_hash": "8fabc3ff",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001196",
    "query_hash": "5af7c739",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-12-17 00:00:00' AND created_ts <  TIMESTAMP '2024-12-31 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001197",
    "query_hash": "e7d7a57a",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-07-18 00:00:00' AND created_ts <  TIMESTAMP '2024-07-20 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001198",
    "query_hash": "1e131deb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001199",
    "query_hash": "b01a1147",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-11-09 00:00:00' AND created_ts <  TIMESTAMP '2024-11-13 00:00:00' AND stage = 'WON'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001200",
    "query_hash": "eb9b73b2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders",
      "tmp_e001200"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001200 AS\n        WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-05-14 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-05-21 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-05-14 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-05-21 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;\n        SELECT * FROM tmp_e001200 LIMIT 500;"
  },
  {
    "sql_id": "S001201",
    "query_hash": "307107fb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-12-20 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-28 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001202",
    "query_hash": "766b7c83",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001203",
    "query_hash": "12c4a9f0",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-10-26 00:00:00' AND created_ts <  TIMESTAMP '2024-11-30 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001204",
    "query_hash": "4e687d58",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-03-26 00:00:00' AND created_ts <  TIMESTAMP '2024-04-23 00:00:00' AND stage = 'PROPOSAL'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001205",
    "query_hash": "4531dc74",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-27 00:00:00' AND event_ts <  TIMESTAMP '2024-09-24 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001206",
    "query_hash": "c48ea27c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001207",
    "query_hash": "84ab10c5",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-14 00:00:00' AND event_ts <  TIMESTAMP '2024-09-21 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001208",
    "query_hash": "6c667156",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-10-17 00:00:00' AND created_ts <  TIMESTAMP '2024-11-01 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001209",
    "query_hash": "d78fd79e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-27 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-30 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-03-27 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-03-30 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001210",
    "query_hash": "67d7d047",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-14 00:00:00' AND event_ts <  TIMESTAMP '2024-09-28 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001211",
    "query_hash": "6b4f3007",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-05-29 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-01 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001212",
    "query_hash": "ee3b4ccd",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-12-19 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-27 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001213",
    "query_hash": "e46a9947",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-02-26 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-03-11 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001214",
    "query_hash": "6752ab3f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-25 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-04-09 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001215",
    "query_hash": "89d66e63",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-03-19 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-04-16 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001216",
    "query_hash": "a35b99a1",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-09-27 00:00:00' AND created_ts <  TIMESTAMP '2024-10-08 00:00:00' AND stage = 'PROPOSAL'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001217",
    "query_hash": "2dff7178",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001218",
    "query_hash": "0b58bb51",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001219",
    "query_hash": "9ef403b5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001220",
    "query_hash": "12a81720",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-04-30 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-05-11 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001221",
    "query_hash": "d566c127",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001222",
    "query_hash": "f6b420b5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001223",
    "query_hash": "77b6569f",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-08-19 00:00:00' AND created_ts <  TIMESTAMP '2024-08-22 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001224",
    "query_hash": "38abf9a7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001225",
    "query_hash": "645bee00",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-12-05 00:00:00' - INTERVAL '180 days')\n        AND purchased_at <  TIMESTAMP '2024-12-05 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-12-05 00:00:00' - INTERVAL '180 days')\n        AND order_ts <  TIMESTAMP '2024-12-05 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-12-05 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-12-05 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001226",
    "query_hash": "22b3f891",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-31 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-07 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-31 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-07 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001227",
    "query_hash": "887e48df",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-05-24 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-05-28 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001228",
    "query_hash": "41d2bfd6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001229",
    "query_hash": "d98daeba",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-12-06 00:00:00' AND event_ts <  TIMESTAMP '2024-12-17 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001230",
    "query_hash": "7590c712",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-10-27 00:00:00' - INTERVAL '180 days')\n        AND purchased_at <  TIMESTAMP '2024-10-27 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-10-27 00:00:00' - INTERVAL '180 days')\n        AND order_ts <  TIMESTAMP '2024-10-27 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-10-27 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-10-27 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001231",
    "query_hash": "9b8e1ef1",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-20 00:00:00' AND event_ts <  TIMESTAMP '2024-07-01 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001232",
    "query_hash": "e3e566f5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001233",
    "query_hash": "59d60b5a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-01-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001234",
    "query_hash": "9e34442b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-05-09 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-05-24 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001235",
    "query_hash": "bba1f326",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-28 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-30 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001236",
    "query_hash": "fc9fe83f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-08-15 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-08-17 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001237",
    "query_hash": "4b52bd70",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-07-28 00:00:00' AND created_ts <  TIMESTAMP '2024-07-30 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001238",
    "query_hash": "129134fa",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e001238"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001238 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e001238 LIMIT 500;"
  },
  {
    "sql_id": "S001239",
    "query_hash": "4b9e5b9e",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-25 00:00:00' AND event_ts <  TIMESTAMP '2024-05-09 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001240",
    "query_hash": "7c2cc8ea",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets",
      "tmp_e001240"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001240 AS\n        WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-08-14 00:00:00' AND created_ts <  TIMESTAMP '2024-08-20 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;\n        SELECT * FROM tmp_e001240 LIMIT 500;"
  },
  {
    "sql_id": "S001241",
    "query_hash": "5b91f78c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-20 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001242",
    "query_hash": "0cde7bfe",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001243",
    "query_hash": "3b6999ef",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-05-16 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-06 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001244",
    "query_hash": "becf6025",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001245",
    "query_hash": "8490ee2d",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-23 00:00:00' AND event_ts <  TIMESTAMP '2024-01-30 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001246",
    "query_hash": "0229c36e",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-03-12 00:00:00' AND event_ts <  TIMESTAMP '2024-03-19 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001247",
    "query_hash": "63168e92",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e001247"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001247 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e001247 LIMIT 500;"
  },
  {
    "sql_id": "S001248",
    "query_hash": "0b19fb12",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001249",
    "query_hash": "c9cb302e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-30 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-08-13 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-07-30 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-08-13 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001250",
    "query_hash": "41cca21c",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "-- ad-hoc rerun\nSELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-11-20 00:00:00' AND created_ts <  TIMESTAMP '2024-11-26 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001251",
    "query_hash": "d4f42115",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-06-10 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-18 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001252",
    "query_hash": "a1d1013e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-05-24 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-05-31 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001253",
    "query_hash": "9afdfccb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001254",
    "query_hash": "415232ba",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e001254"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001254 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-01 00:00:00' AND event_ts <  TIMESTAMP '2024-01-10 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e001254 LIMIT 500;"
  },
  {
    "sql_id": "S001255",
    "query_hash": "2ee1aa52",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001256",
    "query_hash": "933599d6",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-03-18 00:00:00' AND created_ts <  TIMESTAMP '2024-04-02 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001257",
    "query_hash": "d7e89ff8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-02-06 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-02-27 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-02-06 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-02-27 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001258",
    "query_hash": "66aeb800",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-02-01 00:00:00' - INTERVAL '90 days')\n        AND purchased_at <  TIMESTAMP '2024-02-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-02-01 00:00:00' - INTERVAL '90 days')\n        AND order_ts <  TIMESTAMP '2024-02-01 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-02-01 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-02-01 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001259",
    "query_hash": "da5c723d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "-- ad-hoc rerun\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-11-26 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-11-26 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-11-26 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-11-26 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-11-26 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-11-26 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001260",
    "query_hash": "06a345b1",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-05-24 00:00:00' AND event_ts <  TIMESTAMP '2024-05-28 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001261",
    "query_hash": "e0ca7ce1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-08-04 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001262",
    "query_hash": "cc6e666c",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-11-29 00:00:00' AND created_ts <  TIMESTAMP '2024-12-27 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001263",
    "query_hash": "11890e2e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-30 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-07 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001264",
    "query_hash": "dc632381",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-10-29 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-05 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001265",
    "query_hash": "fad04b17",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001266",
    "query_hash": "e18bce9f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001267",
    "query_hash": "dd52ab8d",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e001267"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001267 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-05 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e001267 LIMIT 500;"
  },
  {
    "sql_id": "S001268",
    "query_hash": "d4010c73",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "-- ad-hoc rerun\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-19 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-26 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001269",
    "query_hash": "475ff332",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-11-27 00:00:00' - INTERVAL '90 days')\n        AND purchased_at <  TIMESTAMP '2024-11-27 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-11-27 00:00:00' - INTERVAL '90 days')\n        AND order_ts <  TIMESTAMP '2024-11-27 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-11-27 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-11-27 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001270",
    "query_hash": "b4060d68",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-01-29 00:00:00' AND created_ts <  TIMESTAMP '2024-01-31 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001271",
    "query_hash": "967ecb33",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-06-03 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-14 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001272",
    "query_hash": "621c61d8",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-01-01 00:00:00' AND created_ts <  TIMESTAMP '2024-01-11 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001273",
    "query_hash": "8ba297c3",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001274",
    "query_hash": "9049603f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001275",
    "query_hash": "765e05ff",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-01 00:00:00' AND event_ts <  TIMESTAMP '2024-05-31 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001276",
    "query_hash": "ed7aacad",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001277",
    "query_hash": "c1321ac4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders",
      "tmp_e001277"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001277 AS\n        WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-08-08 00:00:00' - INTERVAL '90 days')\n        AND purchased_at <  TIMESTAMP '2024-08-08 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-08-08 00:00:00' - INTERVAL '90 days')\n        AND order_ts <  TIMESTAMP '2024-08-08 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-08-08 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-08-08 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;\n        SELECT * FROM tmp_e001277 LIMIT 500;"
  },
  {
    "sql_id": "S001278",
    "query_hash": "f8ac9656",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-06-03 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-14 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001279",
    "query_hash": "293731e9",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001280",
    "query_hash": "6cac1e46",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'US' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001281",
    "query_hash": "bfe8e120",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-07-26 00:00:00' AND created_ts <  TIMESTAMP '2024-08-09 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001282",
    "query_hash": "c4341552",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-10-12 00:00:00' - INTERVAL '90 days')\n        AND purchased_at <  TIMESTAMP '2024-10-12 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-10-12 00:00:00' - INTERVAL '90 days')\n        AND order_ts <  TIMESTAMP '2024-10-12 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-10-12 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-10-12 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001283",
    "query_hash": "3bb2d728",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-08-21 00:00:00' AND created_ts <  TIMESTAMP '2024-09-04 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001284",
    "query_hash": "c83db07e",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-08 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001285",
    "query_hash": "8461f0ea",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-25 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001286",
    "query_hash": "135674e0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-08-22 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-08-29 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001287",
    "query_hash": "6cd43a3e",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-06-06 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-09 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001288",
    "query_hash": "ec8154d2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-07 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001289",
    "query_hash": "e811b484",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001290",
    "query_hash": "58134e00",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans",
      "tmp_e001290"
    ],
    "num_tables": 4,
    "has_joins": true,
    "join_count": 3,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 12,
    "sql_full": "CREATE TEMP TABLE tmp_e001290 AS\n        WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;\n        SELECT * FROM tmp_e001290 LIMIT 500;"
  },
  {
    "sql_id": "S001291",
    "query_hash": "6171d75d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-10 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-12 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-07-10 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-07-12 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001292",
    "query_hash": "5662b059",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals",
      "tmp_e001292"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "CREATE TEMP TABLE tmp_e001292 AS\n        SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-02-27 00:00:00' AND created_ts <  TIMESTAMP '2024-03-05 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    ORDER BY month, stage;\n        SELECT * FROM tmp_e001292 LIMIT 500;"
  },
  {
    "sql_id": "S001293",
    "query_hash": "6fb502d4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-03-31 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-04-11 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001294",
    "query_hash": "bd4d16ae",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-09-25 00:00:00' AND created_ts <  TIMESTAMP '2024-10-23 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001295",
    "query_hash": "2b0e74b8",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-02 00:00:00' AND event_ts <  TIMESTAMP '2024-09-17 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001296",
    "query_hash": "fc760ed4",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-10-19 00:00:00' AND created_ts <  TIMESTAMP '2024-10-22 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY month, stage;"
  },
  {
    "sql_id": "S001297",
    "query_hash": "dd0d69f3",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-02-07 00:00:00' AND created_ts <  TIMESTAMP '2024-02-13 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001298",
    "query_hash": "b2988120",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-13 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001299",
    "query_hash": "1d357cfb",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-17 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001300",
    "query_hash": "69119283",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-06-18 00:00:00' AND created_ts <  TIMESTAMP '2024-06-25 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001301",
    "query_hash": "c2c7b850",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-01 00:00:00' AND event_ts <  TIMESTAMP '2024-04-12 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001302",
    "query_hash": "74fcea14",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-05 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-20 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001303",
    "query_hash": "59cfd938",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-02-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-02-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001304",
    "query_hash": "a7c3ee20",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-01-01 00:00:00' AND created_ts <  TIMESTAMP '2024-01-12 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001305",
    "query_hash": "fb79b697",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-08-02 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-08-13 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001306",
    "query_hash": "b68600be",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets",
      "tmp_e001306"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001306 AS\n        WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-11-20 00:00:00' AND created_ts <  TIMESTAMP '2024-11-27 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;\n        SELECT * FROM tmp_e001306 LIMIT 500;"
  },
  {
    "sql_id": "S001307",
    "query_hash": "014fd5ab",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'US' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001308",
    "query_hash": "574b9c93",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "tmp_e001308"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001308 AS\n        SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-19 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-04 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;\n        SELECT * FROM tmp_e001308 LIMIT 500;"
  },
  {
    "sql_id": "S001309",
    "query_hash": "b13d6932",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-01-01 00:00:00' AND created_ts <  TIMESTAMP '2024-01-16 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001310",
    "query_hash": "ee6986c6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-11 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001311",
    "query_hash": "bf1278ea",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001312",
    "query_hash": "f64b95f3",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-01 00:00:00' AND event_ts <  TIMESTAMP '2024-11-09 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001313",
    "query_hash": "3e5a4dba",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-04 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001314",
    "query_hash": "3889f86a",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-01 00:00:00' AND event_ts <  TIMESTAMP '2024-11-03 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001315",
    "query_hash": "c6f69b01",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-12-06 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-20 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001316",
    "query_hash": "9a72dc6b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001317",
    "query_hash": "cba105f0",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-06 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001318",
    "query_hash": "ab2745cc",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-23 00:00:00' AND event_ts <  TIMESTAMP '2024-09-06 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001319",
    "query_hash": "62817193",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-02-04 00:00:00' AND created_ts <  TIMESTAMP '2024-02-11 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001320",
    "query_hash": "d6b75127",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-23 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-04 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-09-23 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-10-04 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001321",
    "query_hash": "e0c6df42",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-23 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-03 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001322",
    "query_hash": "94e44ce6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-12-18 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-24 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-12-18 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-12-24 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001323",
    "query_hash": "de3786f0",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-06-25 00:00:00' AND event_ts <  TIMESTAMP '2024-07-03 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001324",
    "query_hash": "407880fd",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-02-03 00:00:00' AND created_ts <  TIMESTAMP '2024-02-09 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001325",
    "query_hash": "00c31f6c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-19 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-03 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001326",
    "query_hash": "4bd1d0c0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-30 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-04 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001327",
    "query_hash": "981174c3",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e001327"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001327 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-08 00:00:00' AND event_ts <  TIMESTAMP '2024-11-15 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e001327 LIMIT 500;"
  },
  {
    "sql_id": "S001328",
    "query_hash": "69aa62e0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-22 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-08-06 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-07-22 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-08-06 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001329",
    "query_hash": "908707b8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-09-21 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-10-06 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001330",
    "query_hash": "1b964b76",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'GB' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001331",
    "query_hash": "9ff38792",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-03 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-09 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-07-03 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-07-09 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001332",
    "query_hash": "4d4d9b65",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-03-12 00:00:00' AND event_ts <  TIMESTAMP '2024-03-26 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001333",
    "query_hash": "69b18ebf",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001334",
    "query_hash": "07b20c5d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders",
      "tmp_e001334"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001334 AS\n        WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-07-30 00:00:00' - INTERVAL '90 days')\n        AND purchased_at <  TIMESTAMP '2024-07-30 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-07-30 00:00:00' - INTERVAL '90 days')\n        AND order_ts <  TIMESTAMP '2024-07-30 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-07-30 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-07-30 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;\n        SELECT * FROM tmp_e001334 LIMIT 500;"
  },
  {
    "sql_id": "S001335",
    "query_hash": "3171d24a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-11-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-26 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001336",
    "query_hash": "4ece8455",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-10-07 00:00:00' AND created_ts <  TIMESTAMP '2024-10-15 00:00:00' AND stage = 'PROPOSAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY month, stage;"
  },
  {
    "sql_id": "S001337",
    "query_hash": "e224f763",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001338",
    "query_hash": "2a2a981c",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-09-25 00:00:00' AND created_ts <  TIMESTAMP '2024-09-28 00:00:00' AND stage = 'WON'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001339",
    "query_hash": "52be2113",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-05-14 00:00:00' AND created_ts <  TIMESTAMP '2024-05-21 00:00:00' AND stage = 'WON'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001340",
    "query_hash": "a16993a9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-28 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001341",
    "query_hash": "a7c259e0",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-05-27 00:00:00' AND created_ts <  TIMESTAMP '2024-06-11 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001342",
    "query_hash": "3b9dda88",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-06-06 00:00:00' AND created_ts <  TIMESTAMP '2024-06-14 00:00:00' AND stage = 'WON'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001343",
    "query_hash": "0e95d70f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-01 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001344",
    "query_hash": "849768b8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-04-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-05-17 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001345",
    "query_hash": "84549e9c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-07 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-08-14 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-08-07 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-08-14 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001346",
    "query_hash": "50ff4806",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-09-29 00:00:00' - INTERVAL '180 days')\n        AND purchased_at <  TIMESTAMP '2024-09-29 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-09-29 00:00:00' - INTERVAL '180 days')\n        AND order_ts <  TIMESTAMP '2024-09-29 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-09-29 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-09-29 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001347",
    "query_hash": "3dbe5dbc",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-06 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-12 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001348",
    "query_hash": "1ae11ab9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "tmp_e001348"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001348 AS\n        SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-06-07 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-10 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;\n        SELECT * FROM tmp_e001348 LIMIT 500;"
  },
  {
    "sql_id": "S001349",
    "query_hash": "3019c959",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals",
      "tmp_e001349"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "CREATE TEMP TABLE tmp_e001349 AS\n        SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-04-04 00:00:00' AND created_ts <  TIMESTAMP '2024-04-11 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY month, stage;\n        SELECT * FROM tmp_e001349 LIMIT 500;"
  },
  {
    "sql_id": "S001350",
    "query_hash": "27eb156c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-29 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-04 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-08-29 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-04 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001351",
    "query_hash": "975e209f",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-12-12 00:00:00' AND created_ts <  TIMESTAMP '2024-12-19 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001352",
    "query_hash": "4e8f506c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-06 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001353",
    "query_hash": "2926719c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-12 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001354",
    "query_hash": "b66ecfa7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-12-09 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-12 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001355",
    "query_hash": "14022394",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-06-08 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-15 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-06-08 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-06-15 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001356",
    "query_hash": "919cdde1",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders",
      "tmp_e001356"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001356 AS\n        WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-25 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-05-17 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-03-25 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-05-17 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;\n        SELECT * FROM tmp_e001356 LIMIT 500;"
  },
  {
    "sql_id": "S001357",
    "query_hash": "ff3199e1",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001358",
    "query_hash": "8a5b2e8e",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-31 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-11-11 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001359",
    "query_hash": "4e8ae319",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001360",
    "query_hash": "682363d9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-30 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-06 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-30 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-06 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001361",
    "query_hash": "50060633",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-28 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-01-30 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-01-28 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-01-30 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001362",
    "query_hash": "70a9bdff",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-02-24 00:00:00' AND created_ts <  TIMESTAMP '2024-03-02 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001363",
    "query_hash": "be07e197",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-19 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-23 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001364",
    "query_hash": "757158da",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-01-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-01-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001365",
    "query_hash": "386f1ab2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-04-30 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-05-07 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001366",
    "query_hash": "9092d071",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-04-18 00:00:00' AND event_ts <  TIMESTAMP '2024-05-23 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001367",
    "query_hash": "669008ed",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-12-03 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-31 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001368",
    "query_hash": "3e2e1777",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-12-24 00:00:00' - INTERVAL '90 days')\n        AND purchased_at <  TIMESTAMP '2024-12-24 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-12-24 00:00:00' - INTERVAL '90 days')\n        AND order_ts <  TIMESTAMP '2024-12-24 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-12-24 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-12-24 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001369",
    "query_hash": "63e0bf12",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-25 00:00:00' AND event_ts <  TIMESTAMP '2024-07-27 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001370",
    "query_hash": "40447137",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-09 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-16 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-11-09 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-16 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001371",
    "query_hash": "c4377b2b",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-28 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-04 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-08-28 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-04 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001372",
    "query_hash": "eb914843",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-09 00:00:00' AND event_ts <  TIMESTAMP '2024-08-30 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001373",
    "query_hash": "28862e96",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e001373"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001373 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-28 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e001373 LIMIT 500;"
  },
  {
    "sql_id": "S001374",
    "query_hash": "4815b9c8",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 2,
    "sql_full": "-- ad-hoc rerun\nSELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-08-21 00:00:00' AND created_ts <  TIMESTAMP '2024-09-04 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY month, stage;"
  },
  {
    "sql_id": "S001375",
    "query_hash": "ae96506e",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-03-28 00:00:00' AND event_ts <  TIMESTAMP '2024-04-12 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001376",
    "query_hash": "6fc53fcd",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-30 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001377",
    "query_hash": "a6dc31f9",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-04-02 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-04-23 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-04-02 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-04-23 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001378",
    "query_hash": "3d3b0731",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-04-25 00:00:00' AND created_ts <  TIMESTAMP '2024-05-02 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001379",
    "query_hash": "06c76b0c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-28 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-28 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-01 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001380",
    "query_hash": "d56a5786",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-03-26 00:00:00' AND event_ts <  TIMESTAMP '2024-03-30 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001381",
    "query_hash": "8fb4551a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-12-23 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001382",
    "query_hash": "d6720e2e",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-11-16 00:00:00' AND created_ts <  TIMESTAMP '2024-11-19 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001383",
    "query_hash": "1ecb2d06",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-18 00:00:00' AND event_ts <  TIMESTAMP '2024-09-25 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001384",
    "query_hash": "990f6a81",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-06-29 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-03 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-06-29 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-07-03 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001385",
    "query_hash": "dea70033",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-13 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-08-16 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001386",
    "query_hash": "f055211a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-09-26 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-09-26 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-09-26 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-09-26 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-09-26 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-09-26 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001387",
    "query_hash": "db4aa6b1",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e001387"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001387 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-20 00:00:00' AND event_ts <  TIMESTAMP '2024-03-06 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;\n        SELECT * FROM tmp_e001387 LIMIT 500;"
  },
  {
    "sql_id": "S001388",
    "query_hash": "bde2832c",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "tmp_e001388"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001388 AS\n        SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-01-10 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-01-13 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;\n        SELECT * FROM tmp_e001388 LIMIT 500;"
  },
  {
    "sql_id": "S001389",
    "query_hash": "36f589ed",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-19 00:00:00' AND event_ts <  TIMESTAMP '2024-03-05 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001390",
    "query_hash": "5ee3fd44",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-03-13 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-03-28 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001391",
    "query_hash": "b6beb33b",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-05-02 00:00:00' AND created_ts <  TIMESTAMP '2024-05-16 00:00:00' AND resolved_ts IS NOT NULL AND category = 'REFUND'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001392",
    "query_hash": "0f504042",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-10 00:00:00' AND event_ts <  TIMESTAMP '2024-01-17 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001393",
    "query_hash": "c03a2a2d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-05-31 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-15 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-05-31 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-06-15 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001394",
    "query_hash": "7aefc09d",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-09-09 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001395",
    "query_hash": "ba19f0f2",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-23 00:00:00' AND event_ts <  TIMESTAMP '2024-10-30 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001396",
    "query_hash": "74204e60",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-15 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-19 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001397",
    "query_hash": "6f7cd3c5",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-05-29 00:00:00' AND created_ts <  TIMESTAMP '2024-05-31 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001398",
    "query_hash": "e5a12237",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-10-19 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001399",
    "query_hash": "5e5ff964",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-02-17 00:00:00' AND created_ts <  TIMESTAMP '2024-02-20 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY month, stage;"
  },
  {
    "sql_id": "S001400",
    "query_hash": "77bccf87",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-15 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-12 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001401",
    "query_hash": "b5786a31",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-05-16 00:00:00' - INTERVAL '90 days')\n        AND purchased_at <  TIMESTAMP '2024-05-16 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-05-16 00:00:00' - INTERVAL '90 days')\n        AND order_ts <  TIMESTAMP '2024-05-16 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-05-16 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-05-16 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001402",
    "query_hash": "bba1ecba",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals",
      "tmp_e001402"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 4,
    "sql_full": "CREATE TEMP TABLE tmp_e001402 AS\n        -- ad-hoc rerun\nSELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-09-03 00:00:00' AND created_ts <  TIMESTAMP '2024-09-18 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;\n        SELECT * FROM tmp_e001402 LIMIT 500;"
  },
  {
    "sql_id": "S001403",
    "query_hash": "180dbccd",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 2,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-10-07 00:00:00' AND created_ts <  TIMESTAMP '2024-10-13 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001404",
    "query_hash": "5e44c546",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer",
      "tmp_e001404"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001404 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e001404 LIMIT 500;"
  },
  {
    "sql_id": "S001405",
    "query_hash": "4d230e30",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-05-24 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-06-08 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001406",
    "query_hash": "e9dc5963",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-28 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-06 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001407",
    "query_hash": "3ce28c85",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-02-11 00:00:00' AND created_ts <  TIMESTAMP '2024-02-14 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001408",
    "query_hash": "c47cc078",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-08-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-10 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001409",
    "query_hash": "9c3fed32",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e001409"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001409 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-06 00:00:00' AND event_ts <  TIMESTAMP '2024-09-10 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e001409 LIMIT 500;"
  },
  {
    "sql_id": "S001410",
    "query_hash": "4b7a26b8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-15 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-09-15 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-19 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001411",
    "query_hash": "9e078476",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-10-04 00:00:00' AND created_ts <  TIMESTAMP '2024-10-08 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001412",
    "query_hash": "dc6e9a79",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-04-30 00:00:00' AND created_ts <  TIMESTAMP '2024-05-21 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001413",
    "query_hash": "6b9bfaee",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-09-14 00:00:00' - INTERVAL '180 days')\n        AND purchased_at <  TIMESTAMP '2024-09-14 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-09-14 00:00:00' - INTERVAL '180 days')\n        AND order_ts <  TIMESTAMP '2024-09-14 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-09-14 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-09-14 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001414",
    "query_hash": "e28db896",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-06 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-13 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001415",
    "query_hash": "c2c0a3eb",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-12-13 00:00:00' AND created_ts <  TIMESTAMP '2024-12-17 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001416",
    "query_hash": "54777cd6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-04-02 00:00:00' - INTERVAL '365 days')\n        AND purchased_at <  TIMESTAMP '2024-04-02 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-04-02 00:00:00' - INTERVAL '365 days')\n        AND order_ts <  TIMESTAMP '2024-04-02 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-04-02 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-04-02 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001417",
    "query_hash": "d4b21551",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-11 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-18 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-11 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-10-18 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001418",
    "query_hash": "bcebb154",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-03 00:00:00' AND event_ts <  TIMESTAMP '2024-09-18 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001419",
    "query_hash": "d4876edb",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-12-04 00:00:00' AND event_ts <  TIMESTAMP '2024-12-07 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001420",
    "query_hash": "a5264e4d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 4,
    "sql_full": "-- dashboard_extract: exec summary\nWITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-15 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001421",
    "query_hash": "a3843a11",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e001421"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001421 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-09-03 00:00:00' AND event_ts <  TIMESTAMP '2024-09-05 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e001421 LIMIT 500;"
  },
  {
    "sql_id": "S001422",
    "query_hash": "c03c4c15",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-04-12 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-04-19 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001423",
    "query_hash": "70f96a1f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-20 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001424",
    "query_hash": "a9de4151",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-05-21 00:00:00' AND event_ts <  TIMESTAMP '2024-06-05 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001425",
    "query_hash": "4dd60428",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-16 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-23 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'SG' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001426",
    "query_hash": "008f4200",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-07 00:00:00' AND event_ts <  TIMESTAMP '2024-11-13 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001427",
    "query_hash": "7d7fb706",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-12-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-31 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'SUITE'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001428",
    "query_hash": "a4dbb2bb",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-12-25 00:00:00' AND created_ts <  TIMESTAMP '2025-01-01 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001429",
    "query_hash": "9936125a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-02 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-16 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001430",
    "query_hash": "5853b30f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-11-02 00:00:00' - INTERVAL '180 days')\n        AND purchased_at <  TIMESTAMP '2024-11-02 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-11-02 00:00:00' - INTERVAL '180 days')\n        AND order_ts <  TIMESTAMP '2024-11-02 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-11-02 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-11-02 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001431",
    "query_hash": "7003f0ec",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-01-23 00:00:00' AND created_ts <  TIMESTAMP '2024-01-27 00:00:00' AND stage = 'PROPOSAL'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001432",
    "query_hash": "e0b76167",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-10-08 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-12 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001433",
    "query_hash": "ebdd68e7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "-- dashboard_extract: exec summary\nWITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-12-02 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-12-10 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-12-02 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-12-10 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001434",
    "query_hash": "88600f84",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-06-21 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-25 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001435",
    "query_hash": "7a43a7f5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-07-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-22 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001436",
    "query_hash": "a7f57417",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-02-25 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-02-27 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-02-25 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-02-27 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001437",
    "query_hash": "6f236dbc",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-05-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-05-15 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '300'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001438",
    "query_hash": "5eddf38a",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-07-12 00:00:00' AND created_ts <  TIMESTAMP '2024-07-16 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001439",
    "query_hash": "071743c5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-03 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'BOX_OFFICE' AND c.country = 'SG' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001440",
    "query_hash": "c482796f",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-08-26 00:00:00' AND event_ts <  TIMESTAMP '2024-09-23 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001441",
    "query_hash": "dfd43794",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-05-07 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-05-14 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001442",
    "query_hash": "5b369306",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-12-06 00:00:00' AND event_ts <  TIMESTAMP '2024-12-17 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001443",
    "query_hash": "5d33ad67",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-07 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-15 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001444",
    "query_hash": "352af118",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-08-30 00:00:00' AND created_ts <  TIMESTAMP '2024-09-10 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (-- sanity-check filters\nORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001445",
    "query_hash": "d8a1c9f8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-08-31 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-03 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-08-31 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-03 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001446",
    "query_hash": "cafaf44e",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e001446"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001446 AS\n        -- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-26 00:00:00' AND event_ts <  TIMESTAMP '2024-11-06 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e001446 LIMIT 500;"
  },
  {
    "sql_id": "S001447",
    "query_hash": "125eecf6",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer",
      "tmp_e001447"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001447 AS\n        SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-04-14 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-18 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CORPORATE'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;\n        SELECT * FROM tmp_e001447 LIMIT 500;"
  },
  {
    "sql_id": "S001448",
    "query_hash": "69b379cc",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-18 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001449",
    "query_hash": "c2431769",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-05-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'CA' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001450",
    "query_hash": "6dede082",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-11-18 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-11-29 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-11-18 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-11-29 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001451",
    "query_hash": "23705f64",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-11-28 00:00:00' AND created_ts <  TIMESTAMP '2024-12-26 00:00:00' AND resolved_ts IS NOT NULL AND category = 'MERCH'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001452",
    "query_hash": "0ec361eb",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-05-22 00:00:00' AND created_ts <  TIMESTAMP '2024-05-30 00:00:00' AND resolved_ts IS NOT NULL AND category = 'ACCESS'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001453",
    "query_hash": "97ce7481",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-23 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-01 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001454",
    "query_hash": "633e4bb3",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-02-06 00:00:00' - INTERVAL '90 days')\n        AND purchased_at <  TIMESTAMP '2024-02-06 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-02-06 00:00:00' - INTERVAL '90 days')\n        AND order_ts <  TIMESTAMP '2024-02-06 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-02-06 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-02-06 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001455",
    "query_hash": "912ca3ea",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-09-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001456",
    "query_hash": "e498334d",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-11-27 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-12-04 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'US' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001457",
    "query_hash": "32f82fbb",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-09-15 00:00:00' AND created_ts <  TIMESTAMP '2024-09-18 00:00:00' AND resolved_ts IS NOT NULL AND category = 'SEATING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001458",
    "query_hash": "32d7f4b2",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-30 00:00:00' AND event_ts <  TIMESTAMP '2024-02-20 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001459",
    "query_hash": "8adb9063",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders",
      "tmp_e001459"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "CREATE TEMP TABLE tmp_e001459 AS\n        WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-24 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-31 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-07-24 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-07-31 00:00:00' + INTERVAL '7 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '7 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;\n        SELECT * FROM tmp_e001459 LIMIT 500;"
  },
  {
    "sql_id": "S001460",
    "query_hash": "8dbed568",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-04-02 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001461",
    "query_hash": "3e24ef0f",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-24 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-30 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'CA' AND c.segment = 'NEW'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001462",
    "query_hash": "14c8941a",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-10-07 00:00:00' AND event_ts <  TIMESTAMP '2024-10-22 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001463",
    "query_hash": "21c0f7df",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e001463"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Mon",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001463 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-07-04 00:00:00' AND event_ts <  TIMESTAMP '2024-07-06 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;\n        SELECT * FROM tmp_e001463 LIMIT 500;"
  },
  {
    "sql_id": "S001464",
    "query_hash": "2e48c3c0",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-02-14 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-02-21 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001465",
    "query_hash": "24ae4a41",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-10-01 00:00:00' AND created_ts <  TIMESTAMP '2024-12-18 00:00:00' AND stage = 'LEAD'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001466",
    "query_hash": "0d8c3b60",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-11-26 00:00:00' AND event_ts <  TIMESTAMP '2024-11-29 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001467",
    "query_hash": "2b7f6adb",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-05-18 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-01 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001468",
    "query_hash": "293c7535",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Fri",
    "analyst": "Alice",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-09-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-10-01 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '200'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001469",
    "query_hash": "8c1e9c0a",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 11,
    "dominant_day_of_week": "Mon",
    "analyst": "Dave",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-07 00:00:00' AND event_ts <  TIMESTAMP '2024-01-09 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001470",
    "query_hash": "4aa0f6d2",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "customers",
      "avg_value"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": "segment",
    "country_filter": null,
    "query_family": "Segment Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Mon",
    "analyst": "Eve",
    "complexity_score": 4,
    "sql_full": "WITH activity AS (\n      SELECT customer_id, purchased_at AS ts, (face_value - COALESCE(discount_amount,0)) AS value\n      FROM raw_ticket_sales\n      WHERE purchased_at >= (TIMESTAMP '2024-12-09 00:00:00' - INTERVAL '90 days')\n        AND purchased_at <  TIMESTAMP '2024-12-09 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n      UNION ALL\n      SELECT customer_id, order_ts AS ts, (quantity * unit_price - COALESCE(discount_amount,0)) AS value\n      FROM raw_merch_orders\n      WHERE order_ts >= (TIMESTAMP '2024-12-09 00:00:00' - INTERVAL '90 days')\n        AND order_ts <  TIMESTAMP '2024-12-09 00:00:00'\n    ),\n    rfm AS (\n      SELECT\n        customer_id,\n        MAX(ts) AS last_activity_ts,\n        COUNT(*) AS txn_count,\n        SUM(value) AS total_value\n      FROM activity\n      GROUP BY 1\n    )\n    SELECT\n      CASE\n        WHEN (TIMESTAMP '2024-12-09 00:00:00' - last_activity_ts) <= INTERVAL '30 days' AND txn_count >= 5 THEN 'DIEHARD'\n        WHEN (TIMESTAMP '2024-12-09 00:00:00' - last_activity_ts) <= INTERVAL '90 days' AND txn_count >= 2 THEN 'ENGAGED'\n        WHEN txn_count = 1 THEN 'NEW'\n        ELSE 'LAPSED'\n      END AS rfm_segment,\n      COUNT(*) AS customers,\n      AVG(total_value) AS avg_value\n    FROM rfm\n    GROUP BY 1\n    ORDER BY customers DESC;"
  },
  {
    "sql_id": "S001471",
    "query_hash": "3eb87dcf",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-05 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-08 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-05 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-10-08 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001472",
    "query_hash": "a7a0e5c5",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-03-12 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-03-26 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001473",
    "query_hash": "e230ceb7",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-05 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-20 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001474",
    "query_hash": "cb7f0825",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-09-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-07 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-09-01 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-09-07 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001475",
    "query_hash": "5d83a3d8",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-19 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-25 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001476",
    "query_hash": "44a9c970",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-19 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-26 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-07-19 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-07-26 00:00:00' + INTERVAL '14 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '14 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001477",
    "query_hash": "dfdc93e6",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 16,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-03 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-09 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'APP' AND c.country = 'GB' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001478",
    "query_hash": "7ad1e20f",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Tue",
    "analyst": "Bob",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(face_value + COALESCE(fees,0) - COALESCE(discount_amount,0)) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM raw_ticket_sales t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-06-07 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-06-14 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'CA' AND c.segment = 'DIEHARD'\n    GROUP BY 1,2\n    -- sanity-check filters\nORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001479",
    "query_hash": "224c2f8a",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-12-14 00:00:00' AND event_ts <  TIMESTAMP '2024-12-17 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    -- sanity-check filters\nORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001480",
    "query_hash": "863b7306",
    "primary_table": "support_tickets",
    "tables_used": [
      "support_tickets"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "resolved_tickets",
      "avg_resolution_hours",
      "p90_resolution_hours"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        category,\n        status,\n        created_ts,\n        resolved_ts,\n        EXTRACT(EPOCH FROM (resolved_ts - created_ts)) / 3600.0 AS resolution_hours\n      FROM support_tickets\n      WHERE created_ts >= TIMESTAMP '2024-06-16 00:00:00' AND created_ts <  TIMESTAMP '2024-06-18 00:00:00' AND resolved_ts IS NOT NULL AND category = 'BILLING'\n    )\n    SELECT\n      category,\n      COUNT(*) AS resolved_tickets,\n      AVG(resolution_hours) AS avg_resolution_hours,\n      PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY resolution_hours) AS p90_resolution_hours\n    FROM base\n    GROUP BY 1\n    ORDER BY resolved_tickets DESC;"
  },
  {
    "sql_id": "S001481",
    "query_hash": "32df7e4a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "-- ad-hoc rerun\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-07-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-09-17 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001482",
    "query_hash": "7ce0bb75",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Wed",
    "analyst": "Bob",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-12 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-07-26 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001483",
    "query_hash": "d37090d4",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 10,
    "dominant_day_of_week": "Wed",
    "analyst": "Dave",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-01-10 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-02-07 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-01-10 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-02-07 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  },
  {
    "sql_id": "S001484",
    "query_hash": "1c5948dd",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Thu",
    "analyst": "Eve",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-02-03 00:00:00' AND event_ts <  TIMESTAMP '2024-02-24 00:00:00' AND device_type = 'TABLET'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001485",
    "query_hash": "01b7be49",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-11-29 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-13 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001486",
    "query_hash": "ab1d836a",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Thu",
    "analyst": "Charlie",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-03-26 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-04-02 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'WEB' AND c.country = 'GB' AND c.segment = 'CASUAL'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001487",
    "query_hash": "1cc39e02",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events",
      "tmp_e001487"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Fri",
    "analyst": "Eve",
    "complexity_score": 6,
    "sql_full": "CREATE TEMP TABLE tmp_e001487 AS\n        WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-26 00:00:00' AND event_ts <  TIMESTAMP '2024-01-30 00:00:00' AND device_type = 'MOBILE'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;\n        SELECT * FROM tmp_e001487 LIMIT 500;"
  },
  {
    "sql_id": "S001488",
    "query_hash": "6f23bc49",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Thu",
    "analyst": "Bob",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-12-20 00:00:00' AND created_ts <  TIMESTAMP '2024-12-24 00:00:00' AND stage = 'LOST'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001489",
    "query_hash": "915ac2ee",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 13,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 9,
    "sql_full": "WITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-22 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-29 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = 'CLUB'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001490",
    "query_hash": "673e24e1",
    "primary_table": "crm_deals",
    "tables_used": [
      "crm_deals"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "deals_created",
      "pipeline_amount"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 15,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 2,
    "sql_full": "SELECT\n      DATE_TRUNC('month', created_ts) AS month,\n      stage,\n      COUNT(*) AS deals_created,\n      SUM(amount) AS pipeline_amount\n    FROM crm_deals\n    WHERE created_ts >= TIMESTAMP '2024-07-13 00:00:00' AND created_ts <  TIMESTAMP '2024-07-20 00:00:00' AND stage = 'QUALIFIED'\n    GROUP BY 1,2\n    ORDER BY month, stage;"
  },
  {
    "sql_id": "S001491",
    "query_hash": "9c3a1368",
    "primary_table": "raw_digital_events",
    "tables_used": [
      "raw_digital_events"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "sessions",
      "sessions_with_purchase",
      "session_conversion_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "month",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Thu",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "WITH sessions AS (\n      SELECT\n        campaign_id,\n        session_id,\n        MAX(CASE WHEN event_type = 'PAGE_VIEW' THEN 1 ELSE 0 END) AS saw_page,\n        MAX(CASE WHEN event_type = 'CHECKOUT_START' THEN 1 ELSE 0 END) AS started_checkout,\n        MAX(CASE WHEN event_type = 'PURCHASE' THEN 1 ELSE 0 END) AS purchased\n      FROM raw_digital_events\n      WHERE event_ts >= TIMESTAMP '2024-01-01 00:00:00' AND event_ts <  TIMESTAMP '2024-01-13 00:00:00' AND device_type = 'DESKTOP'\n      GROUP BY 1,2\n    )\n    SELECT\n      campaign_id,\n      COUNT(*) AS sessions,\n      SUM(saw_page) AS sessions_with_page,\n      SUM(started_checkout) AS sessions_with_checkout,\n      SUM(purchased) AS sessions_with_purchase,\n      (SUM(purchased)::numeric / NULLIF(COUNT(*),0)) AS session_conversion_rate\n    FROM sessions\n    GROUP BY 1\n    ORDER BY sessions DESC;"
  },
  {
    "sql_id": "S001492",
    "query_hash": "84f653c6",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 9,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-03-29 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-04-02 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001493",
    "query_hash": "7df1e151",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-10-01 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-15 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001494",
    "query_hash": "2c2cf907",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Mon",
    "analyst": "Alice",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-10-08 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-11-05 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    -- sanity-check filters\nORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001495",
    "query_hash": "23884785",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "marketing_touches"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "attributed_tickets",
      "attributed_net_revenue"
    ],
    "num_kpis": 2,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Channel Analysis",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Dave",
    "complexity_score": 4,
    "sql_full": "WITH purchases AS (\n      SELECT\n        customer_id,\n        ticket_id,\n        purchased_at,\n        (face_value - COALESCE(discount_amount,0)) AS net_revenue_excl_fees\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-07-01 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-09-22 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    last_touch AS (\n      SELECT\n        p.ticket_id,\n        MAX(t.touch_ts) AS last_touch_ts\n      FROM purchases p\n      JOIN marketing_touches t\n        ON t.customer_id = p.customer_id\n       AND CAST(t.touch_ts AS DATE) <= CAST(p.purchased_at AS DATE)\n      GROUP BY 1\n    )\n    SELECT\n      mt.campaign_id,\n      COUNT(DISTINCT p.ticket_id) AS attributed_tickets,\n      SUM(p.net_revenue_excl_fees) AS attributed_net_revenue\n    FROM purchases p\n    JOIN last_touch lt ON lt.ticket_id = p.ticket_id\n    JOIN marketing_touches mt\n      ON mt.customer_id = p.customer_id\n     AND mt.touch_ts = lt.last_touch_ts\n    GROUP BY 1\n    ORDER BY attributed_net_revenue DESC;"
  },
  {
    "sql_id": "S001496",
    "query_hash": "c064a6b5",
    "primary_table": "analytics.vw_ticket_sales_enriched",
    "tables_used": [
      "analytics.vw_ticket_sales_enriched",
      "dim_customer"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "gross_revenue",
      "net_revenue",
      "tickets_sold"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Revenue"
    ],
    "primary_kpi_family": "Revenue",
    "has_ratio_kpi": false,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": "segment",
    "country_filter": "country",
    "query_family": "Daily Monitoring",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Wed",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "SELECT\n      DATE_TRUNC('day', t.purchased_at) AS day,\n      t.channel,\n      SUM(gross_revenue) AS gross_revenue,\n      SUM(face_value - COALESCE(discount_amount,0) + COALESCE(fees,0)) AS net_revenue,\n      COUNT(DISTINCT t.ticket_id) AS tickets_sold\n    FROM analytics.vw_ticket_sales_enriched t\n    JOIN dim_customer c ON c.customer_id = t.customer_id\n    WHERE t.purchased_at >= TIMESTAMP '2024-07-17 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-07-24 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.channel = 'PARTNER' AND c.country = 'SG' AND c.segment = 'FAMILY'\n    GROUP BY 1,2\n    ORDER BY day, t.channel;"
  },
  {
    "sql_id": "S001497",
    "query_hash": "85493145",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "dim_event",
      "raw_attendance_scans"
    ],
    "num_tables": 3,
    "has_joins": true,
    "join_count": 2,
    "kpis": [
      "tickets",
      "attended",
      "attendance_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 9,
    "sql_full": "-- dashboard_extract: exec summary\nWITH base AS (\n      SELECT\n        t.ticket_id,\n        t.event_id,\n        t.seat_section,\n        DATE_TRUNC('week', e.event_date::timestamp) AS event_week\n      FROM raw_ticket_sales t\n      JOIN dim_event e ON e.event_id = t.event_id\n      WHERE t.purchased_at >= TIMESTAMP '2024-03-10 00:00:00' AND t.purchased_at <  TIMESTAMP '2024-03-21 00:00:00' AND COALESCE(t.refunded_flag,false) = false AND t.seat_section = '100'\n    ),\n    scans AS (\n      SELECT DISTINCT ticket_id, 1 AS attended_flag\n      FROM raw_attendance_scans\n      WHERE scanned_at IS NOT NULL\n    )\n    SELECT\n      b.event_week,\n      b.seat_section,\n      COUNT(DISTINCT b.ticket_id) AS tickets,\n      SUM(COALESCE(s.attended_flag,0)) AS attended,\n      (SUM(COALESCE(s.attended_flag,0))::numeric / NULLIF(COUNT(DISTINCT b.ticket_id),0)) AS attendance_rate\n    FROM base b\n    LEFT JOIN scans s ON s.ticket_id = b.ticket_id\n    GROUP BY 1,2\n    ORDER BY b.event_week, b.seat_section;"
  },
  {
    "sql_id": "S001498",
    "query_hash": "f2a5a717",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 12,
    "dominant_day_of_week": "Wed",
    "analyst": "Charlie",
    "complexity_score": 3,
    "sql_full": "-- dashboard_extract: exec summary\nSELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-06-16 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-06-19 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001499",
    "query_hash": "0fbb5524",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales"
    ],
    "num_tables": 1,
    "has_joins": false,
    "join_count": 0,
    "kpis": [
      "tickets",
      "refunded_tickets",
      "refund_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "day",
    "date_range_days": null,
    "channel_filter": "channel",
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 17,
    "dominant_day_of_week": "Fri",
    "analyst": "Bob",
    "complexity_score": 3,
    "sql_full": "SELECT\n      DATE_TRUNC('day', purchased_at) AS day,\n      channel,\n      COUNT(*) AS tickets,\n      SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END) AS refunded_tickets,\n      (SUM(CASE WHEN COALESCE(refunded_flag,false) THEN 1 ELSE 0 END)::numeric / NULLIF(COUNT(*),0)) AS refund_rate\n    FROM raw_ticket_sales\n    WHERE purchased_at >= TIMESTAMP '2024-12-10 00:00:00'\n      AND purchased_at <  TIMESTAMP '2024-12-17 00:00:00'\n    GROUP BY 1,2\n    HAVING COUNT(*) >= 50\n    ORDER BY refund_rate DESC, tickets DESC;"
  },
  {
    "sql_id": "S001500",
    "query_hash": "e239b32a",
    "primary_table": "raw_ticket_sales",
    "tables_used": [
      "raw_ticket_sales",
      "raw_merch_orders"
    ],
    "num_tables": 2,
    "has_joins": true,
    "join_count": 1,
    "kpis": [
      "tickets_sold",
      "tickets_with_merch",
      "merch_attach_rate"
    ],
    "num_kpis": 3,
    "kpi_families": [
      "Volume"
    ],
    "primary_kpi_family": "Volume",
    "has_ratio_kpi": true,
    "time_grain": "day",
    "date_trunc_used": "none",
    "date_range_days": null,
    "channel_filter": null,
    "segment_filter": null,
    "country_filter": null,
    "query_family": "Adhoc Investigation",
    "execution_count": 1,
    "frequency_bucket": "adhoc",
    "dominant_hour": 14,
    "dominant_day_of_week": "Tue",
    "analyst": "Alice",
    "complexity_score": 6,
    "sql_full": "WITH tickets AS (\n      SELECT customer_id, ticket_id, purchased_at, event_id\n      FROM raw_ticket_sales\n      WHERE purchased_at >= TIMESTAMP '2024-10-08 00:00:00'\n        AND purchased_at <  TIMESTAMP '2024-10-16 00:00:00'\n        AND COALESCE(refunded_flag,false) = false\n    ),\n    merch AS (\n      SELECT customer_id, order_id, order_ts\n      FROM raw_merch_orders\n      WHERE order_ts >= TIMESTAMP '2024-10-08 00:00:00'\n        AND order_ts <  (TIMESTAMP '2024-10-16 00:00:00' + INTERVAL '3 days')\n    ),\n    attached AS (\n      SELECT DISTINCT t.ticket_id\n      FROM tickets t\n      JOIN merch m\n        ON m.customer_id = t.customer_id\n       AND m.order_ts >= t.purchased_at\n       AND m.order_ts <  (t.purchased_at + INTERVAL '3 days')\n    )\n    SELECT\n      COUNT(DISTINCT tickets.ticket_id) AS tickets_sold,\n      COUNT(DISTINCT attached.ticket_id) AS tickets_with_merch,\n      (COUNT(DISTINCT attached.ticket_id)::numeric / NULLIF(COUNT(DISTINCT tickets.ticket_id),0)) AS merch_attach_rate\n    FROM tickets\n    LEFT JOIN attached ON attached.ticket_id = tickets.ticket_id;"
  }
];